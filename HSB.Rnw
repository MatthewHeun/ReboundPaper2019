% Energy Economics Author Guide: 
% https://www.elsevier.com/journals/energy-economics/0140-9883/guide-for-authors

\documentclass[review]{elsarticle}      % For the review process; lots of space between lines
% \documentclass[1p]{elsarticle}          % Single spacing closer to published version
% \documentclass[preprint]{elsarticle}    % For submission

\usepackage{lineno}
\modulolinenumbers[5]


%% Package imports %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{amsfonts}           % For access to \checkmark.
\usepackage{amsmath}            % For better symbol decorations
\usepackage{booktabs}           % For nice table rules
\usepackage[official]{eurosym}  % For the euro symbol
\usepackage[figurename=Fig.]{caption} % For changing "Figure" to "Fig." in figure captions
\usepackage{chngcntr}           % To get figure and table numbering correct in the appendices
\usepackage[makeroom]{cancel}   % To show terms go to zero
\usepackage[inline]{enumitem}   % For inline enumeration
\usepackage{multicol}           % For multi-column layout
\usepackage{multirow}           % For multi-row layout
\usepackage{nccmath}            % For the \useshortskip command above equations
\usepackage{parcolumns}         % For multi-column layout
\usepackage{pdflscape}          % For landscape environment \begin{landscape} ... \end{landscape}
\usepackage{soul}               % For text highlighting
\usepackage[most]{tcolorbox}    % For color highlighting of text
\usepackage{tikz}               % For diagrams
\usetikzlibrary{arrows,positioning}
\usepackage{ulem}               % For strikeout command (\sout)
\usepackage{xcolor}             % For ... colors

\usepackage{hyperref}           % hyperref should be the last package loaded


%% Macros defined by authors %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{pieces/macros.tex}


%% Journal %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\journal{Energy Economics}


%% Bibliography style %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bibliographystyle{model2-names.bst}\biboptions{authoryear}


\begin{document}
%\SweaveOpts{concordance=TRUE}

\begin{frontmatter}

%% Title %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{Toward a comprehensive, consumer-based \\
       energy rebound analysis framework}

% Bonepile
% Toward a mathematically rigorous analytical framework
% for microeconomic energy rebound effects \\
% OR \\
% Toward a mathematically rigorous, consumer-based rebound analysis framework\\
% OR \\
% Towards a comprehensive analytical framework
% for microeconomic energy rebound effects


%% Authors %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\author[MKH_address]{Matthew Kuperus Heun\corref{corr_author}}
\cortext[corr_author]{Corresponding author}
\ead{mkh2@calvin.edu}

\author[GS_address]{Gregor Semieniuk}
\ead{gsemieniuk@umass.edu}

\author[PB_address]{Paul E. Brockway}
\ead{P.E.Brockway@leeds.ac.uk}


%% Addresses %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\address[MKH_address]{Engineering Department,\\
Calvin University, 3201 Burton St. SE,\\
Grand Rapids, MI, 49546, USA.}

\address[GS_address]{Political Economy Research Institute \& Department of Economics,\\
University of Massachusetts at Amherst, 412 North Pleasant St.,\\
Amherst, MA, 01002, USA}

\address[PB_address]{Sustainability Research Institute, School of Earth and Environment,\\
University of Leeds,\\
Leeds, LS2 9JT, UK}


%% Abstract %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{abstract}
% A concise and factual abstract is required.
% The abstract should state briefly 
% the purpose of the research, 
% the principal results, and
% major conclusions. 
% An abstract is often presented separately from the article, 
% so it must be able to stand alone.
% For this reason, References should be avoided, but if essential, 
% then cite the author(s) and year(s).
% Also, non-standard or uncommon abbreviations should be avoided, but
% if essential they must be defined at their first mention in the abstract itself.
Implementation of widespread energy efficiency measures
is an important global strategy to meet Paris greenhouse gas emissions targets. 
However, energy rebound can ``take back'' efficiency-based
energy reductions via behavior changes and economic effects.
Evidence is growing that rebound effects are 
larger than typically assumed, 
meaning that efficiency-based efforts to reduce carbon emissions 
will be less effective than supposed.
% The problem
To date, most work on energy rebound is empirical and microeconomic.
Although microeconomic theory is available,
it is scattered across papers and
lacks rigorous theoretical foundations.
Furthermore, there is a paucity of both theoretical and empirical work on macro rebound.
Consequently, understanding of rebound mechanisms is inhibited, and 
macro energy modeling and energy efficiency policy are at risk
of being ineffective at efficiency-based emissions reductions.
% Our response
In response, 
we develop a comprehensive, consumer-based rebound analysis framework.
We build upon microeconomic fundamentals and
employ a constant elasticity of substitution utility model to 
describe direct and indirect channels 
for emplacement, substitution, and income rebound effects. 
We utilize a macroeconomic factor to link
macro to micro rebound effects.
A sequence of novel graphs shows rebound paths through energy, 
expenditure, and consumption spaces.
The framework is applied to two case studies: 
upgrades of a car and an electric lamp.
% Results
We find microeconomic rebounds of 24\% and 29\% 
and total rebound of 33\% and 48\% for the car and lamp examples, respectively.
% **** 
% These numbers are not automatically recalculated.
% Double-check before submission. 
% ****
Sensitivity studies are performed, and 
policy implications are discussed.
\end{abstract}


%% Keywords %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% maximum of 6 keywords, using American spelling and avoiding general and plural terms and multiple concepts 
% (avoid, for example, 'and', 'of'). Be sparing with abbreviations: 
% only abbreviations firmly established in the field may be eligible. 
% These keywords will be used for indexing purposes.

% Up to 6 standard JEL codes. The available codes may be accessed at JEL, 
% https://www.aeaweb.org/jel/guide/jel.php   

\begin{keyword}
% Maximum of 6 keywords.
Energy efficiency \sep Energy rebound \sep Energy services \sep Microeconomic rebound \sep
Substitution and income effects \sep Macroeconomic rebound

% Maximum of 6 JEL codes.
\emph{JEL codes:} D11 \sep O33 \sep Q41 \sep Q54 \sep Q55 %https://www.aeaweb.org/jel/guide/jel.php
\end{keyword}

\end{frontmatter}

<<setup, echo=FALSE, message=FALSE>>=
library(dplyr)
library(magrittr)
library(ReboundTools)
library(tidyr)
library(xtable)
@

\linenumbers


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
\label{sec:introduction}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%++++++++++++++++++++++++++++++
\subsection{Background}
\label{sec:background}
%++++++++++++++++++++++++++++++

Energy rebound is a phenomenon whereby 
some expected energy savings fail to materialize 
after an energy efficiency upgrade (EEU), 
due to behavior changes and economic effects.
Famously, the roots of energy rebound trace back to 
\citeauthor{Jevons:1865}
who, in \emph{The Coal Question}, said 
``[\emph{i}]\emph{t is wholly a confusion of ideas to suppose that the economical 
use of fuel is equivalent to a diminished consumption. 
The very contrary is the truth}'' (emphasis in original) \citet[p.~103]{Jevons:1865}.
Less famously, the origins of rebound may extend further backward 
from \citeauthor{Jevons:1865}
to \citet{Williams1840}
who quoted \citeauthor{Parkes1838}:
``[t]he economy of fuel is the secret of the economy of the steam-engine; 
it is the fountain of its power, and the adopted measure of its effects. 
Whatever, therefore, conduces to increase the efficiency of coal, 
and to diminish the cost of its use, 
directly tends to augment the value of the steam-engine, 
and to enlarge the field of its operations''~\citep[p.~161]{Parkes1838}.
For nearly 200 years, then, it has been understood 
that efficiency gains may, paradoxically, 
drive growth in energy consumption.

The oil crises of the 1970s shone a light back onto energy efficiency,
and the modern debate over the magnitude of energy rebound commenced. 
On one side, scholars including \citet{Brookes1979, Brookes1990} and \citet{Khazzoom1980} 
suggested rebound could be large.
Others, including \citet{Lovins1988} and \citet{Grubb1990, Grubb1992},
claimed rebound was likely to be small.

Debate over the size of energy rebound continues today.
Advocates of small rebound (less than, say, 50\%),
suggest ``the rebound effect is overplayed''~\citep[p.~475]{Gillingham:2013aa},
while others, 
including \citet{Saunders2015} and \citet{Stern2020},
claim the evidence for large rebound
(greater than 50\%)
is growing.
(Rebound above 100\% is known as ``backfire.'')

Amidst the rebound debate,
energy efficiency measures are expected to deliver
energy-related 
CO$_2$ emissions reductions in support of
Paris Agreement targets~\citep{masson-delmotte2018},
even while the world economy grows.
For example, by 2050
energy efficiency is expected to contribute 37\% of 
energy-related carbon emissions reductions globally
in the International Energy Agency's Sustainable Development scenario
(relative to its Stated Policies scenario, 
which itself includes planned energy efficiency)
~\citep[Fig.~2.1]{InternationalEnergyAgency2019}.
As \citet{Brockway2021} note, 
the expected reductions in energy consumption 
would represent a structural break with the historical record
of tight coupling between energy consumption and GDP.
Thus, the magnitude of energy rebound is much more than an academic debate, 
because there is a lot at stake. 
Large rebound, if it exists, means that
efficiency-based efforts to reduce carbon emissions may be less effective than supposed, 
and achieving Paris emissions reduction targets will be at risk.

Those who study energy rebound usually identify 
locations and levels of rebound.
Rebound \emph{locations} typically include
direct rebound effects 
(associated with energy to run the energy conversion device) and
indirect rebound effects
(energy effects of other expenditures in the broader economy).
Rebound \emph{levels} typically align with economic levels, namely
micro
(rebound at the single device level within a static economy)
and
macro
(rebound caused by dynamic responses of the broader economy).

\citet{Sorrell:2007um} led
an important systematic review of energy rebound estimates,
considering over 500 studies and reports from around the world.
He found that most studies focused on direct, microeconomic rebound in the household,
with studies typically estimating small rebound magnitudes (10--30\%).
In contrast, 
he found
weaker evidence for macroeconomic rebound, 
but far larger magnitudes, 
stating 
``[t]his evidence base is both small and subject to a number of important methodological weaknesses, 
making it difficult to draw any general conclusions. 
However, the available studies suggest that economy-wide [macroeconomic] 
rebound effects may frequently exceed 50\%'' \citep[p.~9]{Sorrell:2007um}.

Since the~\citet{Sorrell:2007um} review,
empirical estimates of (typically) household energy rebound
at the microeconomic level (both direct and indirect locations)
continue to suggest relatively small
microeconomic rebound magnitudes
of less than 40\%. 
(See \citet{Greene2012}, \citet{Thomas:2013ab}, \citet{Antal:2014aa}, 
\citet{Chitnis2014}, and \citet{Stapleton:2016}.)
Commonly, microeconomic rebound estimates are based on own-sector (direct)
and/or
cross-sector (indirect, re-spending) price elasticities,
as set out by \citet{Gillingham2016}. 
\citet{dahlqvist2021rebound} provides an example of this price elasticity 
approach applied to energy-intensive industry sectors.

While estimates of microeconomic rebound are common, 
estimates of macroeconomic rebound remain very rare.
(See \citet{Barker2009} for an exception that proves the rule.) 
However, a growing number of studies estimate the magnitude of total rebound, 
the sum of microeconomic and macroeconomic rebound.
A recent review of 33 studies by \citet{Brockway2021} 
found a large group of 21 Computational General Equilibrium (CGE) studies, 
such as \citet{Lecca2014}, \citet{Broberg2015}, and \citet{Wei2017},
with a mean total rebound estimate of around 60\%. 
A smaller group of studies used three other methods:
non-CGE macroeconomic models
(e.g., \citet{Barker2009} and \citet{Lemoine:2020aa}),
econometric analysis (e.g., \citet{Wei2019} and \citet{Bruns2019}), and
productivity or growth accounting studies (e.g., \citet{Lin2015}).
Like the CGE studies, 
the average estimate of total rebound magnitude from non-CGE methods 
was found to be over 60\%,
leading the review authors to conclude that total rebound magnitudes 
are ``larger than commonly assumed''~\citep[p.~1]{Brockway2021}.

Comparing one study to the next is complicated by 
the wide variety of rebound analysis frameworks employed in rebound analysis.
So before formally defining the scope and aims of this paper,
one of which is consolidation of technical and economic foundations, 
we survey existing rebound frameworks.


%++++++++++++++++++++++++++++++
\subsection{Rebound analysis frameworks}
\label{sec:rebound_frameworks}
%++++++++++++++++++++++++++++++

Rebound analysis frameworks have been developed for 
microeconomic, macroeconomic, and total energy rebound.
At the \emph{microeconomic} level,
direct and indirect rebound are often estimated 
via energy service price elasticities (e.g.,~\citet{Schipper2000}).
Recent microeconomic advances include those by 
\citet{Thomas:2013aa}, who set out a detailed rebound analysis framework
of direct and indirect microeconomic effects;
\citet{Borenstein:2015aa}, who provided a detailed decomposition
of rebound into income and substitution effects;
\citet{Chan2015}, who analyzed welfare
implications of the rebound effect; and
\citet{Sun:2018aa}, who considered direct rebound, including device effects.
However, lifecycle and end-of-life considerations are not typically included 
in microeconomic rebound analysis frameworks, and 
models of consumer preferences lack robustness.
(\citet{Babacan:2020aa} provides a rare example 
of analysis of life-cycle analysis effects of the energy efficient device.)

The importance of interactions between microeconomic and \emph{macroeconomic}
rebound effects is suggested by the so-called \emph{Khazzoom-Brookes Postulate} \citep{Saunders:1992aa}, 
defined by \citeauthor{Herring1999} as
``increased energy-efficiency at the micro-economic level,
while leading to a reduction of energy use at this level, 
leads not to a reduction, but instead to an increase in energy use, 
at the national, or macroeconomic level''~\citep[p.~214]{Herring1999}.
\citeauthor{Borenstein:2015aa} described macro effects as follows:
``the economy [expands] by more than the private income gain
enjoyed by the owner of the upgraded appliance'' \citep[p.~11]{Borenstein:2015aa}.
To date, frameworks for estimating the magnitude of macroeconomic rebound effects
have included an amplification mechanism from micro to macro, 
the result of energy productivity gains
from the energy efficiency upgrade (EEU) \citep{Dimitropoulos2007, Sorrell:2010ul}.
These macro effects are hypothesized to operate 
via a numerical multiplier~\citep{Borenstein:2015aa, Lange2019}.
Discussions of a macro multiplier effect
have been purely conceptual, 
with the magnitude of the macro factor being a central issue.
\citet{Howarth1997} and \citet{Schipper2000}
claim the macroeconomic rebound multiplier effect is small. 
\citet{Aucott2014}, \citet{Enflo2009}, and \citet{Bataille2017}
are among those who claim the macroeconomic multiplier is much larger. 
\citeauthor{Dimitropoulos2007} suggested
``[o]ne of the main reasons behind the debate is the lack of a rigorous theoretical framework
that can describe the mechanisms and consequences of 
the rebound effect at the macro-economic level''~\citep[p.~6354]{Dimitropoulos2007}.
In a recent review on energy productivity, 
\citeauthor{Elkomy2020} found
``[w]hile many researchers suggest that energy and productivity are linked, 
there is relatively little consensus in the empirical literatures 
either confirming or rejecting these views. 
In some cases (notably the relationship between capital and energy), 
we do not appear to have robust methodologies for making empirical assessments''~\citep[p.~1]{Elkomy2020}.

\citet{Saunders:1992aa} made perhaps the earliest attempt
at a framework for \emph{total} energy rebound
based on neoclassical aggregate production functions (APFs).
Later works continued the APF approach, including
\citet{Saunders:2000aa, Saunders2008},
\citet{Wei2017}, and
\citet{Brockway:2017a}.
\citet{Grepperud2004} provide one of the first
general equilibrium frameworks for total rebound,
overcoming limitations of partial equilibrium frameworks where
markets by definition cannot fully close 
and thus miss some rebound channels~\citep{Figus2016}.
Further general equilibrium studies of total rebound followed, including
\citet{Wei2010},
\citet{Lemoine:2020aa}, and
\citet{Fullerton2020}.

Despite the growth of rebound contributions in micro, macro, and total frameworks,
particularly in the last decade,
several key issues remain. 
First, limitations of \emph{microeconomic} rebound analysis frameworks include
%
\begin{enumerate*}[label={(\roman*)}]
	
	\item inseparability of substitution and income effects when
	      applying rebound analysis frameworks to real EEUs and

  \item the lack of an operationalizable link between micro and macro effects.
    
\end{enumerate*}

Second, there is a paucity of both theoretical and empirical work on the
\emph{macroeconomic} multiplier.
At least two things are unclear:
the channel by which a macroeconomic multiplier effect 
would couple to microeconomic effects 
and 
the appropriate magnitude of a macroeconomic multiplier.

Third, results from analysis frameworks which estimate \emph{total} rebound 
are highly dependent upon two assumptions: 
the type of production function used (Cobb-Douglas, constant elasticity of substitution (CES), etc.) and
the chosen value of the elasticity of substitution.
As \citeauthor{Saunders2008} noted, the
``choice of production/cost function can pre-determine the results related to rebound \ldots{}
[and choosing] values for these [elasticity of substitution] parameters
is tantamount to assuming rebound results''~\citet[p.~2207-2208]{Saunders2008}.
Furthermore, analysis frameworks at the total rebound level
often work with aggregate energy and economic variables,
rarely discriminating between microeconomic and macroeconomic rebound components.

In summary, most work on energy rebound is empirical and microeconomic.
And although microeconomic theory is available,
it is scattered across papers, and
it has not been developed in a way that 
allows simultaneous empirical estimation of all microeconomic rebounds.
Furthermore, macroeconomic rebound and its links to micro rebound
is virtually unexplored territory.
This state of affairs
inhibits understanding of rebound mechanisms
at direct and indirect locations and micro and macro levels.
In the absence of integrated theoretical foundations,
macro energy modeling and energy efficiency policy are at risk
of being ineffective to achieve efficiency-based CO$_2$ emissions reductions.
Adding to that risk,
energy rebound is rarely included in either 
energy models~\citep{Brockway2021} or
energy policy-making~\citep{fontvivanco2016},
limiting our ability to assess the interactions among
rebound, energy demand, and carbon emissions going forward.

Bringing these concerns together, further theoretical and empirical research is vital
to advance our understanding of energy rebound, 
to formulate effective energy policy, and 
to take appropriate climate change mitigation actions.


%++++++++++++++++++++++++++++++
\subsection{Need, aim, contributions, and structure}
\label{sec:aim_contribution_structure}
%++++++++++++++++++++++++++++++

There is a strategic \emph{need} for a comprehensive rebound analysis framework
to firm up theoretical foundations, enable empirical analysis, and 
guide energy policy-making. 
In particular the framework should be one that 
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item builds upon microeconomic foundations and 
        carefully distinguishes among microeconomic rebound mechanisms,
  
  \item incorporates indicative, plausible macroeconomic multiplier values
        to provide a better link between micro and macro effects, and 

  \item enables analysis of real EEUs.
  
\end{enumerate*}
%
The \emph{aim} of this paper is therefore to build upon the foundations laid by 
\citet{Borenstein:2015aa}) and others to develop a
comprehensive, consumer-based energy rebound analysis framework.
The key \emph{contributions} of this paper are 
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item describing a consistent and mathematically rigorous, consumer-based energy rebound analysis framework
        in which direct and indirect dimensions of 
        substitution and income effects are connected,
        
  \item showing that embodied energy, maintenance and disposal activities, 
        replacements, and macroeconomic effects can be accommodated 
        in a consistent framework, 
        
  \item providing a new way to visualize rebound effects, 
        namely via energy, expenditure, and consumption path graphs,
  
  \item applying a general CES utility function 
        via empirically plausible cost shares of other goods consumption,
  
  \item providing two numerical case studies (a car and an electric lamp) 
        to demonstrate the application of the rebound analysis framework, and 
        
  \item an assessment of the rebound implications from policies to enhance energy efficiency.
        
\end{enumerate*}

The remainder of this paper is \emph{structured} as follows.
Section~\ref{sec:framework} describes the comprehensive, consumer-based rebound analysis framework.
Section~\ref{sec:examples} provides two calculation examples, a car and an electric lamp.
Section~\ref{sec:discussion} discusses the results, and 
Section~\ref{sec:conclusion} concludes.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Methods: development of the rebound framework}
\label{sec:framework}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In this section, we develop a comprehensive, consumer-based energy rebound analysis framework 
(concisely, ``the framework'').
We begin with our rebound typology. 


%++++++++++++++++++++++++++++++
\subsection{Rebound typology}
\label{sec:rebound_typology}
%++++++++++++++++++++++++++++++

% A challenge to understanding energy rebound is that it comprises
% many mechanisms and effects.
We follow convention to distinguish between
microeconomic effects (at the single device or device owner level)
and 
macroeconomic effects (broader, economy-wide responses
to a single device upgrade).
(See \citet{greening2000}, \citet{Barker2009}, and \citet{FontVivanco2018}.) 
We follow others, including \citet{Jenkins2011} and \citet{Walnum2014}, 
in splitting microeconomic effects into 
direct effects (associated with energy to run the energy conversion device) and
indirect effects (associated with other expenditures) effects.

Like other authors, we recognize many macroeconomic effects, 
even if we don't later distinguish among them.
\citet{Sorrell:2009cg} 
sets out five macroeconomic rebound effects:
embodied energy effects, respending effects, output effects, energy market effects, and composition effects.
\citet{Santarius2016} and \citet{Lange2021} 
introduce 
meso (i.e., sectoral) level rebound
between the micro and macro levels.
\citet{VandenBergh2011} distinguishes 14 types of rebound, 
providing, perhaps, the greatest complexity. 

Table~\ref{tab:typology} 
summarizes and reconciles some of the existing typologies
and sets out the typology for this paper. 

\begin{table}
\caption{Rebound typology adopted with comparison to existing literature.}
\centering
\includegraphics[width=1\linewidth]{figure_other/typology.pdf}
\label{tab:typology}
\end{table}


%++++++++++++++++++++++++++++++
\subsection{Rebound mechanisms}
\label{sec:rebound_mechanisms}
%++++++++++++++++++++++++++++++

We assume an energy conversion device (say, a car)
that consumes final energy (say, gasoline) at a rate $\rbempl{E}$ (in MJ/year)%
\footnote{
  Note that
  the vocabulary and mathematical notation for rebound effects is extensive;
  Fig.~\ref{fig:flowchart} and Appendix~\ref{sec:nomenclature} provide guides to 
  notation elements used throughout the paper, including
  symbols, Greek letters, decorations, and subscripts.
  The notation elements 
  can be mixed to provide a rich and expressive ``language'' of energy rebound.
  In several places, we use colored backgrounds on rebound effects for visual convenience. 
}.
The final energy is available at price $p_E$ (in \$/MJ).
The energy conversion device provides a rate of energy service 
$\rbempl{q}_s$ (in vehicle-km/year)
with final-energy-to-service efficiency $\bempl{\eta}$ (in km/MJ).
An energy efficiency upgrade (EEU) increases
final-energy-to-service efficiency%
\footnote{
  Note that energy service efficiency ($\eta$) improves
  between the original ($\circ$) and
  post-emplacement ($*$)
  stages of Fig.~\ref{fig:flowchart}, remaining constant thereafter.
  Thus, $\orig{\eta} < \aempl{\eta} = \asub{\eta} = \ainc{\eta} = \amacro{\eta}$,
  as shown in Table~\ref{tab:analysis_assumptions}.
  We refer to all post-emplacement efficiencies 
  ($\aempl{\eta}$, $\asub{\eta}$, $\ainc{\eta}$, and $\amacro{\eta}$)
  as $\amacro{\eta}$
  to match the nomenclature of \citet{Borenstein:2015aa}.
  When convenient, the same approach to nomenclature is taken with other quantities such as 
  the capital cost rate ($\rate{C}_{cap}$) and 
  maintenance and disposal cost rate ($\rate{C}_{md}$).
}
such that
$\amacro{\eta} > \bempl{\eta}$,
possibly at an increased cost to
procure (capital cost), maintain, and dispose of the device such that
$\amacro{C}_{cap} > \bempl{C}_{cap}$ and 
$\ramacro{C}_{\md} > \rbempl{C}_{\md}$.
(This is not a costless EEU.)
As final-energy-to-service efficiency~($\eta$) increases,
the price of the energy service~($p_s$) declines.
The final energy price ($p_E$) is assumed exogenous
($\amacro{p}_E = \bempl{p}_E$),
so the final energy purchaser (the device owner) is a price taker.
(Relaxing the exogenous final energy price assumption
would require a full-economy model that is beyond the scope of this paper.)

Initially, the device owner spends income ($\rorig{M}$)
on final energy for the device ($\rorig{C}_s = p_E \rorig{E}_s$), 
annualized capital costs for the device ($\rorig{C}_{cap}$), 
annualized costs for maintenance and disposal of the device ($\rorig{C}_{\md}$), and 
other goods and services ($\rorig{C}_o$).
The budget constraint
for the device owner is

\begin{equation} \label{eq:budget_constraint}
  \rorig{M} = \rorig{C}_s + \rorig{C}_{cap} + \rorig{C}_{\md} + \rorig{C}_{o} + \rorig{N} \; ,
\end{equation}
%
where 
original net savings ($\rorig{N}$) is zero.

\begin{figure}
\centering
  % The file is a Tikz picture.
  \input{pieces/flowchart.tex}
\caption{Flowchart of rebound effects and decorations.
         Rebound effects are arranged in the order of their discussion in this paper.
         The left-to-right order does not necessarily represent 
         the progression of rebound effects through time.}
\label{fig:flowchart}
\end{figure}

Later (Sections~\ref{sec:empl_effect_main_paper}--\ref{sec:macro_effect_main_paper}), 
we walk through the several conceptual stages of rebound, including
the device upgrade and four rebound effects, and 
we derive rebound expressions for each. 
But first 
we define rebound relationships 
(Section~\ref{sec:rebound_relationships}) and 
typical energy and cost relationships (Section~\ref{sec:energy_and_cost_relationships}).


%++++++++++++++++++++++++++++++
\subsection{Rebound relationships}
\label{sec:rebound_relationships}
%++++++++++++++++++++++++++++++

Energy rebound is defined as

\begin{equation} \label{eq:Re_def}
  Re \equiv 1 - \frac{\text{actual final energy savings rate}}{\text{expected final energy savings rate}} \; ,
\end{equation}
%
where both actual and expected final energy savings rates are expected positive.
Final energy ``takeback'' is the rate at which final energy savings are eroded by rebound effects,
and the actual final energy savings rate is the expected final energy savings rate less takeback.
Note that takeback can be negative, indicating an increase in the final energy savings rate
relative to the expected final energy savings rate, sometimes called hyperconservation.
Thus,

\begin{equation}
  Re = 1 - \frac{\text{expected final energy savings rate} - \text{takeback}}{\text{expected final energy savings rate}} \; .
\end{equation}
%
Simplifying gives

\begin{equation} \label{eq:Re_takeback}
  Re = \frac{\text{takeback}}{\text{expected final energy savings rate}} \; .
\end{equation}
%
Thus, energy rebound can be given by either Eq.~(\ref{eq:Re_def}) or Eq.~(\ref{eq:Re_takeback}).

We define rebound at the final energy stage, 
because that is the point of energy purchase by the device owner.
To simplify derivations, 
we choose not to apply final-to-primary energy multipliers
to final energy rates in the numerators and denominators of rebound expressions
derived from Eqs.~(\ref{eq:Re_def}) and~(\ref{eq:Re_takeback});
they divide out anyway.
Henceforth, we drop the adjective ``final'' 
unless there is reason to indicate a specific stage of the energy conversion chain.


%++++++++++++++++++++++++++++++
\subsection{Typical energy and cost relationships}
\label{sec:energy_and_cost_relationships}
%++++++++++++++++++++++++++++++

With the rebound notation of Appendix~\ref{sec:nomenclature}, 
four typical relationships emerge.
First, the consumption rate of the energy service~($\rate{q}_s$)
is the product of final-to-services efficiency~($\eta$) and
the rate of energy consumption by the energy conversion machine~($\rate{E}_s$).
Typical units for automotive transport and illumination
(the examples in Section~\ref{sec:examples}) are shown
beneath each equation.

\begin{align} \label{eq:typ_qs_eta_Edot}
  \rate{q}_s &= \eta \rate{E}_s \\
  \text{pass-km/yr} &= [\text{pass-km/MJ}] [\text{MJ/yr}] \nonumber \\
  \text{lm-hr/yr} &= [\text{lm-hr/MJ}] [\text{MJ/yr}] \nonumber
\end{align}
%
Second, the energy service price~($p_s$) is the ratio of energy price~($p_E$) to the final-to-services efficiency~($\eta$).

\begin{align} \label{eq:ps_pE_eta}
  p_s &= \frac{p_E}{\eta} \\
  \text{\$/pass-km} &= \frac{\$/\text{MJ}}{\text{pass-km/MJ}} \nonumber \\
  \text{\$/lm-hr} &= \frac{\$/\text{MJ}}{\text{lm-hr/MJ}} \nonumber
\end{align}
%
Third, energy service expenditure rates~($\rate{C}_s$) are the product 
of energy price~($p_E$) and device energy consumption rates~($\rate{E}_s$).

\begin{align}
  \rate{C}_s &= p_E \rate{E}_s \\
  \text{\$/yr} &= [\text{\$/MJ}][\text{MJ/yr}] \nonumber
\end{align}
%
Fourth, indirect energy rates~($\rate{E}_j$) are the product 
of expenditures rates~($\rate{C}_j$) and energy intensity of the economy~($I_E$).

\begin{align} \label{eq:indirect_energy_rates}
  \rate{E}_j &= \rate{C}_j I_E \\
  \text{MJ/yr} &= [\text{\$/yr}][\text{MJ/\$}] \nonumber
\end{align}
%
The subscript $j$ represents expenditures on non-energy items
in this framework: 
capital costs (subscript $cap$), 
maintenance and disposal activities (subscript $\md$), or 
other goods (subscript $o$).


%++++++++++++++++++++++++++++++
\subsection{Rebound effects}
\label{sec:rebound_effects}
%++++++++++++++++++++++++++++++

The four rebound effects of Fig.~\ref{fig:flowchart} 
(emplacement, substitution, income, and macro)
are discussed in subsections below.
In each subsection, we
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item define each rebound effect and
  
  \item show mathematical expressions for rebound.
    
\end{enumerate*}
%
Detailed derivations of all rebound expressions 
can be found in Appendix~\ref{sec:derivation}.
See, in particular, Tables~\ref{tab:empleffect}--\ref{tab:macroeffect},
which provide a parallel structure for energy and financial accounting
across all rebound effects.

Important quantities for the derivations are
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item direct and indirect energy consumption rates ($\rate{E}_{dir}$, $\rate{E}_{indir}$), 
  
  \item direct and indirect expenditure rates ($\rate{C}_{dir}$ and $\rate{C}_{indir}$), 
  
  \item the consumption rate of the energy service ($\rate{q}_s$), and
  
  \item the consumption rate of other goods ($\rate{C}_o$).
    
\end{enumerate*}
%
These important rebound quantities can be illustrated via
rebound path graphs.
(See Appendix~\ref{sec:graph_details} for 
detailed mathematical descriptions of rebound path graphs.)
Figs.~\ref{fig:ExampleEnergyPathGraph}--\ref{fig:ExampleConsPathGraph} show
notional rebound path graphs through energy, expenditure, and consumption spaces
for purposes of illustration.
The notional path graphs are not quantified; there are no scales on the axes.
Later (Section~\ref{sec:examples}), 
rebound path graphs (with scales) illustrate the numerical examples.

Fig.~\ref{fig:ExampleEnergyPathGraph} shows a notional energy path graph, with 
the direct energy consumption rate ($\rate{E}_{dir}$) on the abscissa
and
the indirect energy consumption rate ($\rate{E}_{indir}$) on the ordinate.
Lines with negative slope through points 
$\circ$, $a$, $*$, $\wedge$, $-$, and $\sim$
indicate energy consumption isoquants
(direct and indirect) at key points.

A notional expenditure path graph is shown in Fig.~\ref{fig:ExampleCostPathGraph}, 
with 
the direct expenditure rate on the energy service ($\rate{C}_{dir}$) on the abscissa and 
the indirect expenditure rate ($\rate{C}_{indir}$) on the ordinate.
Lines with negative slope through points $\circ$ and $a$
indicate expenditure isoquants (direct and indirect).

A notional consumption path graph is shown in Fig.~\ref{fig:ExampleConsPathGraph}.
The indexed rate of energy service consumption ($\rate{q}_s/\rbempl{q}_s$) is shown on the abscissa, and
the indexed rate of other goods consumption ($\rate{C}_o/\rbempl{C}_o$) is shown on the ordinate.
Isoquants of indexed other goods and energy service consumption 
are shown as lines with negative slope. 
Indifference curves are denoted by \iicirc{} and \iibar{}. 
A ray from the origin through the $\wedge$ point is denoted \rr{}.

<<eeu_data, echo=FALSE>>=
# Load our test cases and perform rebound analyses.
rebound_data <- ReboundTools::load_eeu_data("data/eeu_data.xlsx")
rebound_results <- ReboundTools::rebound_analysis(rebound_data)
@


<<ExampleEnergyPathGraph,  echo=FALSE, warning=FALSE, fig.cap="Notional energy path.", fig.width=6, fig.height=4>>=
stage_size <- 10
orig_size <- stage_size
star_size <- stage_size
hat_size <- stage_size - 3
bar_size <- stage_size - 5
tilde_size <- stage_size - 5

stage_colour <- "black"
abcd_size <- 4
abcd_colour <- "darkgray"

annotation_angle <- -45.6
annotation_size <- 4
annotation_colour <- "black"

example_arrow_angle <- 19.0 * pi/180
example_arrow_size <- 0.5 # width

example_energy_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size, ~angle,
                                         1.01, 1.008, 'degree', 
                                           stage_colour, orig_size, 0,
                                         0.115, 1.008, 'a', 
                                           abcd_colour, abcd_size, 0,
                                         0.085, 0.973, 'b', 
                                           abcd_colour, abcd_size, 0,
                                         0.085, 0.95, '"*"', 
                                           stage_colour, star_size, 0,
                                         0.09, 0.935, 'c', 
                                           abcd_colour, abcd_size, 0,
                                         0.242, 0.923, '"^"', 
                                           stage_colour, hat_size, 0,
                                         0.295, 0.942, 'd', 
                                           abcd_colour, abcd_size, 0,
                                         0.295, 1.036, 'bold("_")', 
                                           stage_colour, bar_size, 0,
                                         0.29, 1.13, '"~"', 
                                           stage_colour, tilde_size, 0,
                                         0.04, 0.923, 'Hyperconservation', 
                                           annotation_colour, 
                                           annotation_size-1,
                                           annotation_angle,
                                         0.02, 1.043, 'Re[tot] == 0*"%"', 
                                           annotation_colour, 
                                           annotation_size, 
                                           annotation_angle,
                                         0.03, 1.005, 'Re[empl]', 
                                           annotation_colour,  
                                           annotation_size - 1, 
                                           annotation_angle + 90,
                                         0.21, 0.90, 'Re[sub]', 
                                           annotation_colour, 
                                           annotation_size - 1,
                                           annotation_angle + 90,
                                         0.39, 0.936, 'Re[inc]', 
                                           annotation_colour, 
                                           annotation_size, 
                                           annotation_angle + 90,
                                         0.68, 0.935, 'Re[macro]', 
                                           annotation_colour, 
                                           annotation_size, 
                                           annotation_angle + 90,
                                         0.754, 1.1, 'Re[tot] == 100*"%"', 
                                           annotation_colour, 
                                           annotation_size, 
                                           annotation_angle,
                                         0.95, 1.1, 'Backfire', 
                                           annotation_colour, 
                                           annotation_size, 
                                           annotation_angle)
example_Re_arrows <- tibble::tribble(~x, ~y, ~angle, ~radius, ~colour, ~size,
                                     # Re_empl arrow
                                     0.078, 1.01, example_arrow_angle, 
                                       -0.063, annotation_colour, example_arrow_size,
                                     # Re_sub arrow
                                     0.249, 0.904, example_arrow_angle, 
                                       0.04, annotation_colour, example_arrow_size,
                                     # Re_inc arrow
                                     0.327, 0.904, example_arrow_angle, 
                                       0.157, annotation_colour, example_arrow_size,
                                     # Re_macro arrow
                                     0.622, 0.904, example_arrow_angle, 
                                       0.146, annotation_colour, example_arrow_size) 
rebound_results %>% 
  ReboundTools::path_graphs(cases = "Example", 
                               graph_types = "Energy", 
                               indexed = TRUE) + 
  ggplot2::xlim(0, 1.1) +
  ggplot2::ylim(0.9, 1.15) +
  ggplot2::xlab(expression(dot(E)[dir] * " [MJ/year]")) +
  ggplot2::ylab(expression(dot(E)[indir] * " [MJ/year]")) +
  ggplot2::geom_spoke(data = example_Re_arrows,
                        mapping = ggplot2::aes(x = x,
                                               y = y,
                                               angle = angle,
                                               radius = radius,
                                               colour = colour),
                        arrow = ggplot2::arrow(length = ggplot2::unit(0.1,"cm"))) +
  ggplot2::geom_text(data = example_energy_labels,
                     mapping = ggplot2::aes(x = x,
                                            y = y,
                                            label = lab,
                                            colour = colour,
                                            size = size,
                                            angle = angle),
                     parse = TRUE) +
  MKHthemes::xy_theme() + 
  # remove axis labels and ticks
  ggplot2::theme(axis.text.x = ggplot2::element_blank(),
                 axis.ticks.x = ggplot2::element_blank(),
                 axis.text.y = ggplot2::element_blank(),
                 axis.ticks.y = ggplot2::element_blank(),
                 axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 6)))
@


<<ExampleCostPathGraph, echo=FALSE, fig.cap="Notional expenditure path.", fig.width=6, fig.height=4>>=
cost_line_angle <- -16.3
example_cost_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size, ~angle,
                                       1.01, 1.003, 'degree', 
                                       stage_colour, orig_size, 0,
                                       0.098, 1.003, 'a', 
                                       abcd_colour, abcd_size, 0,
                                       0.09, 0.972, 'b', 
                                       abcd_colour, abcd_size, 0,
                                       0.128, 0.955, '"*"', 
                                       stage_colour, star_size, 0,
                                       0.09, 0.936, 'c', 
                                       abcd_colour, abcd_size, 0,
                                       0.24, 0.938, '"^"', 
                                       stage_colour, hat_size, 0,
                                       0.283, 0.937, 'd', 
                                       abcd_colour, abcd_size, 0,
                                       0.243, 1.034, 'bold("_")',
                                       stage_colour, bar_size, 0,
                                       0.635, 1.02, 'Original~expenditure', 
                                       annotation_colour, annotation_size, cost_line_angle,
                                       0.43, 0.944, 'After~emplacement', 
                                       annotation_colour, annotation_size, cost_line_angle,
                                       0.55, 0.9825, 'After~expected~savings', 
                                       annotation_colour, annotation_size, cost_line_angle,
                                       0.17, 0.9416, 'After~CV', 
                                       annotation_colour, annotation_size-1, cost_line_angle)

rebound_results %>% 
  ReboundTools::path_graphs(cases = "Example", 
                               graph_types = "Expenditure", 
                               indexed = TRUE) + 
  # ggplot2::xlim(0, 1.1) +
  # ggplot2::ylim(0.9995, 1.0005) +
  ggplot2::xlab(expression(dot(C)[dir] * " [$/year]")) +
  ggplot2::ylab(expression(dot(C)[indir] * " [$/year]")) +
  
  ggplot2::geom_text(data = example_cost_labels,
                     mapping = ggplot2::aes(x = x,
                                            y = y,
                                            label = lab,
                                            colour = colour,
                                            size = size,
                                            angle = angle),
                     parse = TRUE) +
  MKHthemes::xy_theme() + 
  # remove axis labels and ticks
  ggplot2::theme(axis.text.x = ggplot2::element_blank(),
                 axis.ticks.x = ggplot2::element_blank(),
                 axis.text.y = ggplot2::element_blank(),
                 axis.ticks.y = ggplot2::element_blank(),
                 axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 6)))
@


<<ExampleConsPathGraph, echo=FALSE, warning=FALSE, fig.cap="Notional consumption path.", fig.width=6, fig.height=4>>=
orig_line_label_size <- orig_size - 3
star_line_label_size <- star_size - 4
hat_line_label_size <- hat_size - 3
bar_line_label_size <- bar_size - 1
r_line_label_size <- abcd_size
i_line_label_size <- abcd_size
line_label_colour <- "darkgray"
  
labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size,
                          1.04, 1.005, 'degree', 
                            annotation_colour, orig_size,
                          1.09, 1.00, '","', 
                            annotation_colour, orig_size-3,
                          1.14, 1.0005, '"*"', 
                            annotation_colour, star_size,
                          0.7, 1.011, 'degree', 
                            line_label_colour, orig_line_label_size,
                          1.54, 0.97, 'degree',
                            line_label_colour, orig_line_label_size,
                          0.7, 0.996, '"*"', 
                            line_label_colour, star_line_label_size,
                          3.5, 0.981, '"*"', 
                            line_label_colour, star_line_label_size,
                          0.96, 0.98, 'c', 
                            abcd_colour, abcd_size,
                          2.27, 0.972, '"^"',  
                            annotation_colour, hat_size,
                          0.7, 0.989, '"^"',
                            line_label_colour, hat_line_label_size,
                          3.5, 0.974, '"^"', 
                            line_label_colour, hat_line_label_size,
                          2.52, 0.983, 'd', 
                            abcd_colour, abcd_size,
                          2.43, 1.087, 'bold("_")',  
                            annotation_colour, bar_size,
                          0.7, 1.09, '"_"',
                            line_label_colour, bar_line_label_size,
                          3.5, 1.075, '"_"',
                            line_label_colour, bar_line_label_size,
                          2.18, 0.97, 'r',
                            line_label_colour, r_line_label_size,
                          2.6, 1.15, 'r',  
                            line_label_colour, r_line_label_size,
                          0.75, 1.027, 'i*degree', 
                            line_label_colour, i_line_label_size,
                          3.4, 0.981, 'i*degree', 
                            line_label_colour, i_line_label_size,
                          0.75, 1.143, 'bar(i)', 
                            line_label_colour, i_line_label_size,
                          3.4, 1.084, 'bar(i)', 
                            line_label_colour, i_line_label_size,
                          )
rebound_results %>% 
  ReboundTools::path_graphs(cases = "Example", 
                               graph_types = "Consumption") + 
  ggplot2::xlim(0.7, 3.5) +
  ggplot2::ylim(0.97, 1.15) +
  ggplot2::geom_text(data = labels, 
                     mapping = ggplot2::aes(x = x, y = y, 
                                            label = lab, 
                                            colour = colour, 
                                            size = size), 
                     parse = TRUE) +
  MKHthemes::xy_theme() + 
  # remove axis labels and ticks
  ggplot2::theme(axis.text.x = ggplot2::element_blank(),
                 axis.ticks.x = ggplot2::element_blank(),
                 axis.text.y = ggplot2::element_blank(),
                 axis.ticks.y = ggplot2::element_blank(),
                 axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 6)))
@

In the subsections that follow, the notional graphs
(Figs.~\ref{fig:ExampleEnergyPathGraph}--\ref{fig:ExampleConsPathGraph})
serve to illustrate the development of the framework.
We begin with the emplacement effect.


%------------------------------
\subsubsection{\Empleffect}
\label{sec:empl_effect_main_paper}
%------------------------------

The emplacement effect (segments \circa{}, \ab{}, and \bstar{} 
in Figs.~\ref{fig:ExampleEnergyPathGraph} and~\ref{fig:ExampleCostPathGraph})
accounts for performance of the EEU only;
behavior changes are addressed later, 
in the substitution and income effects. 
The direct emplacement effects of the EEU include
device energy savings ($\Sdot$) and device energy cost savings ($\Delta \raempl{C}_s$),
on segments \circa{} in Figs.~\ref{fig:ExampleEnergyPathGraph} 
and~\ref{fig:ExampleCostPathGraph}, respectively.
The indirect effects of EEU emplacement are
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item changes%
          \footnote{
            ``Changes'' means rates \emph{after} the EEU less rates \emph{before} the EEU.
          }
        in the embodied energy rate ($\Delta \raempl{E}_{emb}$)
        (segment \ab{} in Fig.~\ref{fig:ExampleEnergyPathGraph}), 
  
  \item changes in the capital expenditure rate ($\Delta \raempl{C}_{cap}$)
        (segment \ab{} in Fig.~\ref{fig:ExampleCostPathGraph}), and 
        
  \item changes in the maintenance and disposal energy and expenditure rates 
        ($\Delta \raempl{E}_{\md}$ and $\Delta \raempl{C}_{\md}$)
        (segments \bstar{} in Figs.~\ref{fig:ExampleEnergyPathGraph} and \ref{fig:ExampleCostPathGraph}).
    
\end{enumerate*}

The rate of energy savings
due to the direct emplacement effect  
($\Sdot$, segment \circa{} in Fig.~\ref{fig:ExampleEnergyPathGraph})
is given by

\begin{equation} \label{eq:S_dot_def}
  \Sdot \equiv \rbempl{E}_s - \raempl{E}_s = - \Delta \raempl{E}_s \; .
\end{equation}
%
Appendix~\ref{sec:Sdot} shows that $\Sdot$ can be rewritten conveniently as

\begin{equation} \label{eq:Sdot}
  \Sdot = \Sdoteqn \; .
\end{equation}

Because behavior changes are not considered
in the direct emplacement effect,
actual and expected energy savings rates are identical.
By definition, then, the direct emplacement effect causes no rebound.
Thus, 

\begin{equation} \label{eq:Re_dempl0}
  Re_{dempl} = 0 \; .
\end{equation}
%
In the notional energy path graph of Fig.~\ref{fig:ExampleEnergyPathGraph}, 
point $a$ lies on the $Re_{tot} = 0\%$ line
indicating that point $a$ (and the $Re_{tot} = 0\%$ line) 
is the point from which all rebound effects 
($Re_{empl}$, $Re_{sub}$, $Re_{inc}$, and $Re_{\macro}$)
are measured.
If rebound effects cause 
total energy demand to return to the original energy consumption level 
(negative sloping line through the $\circ$ point), 
all expected energy savings are taken back by rebound effects. 
Thus, the line of constant energy consumption through the $\circ$ point is labeled
$Re_{tot} = 100\%$.
Total rebound ($Re_{tot}$) is measured linearly between and beyond the
$Re_{tot} = 0\%$ and $Re_{tot} = 100\%$ lines, 
with direct rebound in the $x$ direction and 
indirect rebound in the $y$ direction.
The region below and to the left of the $Re_{tot} = 0\%$ line
in Fig.~\ref{fig:ExampleEnergyPathGraph}
exhibits negative rebound, indicating hyperconservation.
The region above and to the right of the $Re_{tot} = 100\%$ line 
shows ``backfire,'' 
i.e.\ greater energy consumption after the EEU than before it. 

Although the direct emplacement effect does not cause rebound, 
Fig.~\ref{fig:ExampleEnergyPathGraph} shows that
indirect emplacement effects may cause rebound.
Indirect emplacement effects 
(segments \ab{} and \bstar{}
in Figs.~\ref{fig:ExampleEnergyPathGraph} and~\ref{fig:ExampleCostPathGraph}) 
account for the life cycle of the energy conversion device,
including energy embodied by manufacturing processes (subscript $emb$) and
maintenance and disposal activities (subscript $\md$).
In the notional energy path graph (Fig.~\ref{fig:ExampleEnergyPathGraph}), 
emplacement rebound is negative ($Re_{empl} < 0$),
because the upgraded device has a lesser
embodied energy rate ($\raempl{E}_{emb} < \rbempl{E}_{emb}$)
and a lesser maintenance and disposal expenditure rate ($\raempl{C}_{\md} < \rbempl{C}_{\md}$)
than the original device.
Fig.~\ref{fig:ExampleCostPathGraph} shows segments \ab{} and \bstar{}
moving in the negative direction,
consistent with a lower capital expenditure rate
($\raempl{C}_{cap} < \rbempl{C}_{cap}$) and 
a reduced maintenance and disposal expenditure rate
($\raempl{C}_{\md} < \rbempl{C}_{\md}$).

One of the unique features of this framework
is that independent analyses of embodied energy and 
capital costs of the EEU are expected.
We note that the different terms 
(embodied energy rate, $\rate{E}_{emb}$, and
capital cost rate, $\rate{C}_{cap}$)
might seem to imply different processes, 
but they actually refer to the same emplacement effect, 
namely energy segment \ab{} and expenditure segment \ab{} 
in energy and expenditure path graphs
(Figs.~\ref{fig:ExampleEnergyPathGraph} and
\ref{fig:ExampleCostPathGraph}, respectively).
Purchasing an upgraded device
(which likely leads to $\rbempl{C}_{cap} \neq \raempl{C}_{cap}$)
will likely mean a changed embodied energy rate ($\rbempl{E}_{emb} \neq \raempl{E}_{emb}$) 
to provide the same energy service.
Our names for these aspects of rebound (embodied energy and capital cost)
reflect common usage 
in the energy and economics fields, respectively.
In the notional graphs of
Figs.~\ref{fig:ExampleEnergyPathGraph} and~\ref{fig:ExampleCostPathGraph}, 
embodied energy rates and capital cost rates
(represented by energy segment \ab{} and expenditure segment \ab{}, respectively) 
move in the same direction (both negative).
However, both segments \ab{} could move in the positive direction, or
they could move in opposite directions, 
depending on the results of the independent analyses for 
embodied energy and capital cost rates.

Consistent with the energy/exergy analysis literature, 
we define embodied energy 
to be the sum of all final energy (direct and indirect) 
consumed in the production of the energy conversion device.
Energy is embodied in the device within manufacturing and distribution supply chains
prior to consumer acquisition of the device.
No energy is embodied in the device while in service.
The EEU causes the embodied energy of the energy conversion device to change
from $\orig{E}_{emb}$ to $\aempl{E}_{emb}$.

However, for simplicity, we spread all embodied energy
over the lifetime of the device
to provide a uniform embodied energy rate ($\rate{E}_{emb}$),
(We later take the same approach to capital costs ($\rate{C}_{cap}$) and
maintenance and disposal costs ($\rate{C}_{\md}$).)
A justification for spreading embodied energy purchase costs comes from considering
device replacements by many consumers across several years.
In the aggregate, evenly spaced (in time) replacements
work out to the same embodied energy in every period.

Thus, we allocate embodied energy over the life of the original and upgraded devices
($\bempl{t}_{\life}$ and $\aempl{t}_{\life}$, respectively)
to obtain embodied energy rates, such that
$\rbempl{E}_{emb} = \bempl{E}_{emb} / \bempl{t}_{\life}$
and 
$\raempl{E}_{emb} = \aempl{E}_{emb} / \aempl{t}_{\life}$.
The change in embodied final energy due to the EEU (expressed as a rate) is given by
$\raempl{E}_{emb} - \rbempl{E}_{emb}$
and is shown as segment \ab{} in Fig.~\ref{fig:ExampleEnergyPathGraph}.
The expression for embodied energy rebound is derived in 
Appendix~\ref{sec:Re_emb} to be

\begin{equation} \label{eq:Re_emb}
  Re_{emb} = \Reembeqn{} \; .
\end{equation}

Embodied energy rebound ($Re_{emb}$)
can be either positive or negative, depending on 
the sign of the term
$(\aempl{E}_{emb}/\bempl{E}_{emb})(\bempl{t}_{\life}/\aempl{t}_{\life}) - 1$.
Rising energy efficiency can be associated with increased device complexity,
additional energy consumption in manufacturing, and
more embodied energy,
such that $\aempl{E}_{emb} > \bempl{E}_{emb}$ and $Re_{emb} > 0$,
all other things being equal.
However, if the upgraded device has longer life than the original device
($\aempl{t}_{\life} > \bempl{t}_{\life}$),
$\raempl{E}_{emb} - \rbempl{E}_{emb}$ could be negative,
meaning that the upgraded device has a lower embodied energy rate than the original device,
as shown by point \emph{2} being below point \emph{1} 
in the notional energy path graph of Fig.~\ref{fig:ExampleEnergyPathGraph}.
See Appendix~\ref{sec:Re_emb} for details.

In addition to embodied energy, 
indirect emplacement effect rebound accounts for
energy demanded by maintenance and disposal~($\md$) activities
(segments \bstar{} in Figs.~\ref{fig:ExampleEnergyPathGraph} and~\ref{fig:ExampleCostPathGraph}).
Maintenance expenditures are typically modeled as a per-year expense, a rate (e.g., $\rbempl{C}_m$).
Disposal costs (e.g., $\bempl{C}_d$) are one-time expenses incurred 
at the end of the useful life of the energy conversion device.
Like embodied energy, we spread disposal costs across the lifetime 
of the original and upgraded devices ($\bempl{t}_{\life}$ and $\aempl{t}_{\life}$, respectively)
to form expenditure rates such that 
$\rbempl{C}_{\md} = \rbempl{C}_m + \bempl{C}_d/\bempl{t}_{\life}$
and
$\raempl{C}_{\md} = \raempl{C}_m + \aempl{C}_d/\aempl{t}_{\life}$.

For simplicity, we assume that maintenance and disposal
expenditures imply energy consumption
elsewhere in the economy at its overall energy intensity~($I_E$).
Therefore, the change in energy consumption rate caused by a change 
in maintenance and disposal expenditures
is given by $\Delta \raempl{C}_{\md} I_E = (\raempl{C}_{\md} - \rbempl{C}_{\md}) I_E$, 
shown as segment \bstar{} in Fig.~\ref{fig:ExampleEnergyPathGraph}.
Rebound from maintenance and disposal activities 
is given by 

\begin{equation} \label{eq:Re_md}
  Re_{\md} = \ReOMdeqn{} \; .
\end{equation}
%
See Appendix~\ref{sec:Re_OMd} for details of the derivation.


%------------------------------
\subsubsection{\Subeffect}
\label{sec:sub_effect_main_paper}
%------------------------------

Neoclassical consumer theory distinguishes between
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item substituting energy service consumption for
        other goods consumption due to the lower post-EEU price of the energy service 
        (the substitution effect) and
  
  \item re-spending the higher real income (the income effect). 
    
\end{enumerate*}
%
This section develops mathematical expressions 
for substitution effect rebound ($Re_{sub}$).
(The next section addresses income effect rebound, $Re_{inc}$.)
The substitution effect alters compensated demand, 
the expenditure minimizing consumption bundle that
maintains utility at the pre-EEU upgrade, given the new prices. 
It involves
%
\begin{enumerate*}[label={(\roman*)}]

  \item an increase in consumption of the energy service,
        a direct substitution effect (subscript $dsub$) and

  \item a compensating decrease in consumption of other goods,
        an indirect substitution effect (subscript $isub$).

\end{enumerate*}
%
Thus, two terms comprise substitution effect rebound,
direct substitution rebound ($Re_{dsub}$) and
indirect substitution rebound ($Re_{isub}$).
The substitution effect is shown by segments
\starc{} (indirect component) and \chat{} (direct component) 
in Figs.~\ref{fig:ExampleEnergyPathGraph}--\ref{fig:ExampleConsPathGraph}.

The substitution effect is best described 
with reference to a consumption path graph (Fig.~\ref{fig:ExampleConsPathGraph}).
Prior to the EEU, the consumption basket (of the energy service and other goods)
is represented by the $\circ$ point, and 
the line of constant expenditure, the budget constraint, is \circcirc{}.
The \circcirc{} line is tangent to the lower indifference curve 
(\iicirc{}) at point $\circ$, the optimal consumption
bundle prior to device upgrade.
After emplacement of the more efficient device
(but before the substitution effect), 
the price of the energy service decreases ($\aempl{p}_s < \bempl{p}_s$),
pivoting the budget constraint outward, to \starstar{}.
By definition, the substitution effect indicates the optimal
consumption bundle at the $\wedge$ point, after a compensating variation  
translates into a lower budget constraint \hathat{} 
in Fig.~\ref{fig:ExampleConsPathGraph}.
The $\wedge$ point shows consumption with new prices yielding utility
at the level prior to the EEU,
by taking advantage of the lower energy service price, 
hence favoring energy service consumption (because it is now less expensive)
at the expense of other goods consumption (which are now relatively more expensive).

The substitution effect can be decomposed into 
indirect (the decrease in other goods consumption, segment \starc{}) 
and 
direct (the increase in energy service consumption, segment \chat{})
components.
The impact of the substitution effect on energy consumption rates and expenditure rates
can be seen in Figs.~\ref{fig:ExampleEnergyPathGraph}
and~\ref{fig:ExampleCostPathGraph}, respectively. In particular, the 
latter indicates the expenditure after the compensating variation (CV).

An approximate utility model
is often used in the literature
(e.g., see \citet[p.~17, footnote~43]{Borenstein:2015aa})
for determining 
the post-substitution effect point
and therefore $Re_{dsub}$ and $Re_{isub}$.
The approximate utility model assumes that 
the compensated energy service price elasticity of energy service demand ($\eqspsC$) and
the compensated energy service cross-price elasticity of other goods demand ($\eqopsC$)
are constant along an indifference curve.
Whether that is true depends on the utility function used.
Constant price elasticities (as in the approximate utility model)
are approximations that are only applicable to marginal price changes. 
Appendix~\ref{sec:Re_sub} contains details of the approximate utility model.

Here, we present an exact method that allows 
the compensated energy service price elasticity of energy service demand ($\eqspsC$) and
the compensated energy service cross-price elasticity of other goods demand ($\eqopsC$)
to vary along an indifference curve, allowing analysis of
non-marginal price changes ($\aempl{p}_s <\!\!< \orig{p}_s$). 
We use a fully specified 
CES utility model,
which allows the exact, direct calculation
of the utility maximizing consumption bundle for any constraint.
The utility model describes the device owner's behavior as

\begin{equation} \label{eq:ces_utility}
  \frac{\rate{u}}{\rbempl{u}} = \cesutility{} \; .
\end{equation}

The device owner's utility
(relative to the original condition, $\rate{u}/\rorig{u}$)
is determined by
the consumption rate of the energy service ($\rate{q}_s$) and
the consumption rate of other goods and services ($\rate{C}_o$).
The share parameter ($\fCs$) is taken from the original (pre-EEU) consumption basket.
The exponent $\rho$ is calculated from the (constant) elasticity of substitution ($\sigma$) 
as $\rho \equiv (\sigma - 1)/\sigma$.
See Appendix~\ref{sec:utility_and_elasticities}
for further details of the CES utility model.

Direct substitution effect rebound ($Re_{dsub}$) is

\begin{equation} \label{eq:Re_dsub_def}
  Re_{dsub} = \frac{\Delta \rasub{E}_s}{\Sdot} \; ,
\end{equation}
%
which can be rearranged to

\begin{equation} \label{eq:Re_dsub_prelim}
  Re_{dsub} = \frac{\frac{\rasub{q}_s}{\rbempl{q}_s} - 1}{\frac{\amacro{\eta}}{\bempl{\eta}} - 1} \; .
\end{equation}

Indirect substitution effect rebound ($Re_{isub}$) is given by

\begin{equation} \label{eq:Re_isub_def}
  Re_{isub} = \frac{\Delta \rasub{C}_o I_E}{\Sdot} \; ,
\end{equation}
%
which can be rearranged to 

\begin{equation} \label{eq:Re_isub_prelim}
  Re_{isub} = \frac{\frac{\rasub{C}_o}{\rorig{C}_o} - 1}{\etaratiostacked - 1} \; 
                          \etaratiostacked \; 
                          \frac{\rbempl{C}_o I_E}{\rbempl{E}_s} \; .
\end{equation}

To find the post-substitution effect point ($\wedge$),
we solve for the location on the \iicirc{} indifference curve
where its slope is equal to the slope of the
\starstar{} expenditure line.
The results are

\begin{equation} \label{eq:q_s_solution}
  \frac{\rasub{q}_s}{\rbempl{q}_s} = \qssolution{}
\end{equation}
%
and

\begin{equation} \label{eq:C_o_solution}
  \frac{\rasub{C}_o}{\rbempl{C}_o} = \Cosolution{} \; .
\end{equation}

Eq.~(\ref{eq:q_s_solution}) can be substituted directly
into Eq.~(\ref{eq:Re_dsub_prelim})
to obtain an expression for direct substitution rebound ($Re_{dsub}$)
via the CES utility model.

\begin{equation} \label{eq:Re_dsub_CES}
  Re_{dsub} = \RedsubCES{}
\end{equation}

Eq.~(\ref{eq:C_o_solution}) can be substituted directly
into Eq.~(\ref{eq:Re_isub_prelim})
to obtain an expression for indirect substitution rebound ($Re_{isub}$)
via the CES utility model.

\begin{equation} \label{eq:Re_isub_CES}
  Re_{isub} = \ReisubCES{}
\end{equation}

See Appendix~\ref{sec:Resub_exact_method} for details
of the derivations of Eqs.~(\ref{eq:Re_dsub_prelim}), 
(\ref{eq:Re_isub_prelim}), and 
(\ref{eq:q_s_solution})--(\ref{eq:Re_isub_CES}).


%------------------------------
\subsubsection{\Inceffect}
\label{sec:inc_effect_main_paper}
%------------------------------

The monetary income rate of the device owner, $\rbempl{M}$, 
remains unchanged across the rebound effects, 
such that
$\rbempl{M} = \raempl{M} = \rasub{M} = \rainc{M} = \ramacro{M}$.
Thanks to the energy service price decline, real income rises, 
and freed cash from the EEU is given by Eq.~(\ref{eq:G_dot})
as $\rate{G} = p_E \Sdot$. 
Emplacement effect expenditures and compensating variation
modify freed cash to leave the device owner with
\emph{net} income ($\rasub{N}$) from the EEU,
as shown in Eq.~(\ref{eq:N_dot_after_sub}).
Derivations of expressions for freed cash from the 
emplacement effect ($\rate{G}$)
and net savings after the substitution effect ($\rasub{N}$)
are presented in Tables~\ref{tab:empleffect} and~\ref{tab:subeffect}.
Rebound from the income effect quantifies the rate of additional energy demand 
that arises when the energy conversion device owner spends net
savings from the EEU
(segments \hatd{} and \dbar{} in 
Figs.~\ref{fig:ExampleEnergyPathGraph}--\ref{fig:ExampleConsPathGraph}).

In this framework,
the income effect must satisfy several constraints.
First, net savings must be zero after
the income effect ($\rainc{N} = 0$).
The monetary budget constraint $\rbempl{M}$ holds, so that only 
net savings ($\rasub{N}$) can be re-spent. Due to standard non-satiation
assumptions on preference (and in particular for the CES utility function),
net savings should be completely re-spent.
This constraint can be seen in 
expenditure path graphs (e.g., Fig.~\ref{fig:ExampleCostPathGraph})
where the post-income-effect point ($-$) returns to the original expenditure line.
See Appendix~\ref{sec:proof_income_elasticities}
for a mathematical proof that the income preference equations below
(Eqs.~(\ref{eq:qsrat_eqsM}) and~(\ref{eq:qorat_eqoM}))
satisfy the first constraint.

Second, net savings should be re-spent on only 
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item additional spending on the energy service ($\rainc{q}_s > \rbinc{q}_s$, segment \hatd{}) and
  
  \item additional spending on other goods ($\rainc{q}_o > \rbinc{q}_o$, segment \dbar{}).
    
\end{enumerate*}
%
This constraint is satisfied by construction below.

A third constraint follows from the homothetic
preferences in a CES utility function but need not hold in general.
Additional spending on the energy service and other goods 
is allocated in the same proportion as post-substitution-effect 
expenditures on the energy service and other goods.
This constraint is also satisfied by construction below, 
particularly via an effective income ($\Mdothatprime$).
This constraint can be seen in the consumption path graph
where the pre- and post-income-effect points ($\wedge$ and $-$, respectively)
lie along ray \rr{} from the origin through point $\wedge$ in Fig.~\ref{fig:ExampleConsPathGraph}.
However, this framework could accommodate non-homothetic preferences
for spending across the income effect.

We next show expressions for 
direct and indirect income effect rebound.

%..............................
\paragraph{Direct income effect} 
\label{sec:direct_income_effect}
%..............................

The income elasticity of energy service demand ($\eqsM$)
quantifies the amount of net savings spent 
on more of the energy service ($\rainc{q}_s > \rbinc{q}_s$).
(See Appendix~\ref{sec:utility_and_elasticities} 
for additional information about elasticities.)
Spending of net savings on the energy service 
leads to direct income effect rebound ($Re_{dinc}$).

The ratio of rates of energy service consumed across the income effect is given by

\begin{equation} \label{eq:qsrat_eqsM}
  \incprefseqn \; .
\end{equation}
%
Homotheticity means that $\eqsM = 1$.
The increased consumption rate of the energy service is 
represented by segments \hatd{} 
in Figs.~\ref{fig:ExampleEnergyPathGraph}--\ref{fig:ExampleConsPathGraph}.

Effective income ($\Mdothatprime$) is given by 

\begin{equation} \label{eq:effective_income}
  \effinceqn{} \; .
\end{equation}
%
For the purposes of the income effect, 
the effective income equation (Eq.~(\ref{eq:effective_income})) 
adjusts income ($\rorig{M}$) to account for 
sunk costs ($\raempl{C}_{cap}$ and $\raempl{C}_{\md}$) and
net income ($\rasub{N}$).

Direct income rebound is defined as

\begin{equation} \label{eq:Re_dinc_def}
  Re_{dinc} \equiv \frac{\Delta \rainc{E}_s}{\Sdot} \; .
\end{equation}
%
(See Table~\ref{tab:inceffect}.)
After substitution, rearranging, and canceling of terms (Appendix~\ref{sec:Re_dinc}), 
the expression for direct income rebound is

\begin{equation} \label{eq:Re_dinc}
  Re_{dinc} = \Redinceqnexact{} \; .
\end{equation}
%
If there is no net savings after the substitution effect ($\rasub{N} = 0$), 
direct income effect rebound is zero ($Re_{dinc} = 0$), as expected.
See Appendix~\ref{sec:Re_inc} for details of the derivation
of income effect rebound.


%..............................
\paragraph{Indirect income effect} 
\label{sec:indirect_income_effect}
%..............................

The income elasticity of other goods demand ($\eqoM$)
quantifies the amount of net savings spent 
on additional other goods ($\rainc{q}_o > \rbinc{q}_o$).
Spending of net savings on other goods and services
leads to indirect income effect rebound ($Re_{iinc}$).

The ratio of rates of other goods consumed across the income effect is given by

\begin{equation} \label{eq:qorat_eqoM}
  \incprefoeqn \; 
\end{equation}
%
and is represented by segments \dbar{} 
in Figs.~\ref{fig:ExampleEnergyPathGraph}--\ref{fig:ExampleConsPathGraph}.
Under the assumption that prices of other goods are exogenous
(see Appendix~\ref{sec:other_goods_expenditures}), 
the ratio of rates of other goods consumption ($\rasub{q}_o/\rorig{q}_o$)
is equal to the ratio of rates of other goods expenditures ($\rasub{C}_o/\rorig{C}_o$)
such that 

\begin{equation} \label{eq:Corat_eqoM}
  \frac{\rasub{C}_o}{\rorig{C}_o} = \left( 1 + \frac{\rasub{N}}{\Mdothatprime} \right)^{\eqoM} \; .
\end{equation}
%
Homotheticity means that $\eqoM = 1$.
As shown in Table~\ref{tab:inceffect}, indirect income rebound is defined as

\begin{equation} \label{eq:Re_iinc_def}
  Re_{iinc} \equiv \frac{\Delta \rainc{C}_o I_E}{\Sdot} \; .
\end{equation}
%
After substitution, rearranging, and canceling of terms (Appendix~\ref{sec:Re_iinc}), 
the expression for indirect income rebound is

\begin{equation} \label{eq:Re_iinc}
  Re_{iinc} = \Reiinceqnexact{} \; .
\end{equation}
%
See Appendix~\ref{sec:Re_inc} for details of the derivation
of income effect rebound.


%------------------------------
\subsubsection{\Macroeffect}
\label{sec:macro_effect_main_paper}
%------------------------------

The previous rebound effects
(emplacement effect, substitution effect, and income effect)
are microeconomic in nature. 
% However, it follows immediately
% from the assumption on the income effect that the economy grows.
However, the changes at the micro level have important implications at the macro level,
including economic expansion.
As the price level in the economy falls, 
consumption of goods grows, and the economy grows. 
Efficiency-driven economic expansion is
described by \citeauthor{Hulten1978}'s theorem,
which states that the economy grows at the rate 
of an efficiency increase in some part of the economy, 
scaled by that part's expenditure share~\citep{Hulten1978}.
\citeauthor{blackburn2020energy}  
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item show that Hulten's theorem also applies to factor-augmenting technical change and
  
  \item express rebound as a scale effect \citep{blackburn2020energy}.
    
\end{enumerate*}

However, the scale effect is static and does not account for
possible follow-up technological change induced by the EEU%
\footnote{
  In the first year, 
  the technological improvement could even have contractionary effects \citep{Basu2006}.
}.
The framework incorporates annual average effects over 
the lifetime of the upgraded device, 
so dynamic effects that take time to unfold matter.
To describe all the channels by which these dynamic effects operate, 
authors distinguish among several macro rebound effects:
a scale effect, a structural change effect, employment and investment effects, 
and further price effects \citep{Colmenares2020,Brockway2021}.
As \citet{VanBenthem2015} notes, 
cheaper energy services facilitate the development and 
deployment of new products (product innovation),
an important driver of rising aggregate demand \citep{Szostack1995}. 
Ultimately, these dynamic rebound effects lead to 
higher incomes and more spending on goods and energy services than otherwise would be the case 
in the absence of the EEU.

\citeauthor{Borenstein:2015aa} has addressed these macro effects from the demand side,
noting that ``income effect rebound will be larger economy-wide than 
would be inferred from evaluating only the direct income gain from 
the end user's transaction'' \citep[p.~11]{Borenstein:2015aa} and 
likening it to the Keynesian macroeconomic multiplier.
However, the dynamic macro rebound mechanism 
is not an autonomous expansion of expenditure in an otherwise unchanged economy 
(like the Keynesian multiplier).
Rather, macroeconomic rebound is caused by an energy productivity improvement.
That said, \citeauthor{Borenstein:2015aa} is right to highlight that supply side 
and demand side effects both play a role in the macroeconomic rebound.
Furthermore, \citeauthor{Borenstein:2015aa}'s approach has the advantage that it can be directly
linked to our income effect and its consequences for macroeconomic rebound. 

To operationalize the macro rebound effect, we scale
the post-substitution-effect net savings~($\rasub{N}$) gained by device owners at the micro level.
As argued by \citet{Antal:2014aa}, 
it is reasonable to assume that net savings ($\rasub{N}$) are spent in the economy at the average 
energy intensity of the economy ($I_E$). 
Scaling from net savings ($\rasub{N}$) at the device level
to productivity-driven growth at the macro level is unexplored territory,
as \citet{Borenstein:2015aa} notes.
In the absence of better information,
we express this scaling simply by a macro factor ($k$)
with $k \ge 0$ expected.
$k = 0$ means there is no macroeconomic productivity boost
resulting from the energy efficiency upgrade.
$k > 0$ means that productivity-driven macroeconomic growth has occurred
with consequent implications for additional energy consumption in the economy.
For now, we choose $k = 1$ as a placeholder value,
with further exploration of its magnitude in Section~\ref{sec:discussion}.

Macro rebound is given by

\begin{equation} \label{eq:Re_macro_def}
  Re_{\macro} = \frac{k \rbinc{N} I_E}{\Sdot} \; .
\end{equation}
%
(See Table~\ref{tab:macroeffect}.) 
Macro effects are shown as segment \bartilde{}
in Fig.~\ref{fig:ExampleEnergyPathGraph}.
After some algebra (Appendix~\ref{sec:Re_macro}), 
we arrive at an expression for macro effect rebound:

\begin{equation} \label{eq:Re_macro}
  Re_{\macro} = \Remacroeqn{} \; .
\end{equation}
%

%++++++++++++++++++++++++++++++
\subsection{Rebound sum}
\label{sec:total_rebound_main_paper}
%++++++++++++++++++++++++++++++

The sum of all rebound emerges from the four rebound effects
(emplacement effect, substitution effect, income effect, and macro effect).
Macro effect rebound~($Re_{\macro}$, Eq.~(\ref{eq:Re_macro}))
is expressed in terms of other rebound effects.
(Derivation details can be found in Appendix~\ref{sec:total_rebound}.)
After algebra and canceling of terms,
we find

\begin{align} \label{eq:Re_tot}  
  Re_{tot} = \; \Retoteqn{} \; .
\end{align}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Two applications of the rebound framework}
\label{sec:examples}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Section 3 refs to add
% Possibly include in section 3 calcs (for own-price elasticities) 
% and/or section 4 discussion
% \citet{Mills2014},
% \citet{Saunders2012},
% \citet{Schleich2014},
% 
% Section 3 ref to add, at place where elasticity estimates 
% for case study examples are given.
% \citet{Gillingham:2020aa},
% 
% Section 3 refs to add (or appendix D)
% Text from Gregor email, need to translate into paper
% Discharging of action item CES utility - is it novel? +++ We decided it's not ---GS+++

%Well, I haven’t seen anyone use CES utility fitted 
%to an actual two sector model. 
%Hart (2018, attached) writes "the same goods are demanded 
%by consumers based on nested CES utility functions” 
%about Broberg (2015, attached), 
%but that’s not clear from the Broberg paper. 

%Moshiri (2017) use the almost idea demand system 
%which derives demand from a cost function - 
%not something I’ve got any background in, 
%as I’ve noted numerous times, 
%so maybe that might have been a better approach. 
%Li (2018) discusses who else uses these almost ideal demand system approaches.

%I think our approach is novel in the sense that we start from a direct utility,
%not cost function, and optimize instead of just postulate elasticities. 
%To me, the main novelty lies in the fact that we can therefore draw 
%the indifference curves rigorously and compute exact, 
%not just approximate changes. 
%I think that’s something to highlight. 
%But I haven’t had a chance to study the Moshiri (2017) appendix B 
%that might give a better picture of whether others can do that or not. 

% \citet{Broberg2015},
% \citet{Hart2018},
% \citet{Li2018},
% \citet{Moshiri2017},

To demonstrate application of the framework
developed in Section~\ref{sec:framework},
we select two case studies:
energy efficiency upgrades for a car and an electric lamp.
We first collect parameter values
for the equations for
eight rebound components:
$Re_{dempl}$ (Eq.~(\ref{eq:Re_dempl0})),
$Re_{emb}$ (Eq.~(\ref{eq:Re_emb})),
$Re_{\md}$ (Eq.~(\ref{eq:Re_md})),
$Re_{dsub}$ (Eqs.~(\ref{eq:Re_dsub_prelim} and~\ref{eq:q_s_solution})),
$Re_{isub}$ (Eq.~(\ref{eq:Re_isub_prelim} and~\ref{eq:C_o_solution})),
$Re_{dinc}$ (Eq.~(\ref{eq:Re_dinc})),
$Re_{iinc}$ (Eq.~(\ref{eq:Re_iinc})), and
$Re_{\macro}$ (Eq.~(\ref{eq:Re_macro})).
The total rebound 
%sum 
($Re_{tot}$)
is given by the sum of the above components,
which can also be checked against Eq.~(\ref{eq:Re_tot}).

As discussed in Section~\ref{sec:macro_effect_main_paper},
the link between microeconomic factors and macro rebound effects 
is a largely unexplored area. 
For now, we assume a placeholder value of $k = 1$ for both case studies.
We return to the matter of quantifying $k$
in the Discussion (Section~\ref{sec:discussion}).
 

%++++++++++++++++++++++++++++++
\subsection{Case 1: Purchase of new car}
\label{sec:car_example}
%++++++++++++++++++++++++++++++

<<CarPrintableNumbers, echo=FALSE>>=
val_to_string <- function(case, val, to_perc = FALSE, scale = 1, digits = 1, format = "f", big.mark = ",") {
  val <- rebound_results %>% 
    dplyr::filter(.data[[ReboundTools::eeu_base_params$case]] == case) %>% 
    magrittr::extract2(val) %>% 
    magrittr::multiply_by(scale)
  if (to_perc) {
    val <- val * 100
  }
  val %>% 
    formatC(digits = digits, format = format, big.mark = big.mark)
}
# Parameters for first table
mpg_worse <- val_to_string(case = "Car", val = ReboundTools::orig_vars$eta_engr_units_orig, digits = 0)
mpg_better <- val_to_string(case = "Car", val = ReboundTools::star_vars$eta_engr_units_star, digits = 0)
C_dot_cap_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$C_dot_cap_orig, digits = 0)
C_dot_cap_star_car_char <- val_to_string(case = "Car", val = ReboundTools::star_vars$C_dot_cap_star, digits = 0)
t_own_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$t_own_orig, digits = 0)
t_own_star_car_char <- val_to_string(case = "Car", val = ReboundTools::star_vars$t_own_star, digits = 0)
t_life_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$t_life_orig, digits = 0)
t_life_star_car_char <- val_to_string(case = "Car", val = ReboundTools::star_vars$t_life_star, digits = 0)
E_emb_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$E_emb_orig, digits = 0)
E_emb_star_car_char <- val_to_string(case = "Car", val = ReboundTools::star_vars$E_emb_star, digits = 0)
C_dot_md_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$C_dot_md_orig, digits = 0)
C_dot_md_star_car_char <- val_to_string(case = "Car", val = ReboundTools::star_vars$C_dot_md_star, digits = 0)

# Parameters for second table
q_dot_s_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$q_dot_s_orig, digits = 0)
M_dot_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$M_dot_orig, digits = 2)
p_E_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::eeu_base_params$p_E_engr_units, digits = 2)
f_Cs_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$f_Cs_orig, digits = 3)
k_car_char <- val_to_string(case = "Car", val = ReboundTools::eeu_base_params$k, digits = 1)

# Parameters for elasticity table
e_qs_ps_UC_car_char <- val_to_string(case = "Car", val = ReboundTools::eeu_base_params$e_qs_ps_UC, digits = 1)
e_qs_ps_C_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$e_qs_ps_C, digits = 3)
e_qo_ps_C_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$e_qo_ps_C, digits = 3)
e_qs_M_car_char <- val_to_string(case = "Car", val = ReboundTools::eeu_base_params$e_qs_M, digits = 1)
e_qo_M_car_char <- val_to_string(case = "Car", val = ReboundTools::eeu_base_params$e_qo_M, digits = 1)

# Parameters for discussion
Re_dempl_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_dempl, to_perc = TRUE, digits = 1)
Re_emb_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_emb, to_perc = TRUE)
Delta_E_dot_emb_star_car_char <- val_to_string(case = "Car", val = ReboundTools::Delta_vars$Delta_E_dot_emb_star, digits = 0)
Re_md_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_md, to_perc = TRUE, digits = 1)
Re_dsub_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_dsub, to_perc = TRUE)
Re_isub_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_isub, to_perc = TRUE)
Delta_C_dot_o_hat_car_char <- val_to_string(case = "Car", val = ReboundTools::Delta_vars$Delta_C_dot_o_hat, digits = 2)
Re_dinc_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_dinc, to_perc = TRUE)
Re_iinc_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_iinc, to_perc = TRUE)
N_dot_hat_car_char <- val_to_string(case = "Car", val = ReboundTools::hat_vars$N_dot_hat, digits = 2)
Re_macro_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_macro, to_perc = TRUE)
@



For the first example, 
we consider the purchase of a more fuel efficient car, 
namely a gasoline-electric Ford Fusion Hybrid car,
to replace a conventional gasoline Ford Fusion car. 
The cars are matched as closely as possible, 
except for the inclusion of an electric battery 
in the hybrid car.  
The car case study features a larger initial capital investment
versus the long-term benefit of decreased direct energy costs 
for the same energy service (mileage/year). 


%------------------------------
\subsubsection{Input parameters} 
\label{sec:Car_input_data}
%------------------------------

We require four sets of data. 
First, the basic car parameters are summarized 
in Table~\ref{tab:car_parameters}.
Second, we require several general parameters, 
mainly relating to the U.S.\ economy and personal finances 
of the average U.S.\ citizen. 
The parameters and the values used in the study 
are given in Table~\ref{tab:car_economic_parameters}.
Third, we require elasticity parameters, 
as given in Table~\ref{tab:car_elasticity_parameters}.
Fourth, armed with the parameter values from 
Tables~\ref{tab:car_parameters}--\ref{tab:car_elasticity_parameters}, 
and the equations of Section~\ref{sec:framework},
we calculate important values at each rebound stage,
as shown below in Table~\ref{tab:car_stages_table}.
Note that Table~\ref{tab:car_stages_table} applies to the car owner.
Across the macro effect (segment \bartilde{} in Fig.~\ref{fig:CarEnergyGraph}), 
changes occur only in the macroeconomy.
For the car owner, no changes are observed across the macro effect.
Thus, the $-$ and $\sim$ columns of Table~\ref{tab:car_stages_table} are identical.

% Reduce spacing between table rows henceforth.
\renewcommand{\arraystretch}{0.6}

\begin{landscape}
\begin{table}
\begin{center}
\caption{Car example: Vehicle parameters.} 
\label{tab:car_parameters}
\begin{tabular}{ r c c l }
  \toprule
    Description                  & Ford Fusion & Ford Fusion & Data sources and notes\\ 
    Parameters [units]                              & (gasoline) & (hybrid EV) &  \\
  \midrule
  Fuel economy                           & \Sexpr{mpg_worse} & \Sexpr{mpg_better} & Combined cycle mpg value taken from \citet{Car_Connection:2020}, \\
  $\bempl{\eta}$, $\amacro{\eta}$ [mpg]             &           &          & Turbo Premium Unleaded for Titanium FWD model with Intercooled  \\
                                                    &           &          & I-4, 2.0 L engine. \\
                                                    &           &          & Combined cycle mpg value taken from \citet{Car_Connection:2020},\\
                                                    &           &          & for Titanium FWD model with Gas/Electric I-4, 2.0 L engine. \\
  \midrule
   Capital expenditure rate      & \Sexpr{C_dot_cap_orig_car_char}     & \Sexpr{C_dot_cap_star_car_char}    & Seven year annual, averaged capital costs = purchase + finance costs.  \\
                                                    &           &          & Ford Fusion Hybrid car includes a \$4,000 tax rebate correct at the time of writing, \\
                                                    &           &          & which makes the purchase cost cheaper than the conventional Ford Fusion car. \\
   $\rbempl{C}_{cap}$, $\raempl{C}_{cap}$ [\$/year] &           &          & -- resale value (purchase -- depreciation). Ford Fusion gasoline costs from \\
                                                    &           &          & \citet{Edmunds:2019_gasoline_fusion}. Ford Fusion Hybrid car costs from \citet{Edmunds:2019_energi_fusion}. \\
 \midrule
   Ownership duration            & \Sexpr{t_own_orig_car_char}  & \Sexpr{t_own_star_car_char}  & U.S.\ car ownership (from new) length taken from \citet{BusinessWire:2015}, \\
   $\bempl{t}_{own}$, $\aempl{t}_{own}$ [years]     &           &          & and has risen from 52 months (2005) to 79 months (2015), so assumed as \\
                                                    &           &          & 84 months in 2019 (7 years) for our example. \\
 \midrule
   Lifespan                     & \Sexpr{t_life_orig_car_char}  & \Sexpr{t_life_star_car_char} & Lifetime taken as 14 years, based on 13--17 years for U.S.\ cars \\
   $\bempl{t}_{\life}$, $\aempl{t}_{\life}$ [years] &           &          & from \citet{Berla:2016} and 14 years for UK cars from \\
                                                    &           &          & \citet{SMMT:2020}. \\
 \midrule
   Embodied energy             & \Sexpr{E_emb_orig_car_char}    & \Sexpr{E_emb_star_car_char}   & 34,000 MJ for conventional Ford Fusion gasoline car taken from \\
   $\bempl{E}_{emb}$, $\aempl{E}_{emb}$ [MJ]        &           &          & \citet{Argonne_National_Laboratory:2010}. \\
                                                    &           &          & We assume an additional 6,000 MJ added for Ford Fusion Hybrid Electric Vehicle (HEV) \\
                                                    &           &          & battery, as HEV typically adds 10--25\% to total LCA energy of vehicle  \\
                                                    &           &          & manufacture \citet{onat2015conventional}. \\
                                                    &           &          & Battery lifetime assumed same as car lifetime, based on \\
                                                    &           &          & \citet{nordelof2014environmental}, and \citet{onat2015conventional}. \\
 \midrule
  Maintenance and disposal expenditure rate  & \Sexpr{C_dot_md_orig_car_char}  & \Sexpr{C_dot_md_star_car_char}    & Seven year annual, averaged maintenance costs = sum of insurance, \\
  $\rbempl{C}_{\md}$, $\raempl{C}_{\md}$ [\$/year]  &           &          & maintenance, repairs, taxes, and fees (excluding financing, depreciation, fuel). \\
                                                    &           &          & Ford Fusion maintenance costs from \citet{Edmunds:2019_gasoline_fusion}. \\
                                                    &           &          & Ford Fusion Hybrid maintenance costs from \citet{Edmunds:2019_energi_fusion}. \\
  \bottomrule
\end{tabular}
\end{center}
\end{table}
\end{landscape}





\begin{landscape}
\begin{table}
\begin{center}
\caption{Car example: Economic parameters.}
\label{tab:car_economic_parameters}
\begin{tabular}{ r c l }
  \toprule
  Description & Value & Data sources and notes \\ 
  Parameter [units] & & \\
  \midrule
  Distance driven prior to upgrade   & \Sexpr{q_dot_s_orig_car_char}        & Average U.S.\ vehicle miles/year, taken from \citet{Car_Insurance:2019}.  \\
  $\rbempl{q}_s$ [miles/year]                               &               & This is slightly higher than the average driver miles/year (13,476) from \\
                                                            &               & \citet{US_DoT:2018}. \\
  \midrule
  Real median personal income U.S., in 2018                 & 34,317        & Taken from \citet{St_Louis_Fed:2019}.\\
  {} [\$/year]                                              &               & \\
  \midrule
  U.S.\ disposable income /                                 & 0.88268       & Taken from U.S.\ Bureau of Economic Analysis (BEA) \\
  real income (minus current taxes)                         &               & National and Products Accounts (NIPA) \\
  {} [--]                                                   &               & Table 2.1. Personal Income and Its Disposition, \\
                                                            &               & \citet{US_BEA:2020}, \\ 
  \midrule
  Share of savings from disposable income                   & 0.079         & Taken from U.S.\ Bureau of Economic Analysis (BEA) \\
  {} [--]                                                   &               & National and Products Accounts (NIPA) \\ 
                                                            &               & Table 2.1. Personal Income and Its Disposition, \\
                                                            &               & \citet{US_BEA:2020}, \\
  \midrule
  Personal consumption                   & \Sexpr{M_dot_orig_car_char}      & Calculation: $(\$34,317\mathrm{/year}) (0.88268) (1 - 0.079)$ \\
  $\rate{M}$ [\$/year]                                      &               &                                              \\
  \midrule
  Price of gasoline                       & \Sexpr{p_E_orig_car_char}       & Taken from U.S.\ Energy Information Agency (EIA) data \\
  $p_E$ [\$/gallon]                                         &               & \citet{US_EIA:2020_gasoline} \\
  \midrule  
  Fractional spend on energy service      & \Sexpr{f_Cs_orig_car_char}      & Calculation: \$1,275 (spend on energy service) \\
  $\fCs$ [--]                                               &               & / [\$19,234 (other goods) + \$1,275 (energy service)] = 0.062, \\
                                                            &               & where spend on energy service = 14,425 miles / 42 mpg \\
                                                            &               & $\times$ \$2.21/gallon = \$1,275. \\
  \midrule
  Macro factor                                              & \Sexpr{k_car_char}           & Assumed value. \\  
  $k$ [--]                                                  &               &               \\
  \bottomrule
\end{tabular}
\end{center}
\end{table}
\end{landscape}





\begin{landscape}
\begin{table}
\begin{center}
\caption{Car example: Elasticity parameters.}
\label{tab:car_elasticity_parameters}
\begin{tabular}{ r c l }
  \toprule
  Description & Value & Data sources and notes \\
  Parameter [units] & & \\
  \midrule
  Price elasticity of car use demand  & $\Sexpr{e_qs_ps_UC_car_char}$  & We adopt $-0.2$ as our baseline value, based on U.S.\ studies including \\
  $\eqspsUC$ [--]                                           &           &  \citet{Gillingham:2020aa}, who estimated a value of $-0.1$, \\
                                                           &           &   \citet{goetzke2018}, who estimated values between $-0.05$ and $-0.23$, \\  
                                                             &           &   and \citet{Parry2005}, who estimated values between $-0.1$ and $-0.3$. \\  
                                                            &           &  For comparison, \citet{Borenstein:2015aa} uses values of $-0.1$ to $-0.4$, \\   
                                                            &            &     based on \citet{Parry2005}. \\
  \midrule
  Compensated price elasticity of car use demand                   &   $\Sexpr{e_qs_ps_C_car_char}$   & Calculated via the Slutsky Equation (Eq.~(\ref{eq:slutsky})).  \\
  $\eqspsC$ [--]                                           &                                &   \\    
  \midrule   
  Compensated cross-price elasticity of demand for other goods        &   \Sexpr{e_qo_ps_C_car_char}     & Calculated via Eq.~(\ref{eq:eqops}).  \\
  $\eqopsC$ [--]                                           &                                &   \\ 
  \midrule   
  Income elasticity of demand for car use                 &   \Sexpr{e_qs_M_car_char}      & Follows from CES utility function. \\
  $\eqsM$ [--]                                            &                                &   \\ 
  \midrule   
  Income elasticity of demand for other goods             &   \Sexpr{e_qo_M_car_char}      & Follows from CES utility function. \\
  $\eqoM$ [--]                                            &                                &   \\
  \bottomrule
\end{tabular}
\end{center}
\end{table}
\end{landscape}




<<car_stages_table, results="asis", echo=FALSE>>=
digs_car <- matrix(c(rep(1, 7), # eta_engr_units
                     rep(3, 7), # eta
                     rep(3, 7), # p_s
                     rep(0, 7), # q_dot_s
                     rep(0, 7), # E_dot_s
                     rep(0, 7), # E_dot_emb
                     rep(0, 7), # C_dot_s
                     rep(0, 7), # C_dot_cap
                     rep(0, 7), # C_dot_md
                     rep(0, 7), # C_dot_o
                     rep(0, 7), # N_dot
                     rep(0, 7)), # M_dot
                   nrow = 12, ncol = 7, byrow = TRUE)
rebound_results %>% 
  dplyr::filter(Case == "Car") %>% 
  dplyr::mutate(
    Case = NULL
  ) %>% 
  ReboundTools::stages_table(label = "tab:car_stages_table", 
                             caption = "Results for car example with macro factor ($k$) assumed to be 1.", 
                             digits = digs_car, 
                             align = "lrrrrrr") %>% 
  print(include.rownames = FALSE, 
        booktabs = TRUE,
        caption.placement = "top",
        sanitize.text.function = function(x) {x},
        format.args = list(big.mark = ","),
        math.style.negative = TRUE)
@

  
%------------------------------
\subsubsection{Results} 
\label{sec:Car_results}
%------------------------------

Results are represented graphically in quantified energy, cost, and consumption path graphs
in Figs.~\ref{fig:CarEnergyGraph}--\ref{fig:CarConsGraph}.
The energy path graph (Fig.~\ref{fig:CarEnergyGraph})
shows the size of each rebound effect
for the car example.


<<CarGraphReResults, include=FALSE>>=
Re_empl_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_empl, to_perc = TRUE)
Re_sub_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_sub, to_perc = TRUE)
Re_inc_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_inc, to_perc = TRUE)
Re_micro_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_micro, to_perc = TRUE)
Re_macro_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_macro, to_perc = TRUE)
Re_tot_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_tot, to_perc = TRUE)
@

<<CarEnergyGraph, echo=FALSE, fig.cap="Energy path, car example with macro factor ($k$) assumed to be 1.", fig.width=6, fig.height=4>>=
car_Re_label_angle <- -77
car_Re_arrow_angle <- pi/180 * 3.1

car_energy_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size, ~angle,
                                     73500, 77500, 'degree', 
                                       stage_colour, orig_size, 0,
                                     42900, 77350, 'a', 
                                       abcd_colour, abcd_size, 0,
                                     43560, 77900, 'b', 
                                       abcd_colour, abcd_size, 0,
                                     44200, 77350, '"*"', 
                                       stage_colour, star_size, 0,
                                     43100, 77100, 'c',
                                       abcd_colour, abcd_size, 0,
                                     46400, 76980, '"^"', 
                                       stage_colour, hat_size, 0,
                                     48800, 77100, 'd', 
                                       abcd_colour, abcd_size, 0,
                                     49400, 79560, 'bold("_")',
                                       stage_colour, bar_size, 0,
                                     49150, 81960, '"~"', 
                                       stage_colour, tilde_size, 0,
                                     40200, 77700, 'Hyperconservation', 
                                       annotation_colour, 
                                       annotation_size-1,
                                       car_Re_label_angle,
                                     41000, 79000, 'Re[tot] == 0*"%"', 
                                       annotation_colour, 
                                       annotation_size,
                                       car_Re_label_angle,
                                     42400, 79200, paste0("Re[empl] == '", Re_empl_car_char_perc, "%'"),
                                       annotation_colour, 
                                       annotation_size,
                                       car_Re_label_angle,
                                     41900, 80500, 'Re[sub]', 
                                       annotation_colour, 
                                       annotation_size,
                                       car_Re_label_angle + 90,
                                     42180, 80250, paste0("'", Re_sub_car_char_perc, "%'"), 
                                       annotation_colour, 
                                       annotation_size - 1,
                                       car_Re_label_angle + 90,
                                     45200, 80680, 'Re[inc]', 
                                       annotation_colour, 
                                       annotation_size,
                                       car_Re_label_angle + 90,
                                     45500, 80420, paste0("'", Re_inc_car_char_perc, "%'"), 
                                       annotation_colour, 
                                       annotation_size - 1,
                                       car_Re_label_angle + 90,
                                     51220, 78000, 'Re[macro]', 
                                       annotation_colour, 
                                       annotation_size - 2,
                                       car_Re_label_angle + 90,
                                     51500, 77810, paste0("'", Re_macro_car_char_perc, "%'"), 
                                       annotation_colour, 
                                       annotation_size - 1,
                                       car_Re_label_angle + 90,
                                     51700, 79500, paste0("Re[tot] == '", Re_tot_car_char_perc, "%'"),
                                       annotation_colour, 
                                       annotation_size,
                                       car_Re_label_angle,
                                     71100, 80000, 'Re[tot] == 100*"%"', 
                                       annotation_colour, 
                                       annotation_size,
                                       car_Re_label_angle,
                                     72100, 81300, 'Backfire', 
                                       annotation_colour, 
                                       annotation_size-1,
                                       car_Re_label_angle)

car_Re_arrows <- tibble::tribble(~x, ~y, ~angle, ~radius, ~colour, ~size,
                                 40330, 80600, car_Re_arrow_angle, 2800, annotation_colour, 0.5,
                                 43200, 80760, car_Re_arrow_angle, 3750, annotation_colour, 0.5,
                                 49940, 78040, car_Re_arrow_angle, 2250, annotation_colour, 0.5)

rebound_results %>% 
  ReboundTools::path_graphs(cases = "Car", 
                            graph_types = "Energy") +
  ggplot2::geom_spoke(data = car_Re_arrows, 
                        mapping = ggplot2::aes(x = x,
                                               y = y,
                                               angle = angle, 
                                               radius = radius, 
                                               colour = colour), 
                        arrow = ggplot2::arrow(length = ggplot2::unit(0.1,"cm"))) +
  ggplot2::geom_text(data = car_energy_labels, 
                     mapping = ggplot2::aes(x = x, 
                                            y = y, 
                                            label = lab, 
                                            colour = colour, 
                                            size = size,
                                            angle = angle), 
                     parse = TRUE) +
  MKHthemes::xy_theme()
@


<<CarCostGraph, echo=FALSE, fig.cap="Expenditure path, car example.", fig.width=6, fig.height=4>>=
car_cost_line_angle <- -29.5
car_cost_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size, ~angle,
                                   1280, 26150, 'degree', 
                                   stage_colour, orig_size, 0,
                                   759, 26150, 'a', 
                                   abcd_colour, abcd_size, 0,
                                   770, 26025, 'b', 
                                   abcd_colour, abcd_size, 0,
                                   770, 25937, '"*"', 
                                   stage_colour, star_size, 0,
                                   750, 25867, 'c', 
                                   abcd_colour, abcd_size, 0,
                                   816, 25896, '"^"', 
                                   stage_colour, hat_size, 0,
                                   855, 25870, 'd', 
                                   abcd_colour, abcd_size, 0,
                                   830, 26557, 'bold("_")', 
                                   stage_colour, bar_size, 0,
                                   1075, 26350, 'Original~expenditure', 
                                   annotation_colour, annotation_size, car_cost_line_angle,
                                   950, 25958, 'After~expected~savings', 
                                   annotation_colour, annotation_size, car_cost_line_angle,
                                   710, 26010, 'After~empl.', 
                                   annotation_colour, annotation_size-1, car_cost_line_angle,
                                   710, 25950, 'After~CV', 
                                   annotation_colour, annotation_size-1, car_cost_line_angle)

rebound_results %>% 
  ReboundTools::path_graphs(cases = "Car", 
                            graph_types = "Expenditure") + 
  ggplot2::geom_text(data = car_cost_labels, 
                     mapping = ggplot2::aes(x = x, 
                                            y = y, 
                                            label = lab, 
                                            colour = colour, 
                                            size = size,
                                            angle = angle), 
                     parse = TRUE) +
  ggplot2::scale_x_continuous(limits = c(680, NA)) +
  MKHthemes::xy_theme()
@


<<CarConsGraph, echo=FALSE, warning=FALSE, fig.cap="Consumption path, car example.", fig.width=6, fig.height=4>>=
car_prefs_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size,
                                    1.005, 1.0016, 'degree', 
                                      stage_colour, orig_size, 
                                    1.012, 1.0002, '","', 
                                      annotation_colour, orig_size-3,
                                    1.02, 1.0004, '"*"', 
                                      annotation_colour, star_size,
                                    1.071, 0.998, '"^"',  
                                      stage_colour, hat_size, 
                                    1.108, 1.0336, 'bold("_")',  
                                      stage_colour, bar_size, 
                                    0.9, 1.0076, 'degree', 
                                      line_label_colour, orig_line_label_size, 
                                    1.165, 0.99, 'degree', 
                                      line_label_colour, orig_line_label_size, 
                                    0.9, 1.004, '"*"', 
                                      line_label_colour, star_line_label_size, 
                                    1.258, 0.99, '"*"', 
                                      line_label_colour, star_line_label_size, 
                                    0.995, 0.9958, 'c',
                                      abcd_colour, abcd_size,
                                    0.9, 1.0017, '"^"', 
                                      line_label_colour, hat_line_label_size, 
                                    1.195, 0.99, '"^"', 
                                      line_label_colour, hat_line_label_size, 
                                    1.12, 0.9965, 'd', 
                                      abcd_colour, abcd_size,
                                    0.9, 1.04, '"_"', 
                                      line_label_colour, bar_line_label_size, 
                                    1.3, 1.024, '"_"', 
                                      line_label_colour, bar_line_label_size, 
                                    1.128, 1.04, 'r', 
                                      line_label_colour, r_line_label_size,
                                    1.075, 0.99, 'r', 
                                      line_label_colour, r_line_label_size,
                                    0.91, 1.0106, 'i*degree', 
                                      line_label_colour, i_line_label_size,
                                    1.27, 0.9933, 'i*degree', 
                                      line_label_colour, i_line_label_size,
                                    1.01, 1.0397, 'bar(i)', 
                                      line_label_colour, i_line_label_size,
                                    1.29, 1.0295, 'bar(i)', 
                                      line_label_colour, i_line_label_size,
                                    )

rebound_results %>% 
  ReboundTools::path_graphs(cases = "Car", 
                            graph_types = "Consumption") + 
  ggplot2::geom_text(data = car_prefs_labels, 
                     mapping = ggplot2::aes(x = x, 
                                            y = y, 
                                            label = lab, 
                                            colour = colour, 
                                            size = size), 
                     parse = TRUE) +
  ggplot2::xlim(0.9, 1.3) + 
  ggplot2::ylim(0.99, 1.04) +
  MKHthemes::xy_theme()
@


The base results for the car upgrade are shown in Table~\ref{tab:car_results}.

<<car_rebound_results_table, results="asis", echo=FALSE>>=
rebound_results %>% 
  dplyr::filter(Case == "Car") %>% 
  dplyr::mutate(
    Case = NULL
  ) %>% 
  ReboundTools::rebound_results_table(include_subtotals = FALSE, 
                                      rebound_terms = ReboundTools::rebound_terms[!names(ReboundTools::rebound_terms) %in% "Re_cap"],
                                      label = "tab:car_results", 
                                      caption = "Car example: rebound results with macro factor ($k$) assumed to be 1.", 
                                      digits = 1, 
                                      align = "rrr") %>% 
  print(include.rownames = FALSE, 
        booktabs = TRUE,
        caption.placement = "top",
        hline.after = c(-1, 0, nrow(.)-1, nrow(.)),
        sanitize.text.function = function(x) {x},
        format.args = list(big.mark = ","), 
        math.style.negative = TRUE)
@


The \empleffect{} has three components:
the direct emplacement effect, 
the embodied energy effect, and 
the maintenance and disposal effect.
Rebound from the direct emplacement effect 
($Re_{dempl}$) is \Sexpr{Re_dempl_car_char_perc}\% always, 
because energy takeback (and, therefore, rebound)
occurs after the EEU is emplaced.
Indirect rebound due to the embodied energy effect
($Re_{emb}$) is \Sexpr{Re_emb_car_char_perc}\%,  
due to the higher embodied energy rate
($\Delta \raempl{E}_{emb} = \Sexpr{Delta_E_dot_emb_star_car_char}$~MJ/year)
stemming from the electric battery in the hybrid EV car.
Rebound due to the maintenance and disposal effect
($Re_{\md}$) is small and negative
($\Sexpr{Re_md_car_char_perc}$\%),
because of the slightly lower maintenance and disposal costs
for the hybrid EV car.

The \subeffect{} has two components:
direct and indirect substitution effect rebound.
Rebound from direct substitution ($Re_{dsub}$) is 
positive, as expected (\Sexpr{Re_dsub_car_char_perc}\%). 
The car owner will, on average, prefer more driving, 
because of fuel economy enhancements (\Sexpr{mpg_better}~mpg $>$ \Sexpr{mpg_worse}~mpg).
In other words, with no other changes, 
the more fuel efficient car increases driving by \Sexpr{Re_dsub_car_char_perc}\%. 
Conversely, the indirect substitution effect ($Re_{isub}$)
is slightly negative ($\Sexpr{Re_isub_car_char_perc}$\%)
to achieve the same level of utility after increased driving. 
Indeed, less money is spent on other goods
($\Delta \rasub{C}_o = \Sexpr{Delta_C_dot_o_hat_car_char}$~\$/year).

The \inceffect{} also has two components:
direct and indirect income effect rebound.
The car owner obtains freed cash 
due to a net monetary savings from the emplacement and substitution effects. 
The direct income effect
($Re_{dinc}$) is positive
(\Sexpr{Re_dinc_car_char_perc}\%), 
because the car owner allocates some
freed cash to additional driving. 
Rebound from the indirect income effect 
($Re_{iinc}$) is positive (\Sexpr{Re_iinc_car_char_perc}\%)
due to higher spending on other goods. 
Thus, the freed cash after the substitution effect
($\rasub{N} = \Sexpr{N_dot_hat_car_char}$~\$/year) 
translates into positive direct and indirect income
rebound at the micro level. 
Total micro rebound (emplacement, substitution, and income effects)
sums to $Re_{micro} = \Sexpr{Re_micro_car_char_perc}$\%.

Finally, 
%at the macro level, 
the \macroeffect{} leads to macro rebound
($Re_{\macro}$) of \Sexpr{Re_macro_car_char_perc}\%
with $k$ assumed to be 1,
due to economic expansion caused by 
productivity enhancements arising from the more-efficient provision of the 
energy service (transportation).


%++++++++++++++++++++++++++++++
\subsection{Case 2: Purchase of new electric lamp}
\label{sec:lamp_example}
%++++++++++++++++++++++++++++++

<<LampPrintableNumbers, echo=FALSE>>=
# First table
efficacy_worse <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$eta_engr_units_orig, scale = 0.001, digits = 2) # lm-hr/W-hr
efficacy_better <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$eta_engr_units_star, scale = 0.001, digits = 1) # lm-hr/W-hr
C_dot_cap_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$C_dot_cap_orig, digits = 3)
C_dot_cap_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$C_dot_cap_star, digits = 3)
t_own_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$t_own_orig, digits = 1)
t_own_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$t_own_star, digits = 0)
t_life_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$t_life_orig, digits = 1)
t_life_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$t_life_star, digits = 0)
E_emb_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$E_emb_orig, digits = 2)
E_emb_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$E_emb_star, digits = 2)
C_dot_md_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$C_dot_md_orig, digits = 2)
C_dot_md_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$C_dot_md_star, digits = 2)

# Second table
q_dot_s_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$q_dot_s_orig, digits = 0)
M_dot_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$M_dot_orig, digits = 2)
p_E_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::eeu_base_params$p_E_engr_units, digits = 4)
f_Cs_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$f_Cs_orig, digits = 7)
k_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::eeu_base_params$k, digits = 1)

# Third table
e_qs_ps_UC_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::eeu_base_params$e_qs_ps_UC, digits = 1)
e_qs_ps_lamp_C_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$e_qs_ps_C, digits = 4)
e_qo_ps_lamp_C_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$e_qo_ps_C, digits = 5)
e_qs_M_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::eeu_base_params$e_qs_M, digits = 1)
e_qo_M_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::eeu_base_params$e_qo_M, digits = 1)

# Results discussion
Re_dempl_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_dempl, to_perc = TRUE, digits = 1)
Re_emb_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_emb, to_perc = TRUE)
Delta_E_dot_emb_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::Delta_vars$Delta_E_dot_emb_star, digits = 2)
E_emb_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$E_emb_orig, digits = 2)
E_emb_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$E_emb_star, digits = 2)
E_dot_emb_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$E_dot_emb_orig, digits = 2)
E_dot_emb_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$E_dot_emb_star, digits = 2)
Re_emb_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_emb, to_perc = TRUE)
Re_md_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_md, to_perc = TRUE)
Re_dsub_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_dsub, to_perc = TRUE)
eta_better <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$eta_engr_units_star, scale = 0.001, digits = 1) # In lm/W
eta_worse <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$eta_engr_units_orig, scale = 0.001, digits = 2) # In lm/W
q_dot_s_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$q_dot_s_star, digits = 0) # In lm-hr/year
q_dot_s_hat_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::hat_vars$q_dot_s_hat, digits = 0) # In lm-hr/year
Re_isub_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_isub, to_perc = TRUE)
Delta_C_dot_o_hat_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::Delta_vars$Delta_C_dot_o_hat, digits = 2)
Re_dinc_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_dinc, to_perc = TRUE, digits = 2)
Re_iinc_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_iinc, to_perc = TRUE)
N_dot_hat_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::hat_vars$N_dot_hat, digits = 2)
Delta_C_dot_o_bar_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::Delta_vars$Delta_C_dot_o_bar, digits = 2)
Re_macro_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_macro, to_perc = TRUE)
@


For our second example, 
we consider purchasing a light emitting diode (LED) electric lamp
to replace a baseline incandescent electric lamp. 
Both lamps are matched as closely as possible 
in terms of energy service delivery (measured in lumen output per lamp), 
the key difference being the energy required to provide that energy service. 
The LED lamp has a low 
initial capital investment rate
(negative versus the incumbent incandescent lamp, actually!)
and a long-term benefit of decreased direct energy expenditures
for the same annual energy service (lm-hr/year).


%------------------------------
\subsubsection{Input parameters} 
\label{sec:lamp_input_data}
%------------------------------

Again, we require four sets of data. 
First, the basic lamp parameters are summarized in Table~\ref{tab:lamp_parameters}. 
Second, we require several general parameters, 
mainly relating to the U.S.\ economy and 
personal finances of the average U.S.\ citizen. 
The parameters and the values used in the study 
are given below in Table~\ref{tab:lamp_economic_parameters}.
Third, we require the elasticity parameters, 
as shown in Table~\ref{tab:lamp_elasticity_parameters}.
Fourth, with the parameter values from 
Tables~\ref{tab:lamp_parameters}--\ref{tab:lamp_elasticity_parameters} 
and the equations of Section~\ref{sec:framework} in hand,
we calculate important values at each rebound stage,
as shown below in Table~\ref{tab:lamp_stages_table}.
Similar to Table~\ref{tab:car_stages_table}, 
Table~\ref{tab:lamp_stages_table} applies to the lamp owner.
For the lamp owner, no changes are observed across the macro effect.
Thus, the $-$ and $\sim$ columns of Table~\ref{tab:lamp_stages_table} are identical.


\begin{landscape}
\begin{table}
\begin{center}
\caption{Lamp example: Electric lamp parameters.} 
\label{tab:lamp_parameters}
\begin{tabular}{ r c c l }
  \toprule
    Description                  & Incandescent lamp & LED lamp & Data sources and notes\\ 
    Parameters [units]                                &  &  & \\
  \midrule
  Lamp efficacy                   & \Sexpr{efficacy_worse}      & \Sexpr{efficacy_better}     & Incandescent: 530 lm output / 60 W energy input. \\
  $\bempl{\eta}$, $\amacro{\eta}$ [lm-hr/W-hr]       &           &          & LED: 450 lm output / 5.5 W energy input. \\
  \midrule
   Capital expenditure rate       & \Sexpr{C_dot_cap_orig_lamp_char}   & \Sexpr{C_dot_cap_star_lamp_char}    & Purchase costs: \$1.88 for incandescent lamp from  \\
   $\rbempl{C}_{cap}$, $\raempl{C}_{cap}$ [\$/year] &           &          & \citet{Home_Depot:2020_Inc_bulb}, \\
                                                    &           &          & and \$1.21 for LED lamp from \\
                                                    &           &          & \citet{Home_Depot:2020_LED_bulb}. \\
  \midrule
   Ownership duration      & \Sexpr{t_own_orig_lamp_char}       & \Sexpr{t_own_star_lamp_char}       & Assumed same as lamp lifespan \\
   $\bempl{t}_{own}$, $\aempl{t}_{own}$ [years]     &           &          &  \\
 \midrule
   Lifespan               & \Sexpr{t_life_orig_lamp_char}       & \Sexpr{t_life_star_lamp_char}       & Based on assumed 3 hours/day  \\
   $\bempl{t}_{\life}$, $\aempl{t}_{\life}$ [years] &           &          & from \citet{Home_Depot:2020_Inc_bulb} \\
                                                    &           &          & and  \citet{Home_Depot:2020_LED_bulb}. \\
   \midrule
   Life cycle analysis (LCA) embodied energy  & \Sexpr{E_emb_orig_lamp_char}      & \Sexpr{E_emb_star_lamp_char}     & Base document: Table 4.5 Manufacturing Energy  \\
   $\bempl{E}_{emb}$, $\aempl{E}_{emb}$ [MJ]        &           &          & Primary energy (MJ/20 Million lumen hours), \\
                                                    &           &          & U.S.\ DoE Life-cycle assessment of energy and environmental \\
                                                    &           &          & impacts of LED lighting products \\
                                                    &           &          & \citep{US_DoE:2012}. \\
                                                    &           &          & Incandescent: \\
                                                    &           &          & LCA energy = 42.2 MJ/20 million lumen-hours.  \\
                                                    &           &          & Lifetime output = 530 lumens $\times$ 3 hours/day \\
                                                    &           &          & $\times$ 365 days/year $\times$ 1.8 years = 1,044,630 lumen-hrs.\\
                                                    &           &          & Thus LCA energy / lamp =  42.2 $\times$ 1.0446/20 = 2.21 MJ. \\
                                                    &           &          & LED:  \\
                                                    &           &          & LCA energy = 132 MJ/20 Million lumen-hours for pack of 5 LED lamps. \\
                                                    &           &          & Lifetime output = 450 lumens $\times$ 3 hours/day  \\
                                                    &           &          & $\times$ 365 days/year $\times$ 10 years = 4,926,405 lumen-hrs. \\
                                                    &           &          & Thus LCA energy / lamp =  132 MJ/5 $\times$ 4.9264/20 = 6.5 MJ. \\ 
 \midrule
  Maintenance and disposal expenditure rate  & \Sexpr{C_dot_md_orig_lamp_char}      & \Sexpr{C_dot_md_star_lamp_char}     & Assumed negligible. \\
  $\rbempl{C}_{\md}$, $\raempl{C}_{\md}$ [\$/year]  &           &          & \\
  \bottomrule
\end{tabular}
\end{center}
\end{table}
\end{landscape}






\begin{landscape}
\begin{table}
\begin{center}
\caption{Lamp example: Economic parameters.}
\label{tab:lamp_economic_parameters}
\begin{tabular}{ r c l }
  \toprule
  Description  & Value & Data sources and notes \\ 
  Parameter [units] & & \\
  \midrule
  Lighting consumption prior to upgrade   & \Sexpr{q_dot_s_orig_lamp_char}  & Calculation: (530 lm) (3 hrs/day) (365 days/year). \\
  $\rbempl{q}_s$ [lm-hr/year]                               &               & \\
  \midrule
  Real median personal income U.S.\, in 2018                & 34,317        & Refer to Table~\ref{tab:car_economic_parameters}.\\
  {} [\$/year]                                              &               & \\
  \midrule
  U.S.\ disposable income /                                 & 0.88268       & Refer to Table~\ref{tab:car_economic_parameters}. \\
  real income (minus current taxes)                         &               &  \\
  {} [--]                                                   &               &  \\
  \midrule
  Share of savings from disposable income                   & 0.079         & Refer to Table~\ref{tab:car_economic_parameters}. \\
  {} [--]                                                   &               &  \\ 
  \midrule
  Personal consumption                   & \Sexpr{M_dot_orig_lamp_char}     & Calculation: $(\$34,317\mathrm{/year}) (0.88268) (1 - 0.079)$. \\
  $\rate{M}$ [\$/year]                                      &               &                                              \\
  \midrule
  Price of electricity                  & \Sexpr{p_E_orig_lamp_char}        & U.S.\ 2020 average household electricity price \\
  $p_E$ [\$/kW-hr]                                          &               & \citep{US_EIA:2020_electricity}.  \\
  \midrule
  Fractional spend on energy service    & \Sexpr{f_Cs_orig_lamp_char}       & Calculation: \$9/year (spend on energy service) / \\
  $\fCs$ [--]                                               &               & [\$27,391/year (other goods) + \$9/year (energy service)] = 0.00032, \\
                                                            &               & where spend on energy service = 580,350 lm-hrs/year /  \\
                                                            &               & 81.8 lm/W / 1000 W/kW $\times$ \$0.1355/kW-hr = \$9/year.  \\
  \midrule
  Macro factor                                              & \Sexpr{k_lamp_char}           & Assumed value. \\  
  $k$ [--]                                                  &               &               \\
  \bottomrule
\end{tabular}
\end{center}
\end{table}
\end{landscape}




\begin{landscape}
\begin{table}
\begin{center}
\caption{Lamp example: Elasticity parameters.}
\label{tab:lamp_elasticity_parameters}
\begin{tabular}{ r c l }
  \toprule
  Description & Value & Data sources and notes \\
  Parameter [units] & & \\
  \midrule
  Price elasticity of lighting demand  &   $\Sexpr{e_qs_ps_UC_lamp_char}$  & We adopt $-0.4$ as our baseline value, as the average of last 50 years \\
  $\eqspsUC$ [--]                                                             &           &   from \citep[Fig.~4]{Fouquet2014} \\  
                                                            &           &  For comparison, \citet{Borenstein:2015aa} uses a range of $-0.4$ to $-0.8$, \\   
                                                            &            &     based on \citet{Fouquet2011}. \\
  \midrule
  Compensated price elasticity of lighting demand                 &  $\Sexpr{e_qs_ps_lamp_C_char}$      & Calculated via the Slutsky Equation (Eq.~(\ref{eq:slutsky})).  \\
  $\eqspsC$ [--]                                           &           &   \\    
  \midrule   
  Compensated cross-price elasticity of demand for other goods        &   \Sexpr{e_qo_ps_lamp_C_char}     & Calculated via Eq.~(\ref{eq:eqops}).  \\
  $\eqopsC$ [--]                                           &           &   \\ 
  \midrule   
  Income elasticity of lighting demand                &   \Sexpr{e_qs_M_lamp_char}     & Follows from CES utility function. \\
  $\eqsM$ [--]                                            &           &   \\ 
  \midrule   
  Income elasticity of demand for other goods             &   \Sexpr{e_qo_M_lamp_char}     & Follows from CES utility function. \\
  $\eqoM$ [--]                                            &           &   \\
  \bottomrule
\end{tabular}
\end{center}
\end{table}
\end{landscape}




<<lamp_stages_table, results="asis", echo=FALSE>>=
digs_lamp <- matrix(c(rep(0, 7), # eta_engr_units
                      rep(0, 7), # eta
                      rep(8, 7), # p_s
                      rep(0, 7), # q_dot_s
                      rep(1, 7), # E_dot_s
                      rep(3, 7), # E_dot_emb
                      rep(2, 7), # C_dot_s
                      rep(2, 7), # C_dot_cap
                      rep(2, 7), # C_dot_md
                      rep(0, 7), # C_dot_o
                      rep(2, 7), # N_dot
                      rep(0, 7)), # M_dot
                    nrow = 12, ncol = 7, byrow = TRUE)
rebound_results %>% 
  dplyr::filter(Case == "Lamp") %>% 
  dplyr::mutate(
    Case = NULL
  ) %>% 
  ReboundTools::stages_table(label = "tab:lamp_stages_table", 
                             caption = "Results for lamp example with macro factor ($k$) assumed to be 1.", 
                             digits = digs_lamp, 
                             align = "lrrrrrr") %>% 
  print(include.rownames = FALSE, 
        booktabs = TRUE,
        caption.placement = "top",
        sanitize.text.function = function(x) {x},
        format.args = list(big.mark = ","),
        math.style.negative = TRUE)
@


<<LampGraphReResults, include=FALSE>>=
Re_empl_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_empl, to_perc = TRUE)
Re_sub_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_sub, to_perc = TRUE)
Re_inc_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_inc, to_perc = TRUE)
Re_micro_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_micro, to_perc = TRUE)
Re_macro_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_macro, to_perc = TRUE)
Re_tot_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_tot, to_perc = TRUE)
@

<<LampEnergyGraph, echo = FALSE, warning=FALSE, fig.cap="Energy path, lamp example with macro factor ($k$) assumed to be 1.", fig.width=6, fig.height=4>>=
lamp_Re_label_angle <- -62
lamp_Re_arrow_angle <- pi/180 * 15.5
lamp_energy_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size, ~angle,
                                      240, 92842, 'degree', 
                                        stage_colour, orig_size, 0,
                                      27, 92842, 'a', 
                                        abcd_colour, abcd_size, 0,
                                      14, 92839.5, '"b,"', 
                                        abcd_colour, abcd_size, 0,
                                      20, 92837.5, '"*"', 
                                        stage_colour, star_size, 0,
                                      23, 92823, 'c', 
                                        abcd_colour, abcd_size, 0,
                                      61, 92820, '"^"', 
                                        stage_colour, hat_size, 0,
                                      67, 92825, '"d"', 
                                        abcd_colour, abcd_size, 0,
                                      68, 92865, 'bold("_")',
                                        stage_colour, bar_size, 0,
                                      67, 92904, '"~"', 
                                        stage_colour, tilde_size, 0,
                                      0, 92835, 'Hyperconservation', 
                                        annotation_colour, 
                                        annotation_size - 1,
                                        lamp_Re_label_angle,
                                      16, 92855, 'Re[tot] == 0*"%"', 
                                        annotation_colour, 
                                        annotation_size, 
                                        lamp_Re_label_angle,
                                     -1, 92860, paste0("Re[empl] == '", Re_empl_lamp_char_perc, "%'"),
                                        annotation_colour, 
                                        annotation_size - 1, 
                                        lamp_Re_label_angle,
                                      1, 92874.2, 'Re[sub]', 
                                        annotation_colour, 
                                        annotation_size - 1, 
                                        lamp_Re_label_angle + 90,
                                      6, 92870, paste0("'", Re_sub_lamp_char_perc, "%'"), 
                                        annotation_colour, 
                                        annotation_size - 1, 
                                        lamp_Re_label_angle + 90,
                                      24, 92881, 'Re[inc]', 
                                        annotation_colour, 
                                        annotation_size, 
                                        lamp_Re_label_angle + 90,
                                      29, 92876.5, paste0("'", Re_inc_lamp_char_perc, "%'"), 
                                        annotation_colour, 
                                        annotation_size - 1, 
                                        lamp_Re_label_angle + 90,
                                      90, 92856.5, 'Re[macro]', 
                                        annotation_colour, 
                                        annotation_size, 
                                        lamp_Re_label_angle + 90,
                                      95.5, 92851, paste0("'", Re_macro_lamp_char_perc, "%'"), 
                                        annotation_colour, 
                                        annotation_size, 
                                        lamp_Re_label_angle + 90,
                                      202, 92880, 'Re[tot] == 100*"%"', 
                                        annotation_colour, 
                                        annotation_size, 
                                        lamp_Re_label_angle,
                                      108, 92865, paste0("Re[tot] == '", Re_tot_lamp_char_perc, "%'"),
                                        annotation_colour, 
                                        annotation_size, 
                                        lamp_Re_label_angle,
                                      230, 92890, 'Backfire',
                                        annotation_colour, 
                                        annotation_size, 
                                        lamp_Re_label_angle)

lamp_Re_arrows <- tibble::tribble(~x, ~y, ~angle, ~radius, ~colour, ~size,
                                  -5.4, 92870, lamp_Re_arrow_angle, 
                                    17.2, annotation_colour, example_arrow_size,
                                  11.8, 92874.8, lamp_Re_arrow_angle, 
                                    32, annotation_colour, example_arrow_size,
                                  76.7, 92850, lamp_Re_arrow_angle, 
                                    32, annotation_colour, example_arrow_size)

rebound_results %>% 
  ReboundTools::path_graphs(cases = "Lamp", 
                               graph_types = "Energy") + 
  ggplot2::geom_spoke(data = lamp_Re_arrows, 
                        mapping = ggplot2::aes(x = x,
                                               y = y,
                                               angle = angle, 
                                               radius = radius, 
                                               colour = colour), 
                        arrow = ggplot2::arrow(length = ggplot2::unit(0.1,"cm"))) +
  ggplot2::geom_text(data = lamp_energy_labels, 
                     mapping = ggplot2::aes(x = x, 
                                            y = y, 
                                            label = lab, 
                                            colour = colour, 
                                            size = size,
                                            angle = angle), 
                     parse = TRUE, ) +
  MKHthemes::xy_theme()
@


<<LampCostGraph, echo = FALSE, fig.cap="Expenditure path, lamp example.", fig.width=6, fig.height=4>>=
lamp_cost_line_angle <- -23
lamp_cost_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size, ~angle,
                                    9, 27392.8, 'degree', 
                                    stage_colour, orig_size, 0,
                                    0.9, 27392.8, 'a', 
                                    abcd_colour, abcd_size, 0,
                                    1.18, 27391.7, '"b"', 
                                    abcd_colour, abcd_size, 0,
                                    0.8, 27390.65, '"*"',
                                    stage_colour, star_size, 0,
                                    0.85, 27387, 'c', 
                                    abcd_colour, abcd_size, 0,
                                    2.3, 27386.4, '"^"', 
                                    stage_colour, hat_size, 0,
                                    2.53, 27387.33, 'd', 
                                    abcd_colour, abcd_size, 0,
                                    2.55, 27399.2, 'bold("_")', 
                                    stage_colour, bar_size, 0,
                                    5.25, 27396.4, 'Original~expenditure',
                                    annotation_colour, annotation_size, lamp_cost_line_angle,
                                    3.75, 27388.1, 'After~emplacement',
                                    annotation_colour, annotation_size, lamp_cost_line_angle,
                                    3.1, 27386.68, 'After~CV',
                                    annotation_colour, annotation_size-1, lamp_cost_line_angle,
                                    4.1, 27389.7, 'After~expected~savings',
                                    annotation_colour, annotation_size, lamp_cost_line_angle)

rebound_results %>% 
  ReboundTools::path_graphs(cases = "Lamp", 
                               graph_types = "Expenditure") + 
  ggplot2::geom_text(data = lamp_cost_labels, 
                     mapping = ggplot2::aes(x = x, 
                                            y = y, 
                                            label = lab, 
                                            colour = colour, 
                                            size = size,
                                            angle = angle), 
                     parse = TRUE) +
  
  MKHthemes::xy_theme()
@


<<LampConsGraph, echo=FALSE, warning=FALSE, fig.cap="Consumption path, lamp example.", fig.width=6, fig.height=4>>=
lamp_prefs_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size,
                                     1.05, 1.00002, 'degree', 
                                       stage_colour, orig_size,
                                     1.097, 1.000005, '","', 
                                       stage_colour, orig_size-3,
                                     1.15, 1.000004, '"*"', 
                                       stage_colour, star_size,
                                     0.7, 1.00008, 'degree',
                                       line_label_colour, orig_line_label_size,
                                     1.57, 0.9998, 'degree',
                                       line_label_colour, orig_line_label_size,
                                     0.7, 0.999988, '"*"', 
                                       line_label_colour, star_line_label_size,
                                     3.5, 0.99989, '"*"',
                                       line_label_colour, star_line_label_size,
                                     0.96, 0.99984, 'c', 
                                       abcd_colour, abcd_size,
                                     2.4, 0.999815, '"^"',
                                       stage_colour, hat_size,
                                     0.7, 0.999885, '"^"',
                                       line_label_colour, hat_line_label_size,
                                     3.4, 0.99979, '"^"', 
                                       line_label_colour, hat_line_label_size,
                                     2.48, 0.999857, 'd',
                                       abcd_colour, abcd_size,
                                     2.5, 1.000287, 'bold("_")', 
                                       stage_colour, bar_size,
                                     0.7, 1.00033, '"_"',  
                                       line_label_colour, bar_line_label_size,
                                     3.5, 1.00023, '"_"',  
                                       line_label_colour, bar_line_label_size,
                                     2.46, 0.9998, 'r', 
                                       abcd_colour, r_line_label_size,
                                     2.46, 1.0004, 'r',
                                       abcd_colour, r_line_label_size,
                                     0.75, 1.00016, 'i*degree',
                                       line_label_colour, i_line_label_size,
                                     3.4, 0.99984, 'i*degree',
                                       line_label_colour, i_line_label_size,
                                     1.21, 1.0004, 'bar(i)',
                                       line_label_colour, i_line_label_size,
                                     3.4, 1.00027, 'bar(i)',
                                       line_label_colour, i_line_label_size,
                                     )
rebound_results %>% 
  ReboundTools::path_graphs(cases = "Lamp", 
                               graph_types = "Consumption") + 
    ggplot2::geom_text(data = lamp_prefs_labels, 
                     mapping = ggplot2::aes(x = x, 
                                            y = y, 
                                            label = lab, 
                                            colour = colour, 
                                            size = size), 
                     parse = TRUE) +
  ggplot2::xlim(0.7, 3.5) +
  ggplot2::ylim(0.99979, 1.0004) +
  MKHthemes::xy_theme()
@


%------------------------------
\subsubsection{Results} 
\label{sec:lamp_results}
%------------------------------

Results are represented graphically in energy, cost, and consumption path graphs
in Figs.~\ref{fig:LampEnergyGraph}--\ref{fig:LampConsGraph}.
The energy path graph (Fig.~\ref{fig:LampEnergyGraph})
shows the size of each rebound effect
for the lamp example.

The base results for the lamp upgrade are shown in Table~\ref{tab:lamp_results}.

<<lamp_rebound_results_table, results="asis", echo=FALSE>>=
rebound_results %>% 
  dplyr::filter(Case == "Lamp") %>% 
  dplyr::mutate(
    Case = NULL
  ) %>% 
  ReboundTools::rebound_results_table(include_subtotals = FALSE, 
                                      rebound_terms = ReboundTools::rebound_terms[!names(ReboundTools::rebound_terms) %in% "Re_cap"],
                                      label = "tab:lamp_results", 
                                      caption = "Lamp example: rebound results with macro factor ($k$) assumed to be 1.", 
                                      digits = 1, 
                                      align = "rrr") %>% 
  print(include.rownames = FALSE, 
        booktabs = TRUE,
        caption.placement = "top",
        hline.after = c(-1, 0, nrow(.)-1, nrow(.)),
        sanitize.text.function = function(x) {x},
        format.args = list(big.mark = ","),
        math.style.negative = TRUE)
@


The \empleffect{} rebound components are as follows:
the direct emplacement effect ($Re_{dempl}$) 
is always $\Sexpr{Re_dempl_lamp_char_perc}$\%.
Indirect rebound due to the embodied energy effect
($Re_{emb}$) is $\Sexpr{Re_emb_lamp_char_perc}$\%.
Although the LED lamp has higher embodied energy 
($\aempl{E}_{emb} = \Sexpr{E_emb_star_lamp_char}$~MJ)
than the incandescent lamp 
($\bempl{E}_{emb} = \Sexpr{E_emb_orig_lamp_char}$~MJ),
the LED lamp has a much longer lifetime,
meaning that the LED embodied energy rate 
($\raempl{E}_{emb} = \Sexpr{E_dot_emb_star_lamp_char}$~MJ/year)
is less than the incandescent embodied energy rate
($\rbempl{E}_{emb} = \Sexpr{E_dot_emb_orig_lamp_char}$~MJ/year).
Thus, the change in embodied energy rate ($\Delta \raempl{E}_{emb}$)
is $\Sexpr{Delta_E_dot_emb_star_lamp_char}$~MJ/year, 
and embodied energy rebound is negative
($Re_{emb} = \Sexpr{Re_emb_lamp_char_perc}$\%).
Rebound due to the maintenance and disposal effect
($Re_{\md}$) is \Sexpr{Re_md_lamp_char_perc}\%,
because we assume no difference in maintenance and disposal costs between 
the incandescent lamp and the LED lamp.

Direct \subeffect{} rebound 
($Re_{dsub}$) is \Sexpr{Re_dsub_lamp_char_perc}\%
due to the much higher LED lamp efficacy
($\aempl{\eta} = \Sexpr{eta_better}$~lm/W) 
compared to the incandescent lamp
($\bempl{\eta} = \Sexpr{eta_worse}$~lm/W),
leading to increased consumption of lighting
(from $\rbsub{q}_s = \Sexpr{q_dot_s_star_lamp_char}$~lm-hr/year
to $\rasub{q}_s = \Sexpr{q_dot_s_hat_lamp_char}$~lm-hr/year)
as shown by segment \chat{} in Fig.~\ref{fig:LampConsGraph}.
To maintain constant utility, 
consumption of other goods is reduced
($\Delta \rasub{C}_o = \Sexpr{Delta_C_dot_o_hat_lamp_char}$~\$/year), 
as shown by segment \starc{} in Fig.~\ref{fig:LampConsGraph},
yielding indirect substitution effect rebound
($Re_{isub}$) of $\Sexpr{Re_isub_lamp_char_perc}$\%.

\Inceffect{} rebound arises from respending of net energy cost savings
associated with converting from the incandescent lamp to the LED lamp
($\rbinc{N} = \Sexpr{N_dot_hat_lamp_char}$~\$/year).
Direct income effect rebound 
($Re_{dinc}$) is \Sexpr{Re_dinc_lamp_char_perc}\%),
positive but small, 
as the lamp owner allocates 
some of the additional income to increased consumption of lighting. 
The indirect income effect rebound is large
($Re_{iinc} = \Sexpr{Re_iinc_lamp_char_perc}$\%), 
due to the energy implications of increased spending on other goods.
Total micro rebound (emplacement, substitution, and income effects)
sums to $Re_{micro} = \Sexpr{Re_micro_lamp_char_perc}$\%.

Finally, rebound due to the macroeconomic 
\macroeffect{} 
($Re_{\macro}$) is coincidentally also \Sexpr{Re_macro_lamp_char_perc}\%
with $k$ assumed to be 1,
due to economic expansion caused by 
productivity enhancements arising from the more-efficient provision of the 
energy service (lighting).
%(It is a coincidence that $Re_{\macro}$ has the same value as $Re_{iinc}$to 1 decimal place for the lighting example.)
%+++I commented out the last sentence and inserted 'coincidentally also' in line above, as its shorter and it doesnt need a line by itself.+++PEB 


%++++++++++++++++++++++++++++++
\subsection{Sensitivity analyses}
\label{sec:sensitivity_analyses}
%++++++++++++++++++++++++++++++

Sensitivity analyses show the effect of 
independently varied parameters on total rebound and rebound components.
In the context of this framework,
sensitivity analyses
can show important trends, tendencies, and relationships
between rebound parameters and rebound magnitudes.
Key rebound parameters include 
post-EEU efficiency ($\amacro{\eta}$),
capital cost ($\amacro{C}_{cap}$),
energy price ($p_E$),
price elasticity of energy service demand ($\eqspsUC$), 
and the macro factor ($k$).
Sensitivity analyses must be undertaken carefully,
because rebound parameters are not expected to be 
independent.

In each subsection below, a series of graphs
shows the effects of varying each of these five key rebound parameters
($\amacro{\eta}$, 
$\amacro{C}_{cap}$, 
$p_E$, 
$\eqspsUC$, 
and $k$)
on energy rebound ($Re_{tot}$) and its components
($Re_{emb}$, $Re_{md}$, $Re_{dsub}$, $Re_{isub}$,
$Re_{dinc}$, $Re_{iinc}$, and $Re_{\macro}$).
In the graphs, 
nominal values for the rebound parameters are shown as points, 
and sensitivity trends are shown as lines. 
A limitation of each sensitivity analysis 
is noted at the end of each subsection.


%------------------------------
\subsubsection{Effect of post-EEU efficiency ($\amacro{\eta}$)} 
\label{sec:effect_of_efficiency}
%------------------------------

<<efficiency_ratios, echo=FALSE>>=
car_efficiency_ratio <- (rebound_results %>% dplyr::filter(Case == "Car") %>% dplyr::select("eta_engr_units_star") / rebound_results %>% dplyr::filter(Case == "Car") %>% dplyr::select("eta_engr_units_orig")) %>% 
  unlist() %>% 
  formatC(digits = 3)

lamp_efficacy_ratio <- (rebound_results %>% dplyr::filter(Case == "Lamp") %>% dplyr::select("eta_engr_units_star") / rebound_results %>% dplyr::filter(Case == "Lamp") %>% dplyr::select("eta_engr_units_orig")) %>% 
  unlist() %>% 
  formatC(digits = 3)
@

Fig.~\ref{fig:eta_tilde_takeback_Sdot_sens_graph} shows that
both takeback and expected energy savings ($\Sdot$)
increase with post-EEU efficiency ($\amacro{\eta}$), 
but the relationship is asymptotic.
Each unit increase of fuel economy or lighting efficacy is less effective than
the previous unit increase of fuel economy or lighting efficacy
for saving energy.
At very high levels of fuel economy economy or lighting efficacy, 
a unit increase leads to almost no additional energy savings.
Thus, we can say there are diminishing returns of fuel economy and lighting efficacy,
leading to saturation of energy savings at very high levels of fuel economy and lighting efficacy.
A simple example illustrates.
A $\bempl{\eta} = 25$ mpg car drives $\bempl{q}_s = 100$ miles 
using $\bempl{E}_s = 4$ gallons of gasoline.
A more-efficient car ($\amacro{\eta} = 30$ mpg) is expected to use
$\aempl{E}_s = 3.33$ gallons to drive the same distance,
a savings of $\Sdot = 0.67$ gallons.
Another 5 mpg boost in efficiency (to $\amacro{\eta} = 35$ mpg)
will use $\aempl{E}_s = 2.86$ gal to drive 100 miles, 
a further expected savings of only $\Sdot = 0.47$ gallons.
Each successive 5 mpg boost in fuel economy 
is expected to save less energy than the previous 5 mpg boost in fuel economy

Saturation can be seen mathematically, too.
Taking the limit as $\amacro{\eta} \rightarrow \infty$ 
in Eq.~(\ref{eq:Sdot}) gives $\Sdot = \rbempl{E}_s$, 
not $\infty$. 
Thus, efficiency saturation must occur.
Fig.~\ref{fig:eta_tilde_takeback_Sdot_sens_graph}
shows that the framework correctly replicates the
expected efficiency saturation trends.

Saturation is especially noticeable in the lamp example
compared to the car example,
the difference being that 
the LED lamp is already much more efficient than the incandescent lamp
(\Sexpr{lamp_efficacy_ratio}$\times$),
whereas the hybrid car is only 
\Sexpr{car_efficiency_ratio}$\times$ as efficient as the conventional gasoline car. 
Thus, at $\amacro{\eta} = \Sexpr{efficacy_better}$ lm-hr/W-hr, 
the energy efficient LED
is far closer to efficiency saturation than the hybrid vehicle 
(at $\amacro{\eta} = \Sexpr{mpg_better}$ mpg).
As a result, further increases in the LED lamp's efficiency 
are less effective than further increases in the hybrid car's efficiency.

That said, actual savings is the difference between the expected energy savings line (solid line)
and the take back line (dashed line) in Fig.~\ref{fig:eta_tilde_takeback_Sdot_sens_graph}.
Because the gap between the lines grows, 
higher efficiency yields actual energy savings,
even after accounting for rebound effects.
But the actual savings are always less than expected savings, due to takebacks.

Fig.~\ref{fig:eta_tilde_takeback_Sdot_sens_graph} shows that
expected energy savings ($\Sdot$) increase faster than takeback 
as $\amacro{\eta}$ increases.
Thus, total rebound ($Re_{tot}$, the ratio of 
takeback to expected energy savings in Eq.~\ref{eq:Re_takeback}),
decreases as efficiency grows.
The lamp exhibits a relatively smaller rebound decline with efficiency,
because the lamp example is closer to saturation than the car example.

Fig.~\ref{fig:all_Re_terms_eta_graph} shows the variation of all rebound components
with post-EEU efficiency ($\amacro{\eta}$).
In the Car and Lamp examples, 
direct substitution rebound ($Re_{dsub}$) is the 
rebound component 
most sensitive to changes in post-EEU efficiency ($\amacro{\eta}$),

A limitation of the energy efficiency sensitivity analysis is that 
post-EEU efficiency ($\amacro{\eta}$)
is unlikely to be independent of other factors, 
such as capital cost ($\amacro{C}_{cap}$).

Note that the sensitivity analysis on post-upgrade efficiency 
($\amacro{\eta}$, Fig.~\ref{fig:all_Re_terms_eta_graph})
is the only sensitivity analysis that requires careful explication
of both the numerator and denominator of Eq.~(\ref{eq:Re_takeback}),
as in Fig.~\ref{fig:eta_tilde_takeback_Sdot_sens_graph}, 
because both the numerator and denominator of Eq.~\ref{eq:Re_takeback}
changes when post-upgrade efficiency ($\amacro{\eta}$) changes.
The denominator of Eq.~(\ref{eq:Re_takeback}) doesn't change for
the sensitivity analyses of Figs.~\ref{fig:all_Re_terms_C_cap_graph}--\ref{fig:all_Re_terms_k_graph}.
Thus, for the remaining sensitivity analyses, 
when the rebound percentage increases (decreases), 
energy takeback in the numerator of Eq.~(\ref{eq:Re_takeback})
increases (decreases) proportionally.


<<eta_tilde_takeback_Sdot_sens_graph, echo=FALSE, fig.cap="Expected energy savings ($\\Sdot$, solid line) and takeback (dashed line) sensitivity to post-EEU efficiency ($\\amacro{\\eta}$). (Note different $x$- and $y$-axis scales.)", fig.width=6, fig.height=4>>=
actual_cases <- rebound_data %>% 
  dplyr::filter(.data[[ReboundTools::eeu_base_params$case]] %in% c("Car", "Lamp"))

eta_sens_params = list(Car = list(eta_engr_units_star = seq(35, 50, by = 0.5)), 
                       Lamp = list(eta_engr_units_star = seq(70000, 90000, by = 5000)))

eta_sens_data <- ReboundTools::parametric_analysis(original_cases = actual_cases,
                                                   parameterization = eta_sens_params) %>%
  dplyr::mutate(
    takeback = .data[[ReboundTools::rebound_terms$Re_tot]] * .data[[ReboundTools::star_vars$S_dot_dev]]
  )

# This is a hacky formatter function 
# that formats the x-axis numbers of the graphs.
# The argument x_breaks is the breaks for an axis.
# The function checks to see if the breaks are > 1000 and divides by 1000 in that case.
# This approach works, because lm-hr/kW-hr values are > 1000 for the lamp example
# but the car example has mpg (which are all less than 100).
# So this function divides the Lm-hr/kW-hr values by 1000 while leaving the mpg values unchanged.
eta_tilde_formatter <- function(x_breaks) {
  if (all(x_breaks > 1000)) {
    # To convert Lm-hr/kW-hr to Lm-hr/W-hr.
    return(x_breaks/1000)
  }
  # To leave mpg alone.
  return(x_breaks)
}

sensitivity_graphs(.parametric_data = eta_sens_data,
                   x_var = "eta_engr_units_star", 
                   y_var = c(ReboundTools::star_vars$S_dot_dev, "takeback")) +
  ggplot2::facet_wrap(facets = "Case", scales = "free") +
  ggplot2::scale_x_continuous(labels = eta_tilde_formatter) +
  ggplot2::scale_y_continuous(limits = c(0, NA)) +
  ggplot2::scale_colour_manual(values = c(S_dot_dev = "black", takeback = "black"), guide = FALSE) + 
  ggplot2::scale_size_manual(values = c(S_dot_dev = 0.5, takeback = 0.5), guide = FALSE) + 
  ggplot2::scale_linetype_manual(values = c(S_dot_dev = "solid", takeback = "dashed"), guide = FALSE) +
  ggplot2::labs(x = expression(tilde(eta)*" [mpg (Car) or lm-hr/W-hr (Lamp)]"),
                y = expression("Takeback and "*dot(S)[dev]*" [MJ/yr]"),
                colour = ggplot2::element_blank(),
                size = ggplot2::element_blank(),
                linetype = ggplot2::element_blank()) +
  MKHthemes::xy_theme() + 
  ggplot2::theme(        
    # Move the facet labels out of the graphs slightly.
    strip.text.x = ggplot2::element_text(margin = ggplot2::margin(b = 2))
  )
@


<<all_Re_terms_eta_graph, echo=FALSE, fig.cap="Sensitivity of rebound components to post-EEU efficiency ($\\amacro{\\eta}$).", fig.width=6, fig.height=4>>=
Re_graph_params <- ReboundTools::sens_graph_params
Re_graph_params[["include_x_axis"]] <- TRUE
Re_graph_params[["use_latex_legend"]] <- TRUE

Re_terms_order <- ReboundTools::rebound_terms[c(ReboundTools::rebound_terms$Re_tot,
                                                ReboundTools::rebound_terms$Re_macro,
                                                ReboundTools::rebound_terms$Re_dinc,
                                                ReboundTools::rebound_terms$Re_iinc,
                                                ReboundTools::rebound_terms$Re_dsub,
                                                ReboundTools::rebound_terms$Re_isub,
                                                ReboundTools::rebound_terms$Re_dempl,
                                                ReboundTools::rebound_terms$Re_emb,
                                                ReboundTools::rebound_terms$Re_md)] %>% 
  unlist()

rebound_terms_graph(rebound_data = actual_cases, parameterization = eta_sens_params, 
                    x_var = "eta_engr_units_tilde", 
                    Re_terms = Re_terms_order,
                    graph_params = Re_graph_params) +
  ggplot2::facet_wrap(facets = "Case", scales = "free_x") + 
  ggplot2::scale_x_continuous(labels = eta_tilde_formatter) +
  ggplot2::labs(x = expression(tilde(eta)*" [mpg (Car) or lm-hr/W-hr (Lamp)]"),
                y = "Rebound terms [-]",
                colour = ggplot2::element_blank(),
                size = ggplot2::element_blank(),
                linetype = ggplot2::element_blank()) +
  MKHthemes::xy_theme() + 
  ggplot2::theme(legend.text.align = 0, 
                 # Move the facet labels out of the graphs slightly.
                 strip.text.x = ggplot2::element_text(margin = ggplot2::margin(b = 2)))
@


%------------------------------
\subsubsection{Effect of capital cost ($\amacro{C}_{cap}$)} 
\label{sec:effect_of_capital_cost}
%------------------------------

The sensitivity of energy rebound
to capital cost ($\amacro{C}_{cap}$) is shown
in Fig.~\ref{fig:all_Re_terms_C_cap_graph}.
All other things being equal,
as capital cost of the EEU rises, 
less cash is freed by the EEU,
leading to smaller income, macro, and total rebound.
The same effects would be observed
with increasing maintenance and disposal cost rate ($\ramacro{C}_{\md}$).

A limitation of the capital cost sensitivity analysis is that
capital cost ($\amacro{C}_{cap}$) is unlikely to be
independent of $\amacro{\eta}$.
Within a given energy efficiency technology
(e.g., hybrid cars or LED lamps),
greater capital cost ($\amacro{C}_{cap}$) may be associated with
greater service efficiency ($\amacro{\eta}$).
$\amacro{C}_{cap}$ and $\amacro{\eta}$ should probably be varied jointly,
not independently.

<<all_Re_terms_C_cap_graph, echo=FALSE, fig.cap="Sensitivity of rebound components to capital cost ($\\amacro{C}_{cap}$).", fig.width=6, fig.height=4>>=
C_dot_cap_sens_params <- list(Car = list(C_cap_star = seq(26000, 30000, by = 1000)),
                              Lamp = list(C_cap_star = seq(0.5, 10.0, by = 0.1)))

rebound_terms_graph(rebound_data = actual_cases, parameterization = C_dot_cap_sens_params,
                    x_var = "C_cap_star", 
                    Re_terms = Re_terms_order,
                    graph_params = Re_graph_params) +
  ggplot2::scale_x_continuous(breaks = c(1, 2, 4, 6, 8, 10, 26000, 28000, 30000)) + 
  ggplot2::facet_wrap(facets = "Case", scales = "free_x") +
  ggplot2::labs(x = expression(tilde(C)[cap]*" [$]"),
                y = "Rebound terms [-]",
                colour = ggplot2::element_blank(),
                size = ggplot2::element_blank(),
                linetype = ggplot2::element_blank()) +
  MKHthemes::xy_theme() +
  ggplot2::theme(legend.text.align = 0,
                 # Move the facet labels out of the graphs slightly.
                 strip.text.x = ggplot2::element_text(margin = ggplot2::margin(b = 2)))
@


%------------------------------
\subsubsection{Effect of energy price ($p_E$)} 
\label{sec:effect_of_energy_price}
%------------------------------

<<Germany_results, echo=FALSE>>=
# In the calculations, we include same parameters for German energy prices.
# Extract that information here for use in the paragraph below.
Car_Germany_Re_tot <- rebound_results %>% 
  dplyr::filter(Case == "Car - Germany") %>% 
  dplyr::select("Re_tot")
Lamp_Germany_Re_tot <- rebound_results %>% 
  dplyr::filter(Case == "Lamp - Germany") %>% 
  dplyr::select("Re_tot")
@


The effect of energy price on rebound is shown in Fig.~\ref{fig:all_Re_terms_p_E_graph}.
Increasing energy prices lead to larger total rebound ($Re_{tot}$),
because higher energy prices lead to more freed cash 
to be re-spent by the device owner.
All other things being equal, more freed cash leads to 
more spending on other goods and services that demand energy.

Fig.~\ref{fig:all_Re_terms_p_E_graph} also 
shows the effect of energy price ($p_E$)
on all rebound components.
Most rebound components increase with energy price, 
with the examples exhibiting different sensitivities. 
Substitution effects ($Re_{dsub}$ and $Re_{isub}$)
are the only rebound components that decrease with energy price ($p_E$).
Substitution effects decrease with energy price, because 
at high energy price, less behavior adjustment is needed to re-equilibrate 
after emplacement of the energy efficient device.

German energy prices%
\footnote{
  For the car example,
  the gasoline price in Germany is taken as 1.35 \euro{}/liter for ``super gasoline'' (95 octane),
  an approximate average price over the last five years~\citep{finanzen}.
  For the lamp example,
  the electricity price in Germany is taken as 0.3 \euro{}/kW-hr~\citep{bundesministerium}.
  Converting currency (at 1 \euro{} = 1.21 USD) and
  physical units gives 6.18~\$/USgallon and 0.363~\$/kW-hr.}
%
are shown as vertical lines,
providing an indication of possible energy price variations.
All other things being equal, 
if U.S.\ residents paid Germany's energy prices,
energy rebound would be 
$\Sexpr{formatC(unlist(Car_Germany_Re_tot * 100), digits = 3)}$\%
for the car example and 
$\Sexpr{formatC(unlist(Lamp_Germany_Re_tot * 100), digits = 3)}$\%
for the lamp example.

A limitation of the energy price sensitivity analysis arises from the fact that
energy price is not independent of other parameters.
Indeed, other rebound parameters
would change along with energy price
(especially if moving from one country to another),
including capital cost ($\amacro{C}_{cap}$), 
maintenance and disposal expenditure rate ($\ramacro{C}_{\md}$),
energy intensity of the economy ($I_E$), and
energy service consumption rate ($\rbempl{q}_s$).

<<all_Re_terms_p_E_graph, echo=FALSE, fig.cap="Sensitivity of rebound components to energy price ($p_E$).German energy prices denoted by vertical line.", fig.width=6, fig.height=4>>=
 p_E_sens_params <- list(Car = list(p_E_engr_units = seq(1, 8, by = 0.5)),
                         Lamp = list(p_E_engr_units = seq(0.05, 0.4, by = 0.01)))

 price_data <- tibble::tribble(~Case, ~Country, ~p_E_engr_units,
 #                               "Car", "GBR", 6.48,     # $/USgal
 #                               "Lamp", "GBR", 0.28,    # $/W-hr
                               "Car", "DEU", 6.18,     # $/USgal
                               "Lamp", "DEU", 0.363)   # $/W-hr
rebound_terms_graph(rebound_data = actual_cases, parameterization = p_E_sens_params, 
                    x_var = "p_E_engr_units", 
                    Re_terms = Re_terms_order,
                    graph_params = Re_graph_params) +
  ggplot2::geom_vline(data = price_data, 
                      mapping = ggplot2::aes_string(xintercept = "p_E_engr_units"), 
                      size = 0.1) +
  ggplot2::scale_y_continuous(breaks = seq(-0.2, 1, by = 0.2)) +
  ggplot2::facet_wrap(facets = "Case", scales = "free_x") + 
  ggplot2::labs(x = expression(p[E]*" [$/gal (Car) or $/kW-hr (Lamp)]"),
                y = "Rebound terms [-]",
                colour = ggplot2::element_blank(),
                size = ggplot2::element_blank(),
                linetype = ggplot2::element_blank()) +
  MKHthemes::xy_theme() +
  ggplot2::theme(legend.text.align = 0,
                 # Move the facet labels out of the graphs slightly.
                 strip.text.x = ggplot2::element_text(margin = ggplot2::margin(b = 2)))
@


%------------------------------
\subsubsection{Effect of elasticity ($\eqspsUC$)} 
\label{sec:effect_of_elasticity}
%------------------------------

Fig.~\ref{fig:all_Re_terms_eps_graph} shows the variation of total rebound ($Re_{tot}$)
with the uncompensated price elasticity of energy service demand ($\eqspsUC$).
The effect is exponential:
total rebound increases with larger negative values of $\eqspsUC$, as expected.
The lamp example shows stronger exponential variation than the car example.
Fig.~\ref{fig:all_Re_terms_eps_graph} shows that direct substitution rebound 
($Re_{dsub}$) is the most sensitive rebound component to changes in $\eqspsUC$.
For the lamp example, indirect income rebound ($Re_{iinc}$) also increases
substantially with $\eqspsUC$, 
because freed cash increases substantially with $\eqspsUC$ in the lamp example. 

A limitation of the elasticity sensitivity study derives from limitations of the 
CES utility model itself, which constrains price elasticity variation
given an elasticity of substitution.
Uneconomic conditions should be avoided.
For example, negative direct substitution rebound ($Re_{dsub} < 0$)
is obtained when $\left| \eqspsUC \right| < \fCs$,
because Eq.~(\ref{eq:sigma}) pushes 
the elasticity of substitution negative ($\sigma < 0$).
In reality, smaller negative (closer to 0) price elasticity ($\eqspsUC$)
would correlate with a smaller fraction of expenses spent on the energy service ($\fCs$), 
thereby avoiding the uneconomic condition.
However, a univariate sensitivity study cannot capture this effect and is
best used for smaller variations in $\eqspsUC$.

<<all_Re_terms_eps_graph, echo=FALSE, fig.cap="Sensitivity of rebound components to uncompensated energy service price elasticity of energy demand ($\\eqspsUC$). (Note reversed $x$-axis scale.)", fig.width=6, fig.height=4>>=
eps_sens_params <- list(Car = list(e_qs_ps_UC = seq(-0.7, -0.1, by = 0.01)),
                        Lamp = list(e_qs_ps_UC = seq(-0.7, -0.1, by = 0.01)))

rebound_terms_graph(rebound_data = actual_cases, parameterization = eps_sens_params,
                    x_var = "e_qs_ps_UC", 
                    Re_terms = Re_terms_order,
                    graph_params = Re_graph_params) +
  ggplot2::facet_wrap(facets = "Case", scales = "free_x") +
  ggplot2::scale_x_reverse() +
  ggplot2::labs(x = expression(epsilon[dot(q)[s]*","*p[s]]),
                y = "Rebound terms [-]",
                colour = ggplot2::element_blank(),
                size = ggplot2::element_blank(),
                linetype = ggplot2::element_blank()) +
  MKHthemes::xy_theme() +
  ggplot2::theme(legend.text.align = 0,
                 # Move the facet labels out of the graphs slightly.
                 strip.text.x = ggplot2::element_text(margin = ggplot2::margin(b = 2)))
@


%------------------------------
\subsubsection{Effect of macro factor ($k$)} 
\label{sec:effect_of_macro_factor}
%------------------------------

The sensitivity of energy rebound 
to the macro factor ($k$) is shown 
in Fig.~\ref{fig:all_Re_terms_k_graph}.
The macro factor has a linear effect on total rebound ($Re_{tot}$)
through the macro rebound component ($Re_{\macro}$).
All other rebound components are constant as $k$ varies.

A limitation of the macro factor sensitivity analysis is that
the macro factor ($k$) is unlikely to be 
independent of $I_E$, because 
different values of $k$ imply a different macro-economy.

<<all_Re_terms_k_graph, echo=FALSE, fig.cap="Sensitivity of rebound components to the macro factor ($k$).", fig.width=6, fig.height=4>>=
k_sens_params <- list(Car = list(k = seq(0.5, 3.5, by = 0.5)),
                      Lamp = list(k = seq(0.5, 3.5, by = 0.5)))

rebound_terms_graph(rebound_data = actual_cases, parameterization = k_sens_params,
                    x_var = "k", 
                    Re_terms = Re_terms_order,
                    graph_params = Re_graph_params) +
  ggplot2::scale_y_continuous(breaks = seq(-0.2, 1, by = 0.2)) + 
  ggplot2::facet_wrap(facets = "Case", scales = "free_x") +
  ggplot2::labs(x = expression("k [-]"),
                y = "Rebound terms [-]",
                colour = ggplot2::element_blank(),
                size = ggplot2::element_blank(),
                linetype = ggplot2::element_blank()) +
  MKHthemes::xy_theme() +
  ggplot2::theme(legend.text.align = 0,
                 # Move the facet labels out of the graphs slightly.
                 strip.text.x = ggplot2::element_text(margin = ggplot2::margin(b = 2)))
@


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Discussion}
\label{sec:discussion}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In this section, we highlight several novel characteristics
of the comprehensive, consumer-based energy rebound analysis framework.
Next, we show how the framework enables insights
on energy policy, especially policies to encourage energy efficiency. 
Finally, we discuss below the macro factor ($k$), one of the novel features of this paper.


%++++++++++++++++++++++++++++++
\subsection{Novel aspects of the framework}
\label{sec:framework_novelties}
%++++++++++++++++++++++++++++++

In this section, we highlight four novel characteristics of the rebound analysis framework.
First, the framework is, to our knowledge, the first to enable 
numerically precise calculation of several microeconomic rebound effects
and a macro effect.
The two examples show the benefits of the framework for such calculations.

Another novelty of our work involves expressing 
numerically precise income and substitution effects
for non-marginal efficiency improvements
in numerically precise graphics. 
The possibility of decomposing direct and indirect rebound effects into 
substitution and income effects was outlined by \citet{Khazzoom1980}, 
spelt out clearly by \citet{greening2000}, and
numerical magnitudes approximated by \citet{Borenstein:2015aa}. 
Yet, past investigations of microeconomic rebound
typically show only stylized graphs of indifference curves in the consumption space, 
even if they are numerically precise in other respects 
\citep{Thomas:2013aa,Moshiri2017,Li2018}.
Our precisely drawn rebound path graphs
(Figs.~\ref{fig:CarEnergyGraph}--\ref{fig:LampConsGraph})
through energy, expenditure, and consumption spaces
aid comprehension of and intuition about the various rebound effects.

The third novel aspect of this framework is its inclusion of
embodied energy and maintenance and disposal effects of the EEU. 
These effects are the energy manifestation of the important difference 
between costless technology upgrades or (costly) mandated efficiency 
increases \citep{Gillingham:2013aa,Fullerton2020}.
Embodied energy and maintenance and disposal effects are not typically 
included in microeconomic rebound frameworks \citep{Azevedo2014,Gillingham:2020aa}.
Most rebound frameworks assume costless upgrade in both financial and energy terms.
This framework shows that it is possible to include such effects.

Finally, this framework is the first, to our knowledge, 
to operationalize the macroeconomic factor and 
to identify the place to link macro to micro effects. 


%++++++++++++++++++++++++++++++
\subsection{Policy considerations}
\label{sec:policy}
%++++++++++++++++++++++++++++++

We take for granted that it is desirable
to reduce energy consumption via energy efficiency to reduce CO$_2$ emissions.
For energy efficiency to be as effective as possible, rebound should be minimised.
The sensitivity analyses of Section~\ref{sec:sensitivity_analyses}
enable exploration of several policy options that are often suggested
to promote energy efficiency:
energy efficiency standards, rebates or subsidies, and carbon taxes.
We discuss the rebound implications of each policy option with reference to the sensitivity analysis
of Section~\ref{sec:sensitivity_analyses}.


%------------------------------
\subsubsection{Energy efficiency standards} 
\label{sec:policy:standards}
%------------------------------

Energy efficiency standards mandate minimum energy efficiency levels for selling into a market.
One example of energy efficiency standards is the Corporate Average Fuel Economy (CAFE) 
standards for U.S.\ cars.

Fig.~\ref{fig:all_Re_terms_eta_graph} shows that rebound falls
as post-upgrade energy efficiency ($\amacro{\eta}$) rises. This result is driven mainly by a declining 
direct rebound effect as efficiency rises (Fig.~\ref{fig:all_Re_terms_eta_graph}), in turn 
driven by the declining own price elasticity of energy service demand ($\eqspsUC$). 
So raising the minimum efficiency required to participate in a market is beneficial.
Indeed, Fig.~\ref{fig:eta_tilde_takeback_Sdot_sens_graph} shows the gap between 
expected energy savings and takeback grows with efficiency, so
absolute energy savings are expected to increase as efficiency grows.
However, Fig.~\ref{fig:eta_tilde_takeback_Sdot_sens_graph} shows that 
takeback increases with efficiency, so caution is merited.

Larger efficiency increases can require higher capital investment within a given technology.
To encourage market penetration of higher-efficiency devices, 
regulators may be tempted to reduce costs to device purchasers via rebates or subsidies, 
the topic of the next section.


%------------------------------
\subsubsection{Rebates or subsidies} 
\label{sec:policy:rebates_or_subsidies}
%------------------------------

Rebates or subsidies can be offered to device purchasers to incentivize adoption of 
energy-efficiency technologies and grow their markets.
Doing so effectively reduces the capital cost of energy efficiency devices ($\amacro{C}_{cap}$).
However, Fig.~\ref{fig:all_Re_terms_C_cap_graph} shows that reducing capital cost 
increases energy rebound, 
the route being, predominantly, the income effect 
where more net income is available to spend on more of the energy service and other goods.
Thus, policymakers should be aware that rebound will reduce the effectiveness of rebates and subsidies
to generate actual energy savings. 
We note in passing that the framework accommodates 
both costless upgrades and a costly ``policy-induced'' improvement \citep{Gillingham2016}.

To avoid rebound generated by rebates or subsidies, 
policymakers may want to implement energy taxes, 
effectively raising the price of energy,
the topic of the next section.


%------------------------------
\subsubsection{Carbon taxes} 
\label{sec:splicy:energy_taxes}
%------------------------------

Carbon taxes reduce net income earned by device owners after the EEU
by raising the effective price of fossil energy and the price of any fossil energy-powered energy service,
such as non-electric cars.
By raising input prices,
consumers are incentivized to use less of the energy service and 
buy more-efficient devices.
However, increasing the price of energy means that subsequent 
increases in energy efficiency provide increasing net income.
Fig.~\ref{fig:all_Re_terms_p_E_graph} shows that energy rebound rises with energy price.
The route to higher rebound from rising energy prices is through the income and macro effects.
Thus, policymakers should be aware that raising energy prices will not be as effective 
as presumed, due to rebound effects.
Naturally, higher energy prices are likely
to induce structural change towards an overall less energy-intensive economy (e.g. more public transport);
yet, rebound effects become more pronounced.


%++++++++++++++++++++++++++++++
\subsection{Macroeconomic rebound}
\label{sec:macro_rebound_discussion}
%++++++++++++++++++++++++++++++

<<Calibrate_k, echo = FALSE>>=
Re_tot_expected <- 0.63
calibrated_k <- rebound_results %>% 
  dplyr::filter(.data[["Case"]] %in% c("Car", "Lamp")) %>% 
  ReboundTools::calibrate_k(Re_tot_expected)

# Land on k = 3 as a median value.
# Do a sensitivity study with those k values to recalculate everything.
k_cal_vals <- list(Car = list(k = 3),
                   Lamp = list(k = 3))

rebound_analysis_with_cal_k <- rebound_data %>% 
  dplyr::filter(.data[["Case"]] %in% c("Car", "Lamp")) %>% 
  ReboundTools::parametric_analysis(parameterization = k_cal_vals,
                                    include_orig_point = FALSE)
Re_macro_car_k_3 <- rebound_analysis_with_cal_k %>% 
  dplyr::filter(.data[["Case"]] == "Car") %>% 
  magrittr::extract2("Re_macro")
Re_macro_lamp_k_3 <- rebound_analysis_with_cal_k %>% 
  dplyr::filter(.data[["Case"]] == "Lamp") %>% 
  magrittr::extract2("Re_macro")
Re_tot_car_k_3 <- rebound_analysis_with_cal_k %>% 
  dplyr::filter(.data[["Case"]] == "Car") %>% 
  magrittr::extract2("Re_tot")
Re_tot_lamp_k_3 <- rebound_analysis_with_cal_k %>% 
  dplyr::filter(.data[["Case"]] == "Lamp") %>% 
  magrittr::extract2("Re_tot")
@

The framework also links to the total or economy-wide rebound literature
by relating the size of macroeconomic rebound 
to that of the microeconomic rebound 
in a term that corresponds to magnitudes in the microeconomic portion of the framework. 
We note, again, that 
most rebound analyses focus on either microeconomic effects or total rebound.
Few rebound studies have explored the macro space 
between micro and total rebound.
Inspired by \citet{Borenstein:2015aa} and others, 
we bridge macro and micro with the macro factor ($k$), 
as discussed in Section~\ref{sec:macro_effect_main_paper}.
For the results presented in Section~\ref{sec:examples}, 
we assumed a placeholder value of $k = 1$,
meaning that every \$1 spending by the device owner in the income effect
generates \$1 of additional economic activity in the broader economy.
However, the framework presented in Section~\ref{sec:framework} and
the results obtained in Section~\ref{sec:examples}
allow, for the first time, some initial discussion about a value for $k$.

To calibrate the macro factor,
we treat macro rebound ($Re_{\macro}$) as a residual.
The macro factor ($k$) becomes an unknown parameter whose value is to be chosen
such that $Re_{\macro}$
is sufficient to achieve an expected value for total rebound ($Re_{tot}$).
We take the expected value for $Re_{tot}$ from 
\citet{Brockway2021} who surveyed 33 recent studies to find
average total rebound of $Re_{tot} = \Sexpr{Re_tot_expected*100}\%$.
The calibrated values of $k$ that give identical $Re_{tot} = \Sexpr{Re_tot_expected*100}$\% 
for both examples are
$k = \Sexpr{formatC(calibrated_k[["Car"]], digits = 2)}$
for the car example and
$k = \Sexpr{formatC(calibrated_k[["Lamp"]], digits = 2)}$ 
for the lamp example.

Intuition as well as the considerable variance in $Re_{tot}$ in 33 surveyed studies 
indicates that total rebound from one EEU is likely to be different from 
total rebound from another EEU. 
For the purposes of illustration we set $k = 3$,
being between the values of $k$ 
estimated from the car and lamp examples.
Note that $k = 3$ implies that 
every \$1 of net income spent by the device owner 
generates \$3 of additional economic 
activity in the broader economy.
We multiply $k \rasub{N}$ by the energy intensity of the economy to 
find the energy implications of respending in the economy.
There are three ways to think of $k = 3$.
First, $k = 3$ can be considered to be the average 
economic growth generated by the owner spending each \$1 of net income,
or three times over the growth implied by applying Hulten's theorem.
Second, it could be that growth is less than 
\$3 but that the macroeconomic ``energy price effect" (a decline in 
energy prices due to the fallen demand) induces consumption at a higher
energy intensity than that of the pre-EEU economy. 
Third, from the demand-side perspective
entertained by \citet{Borenstein:2015aa}, 
$k = 3$ could be interpreted as 
a marginal propensity to consume (MPC) of 75\%. 
(See Appendix~\ref{sec:income_macro_mpc}.)
$\MPC = 0.75$ is a reasonable number, 
being in the upper half of recent estimates by \citet{Carroll2017}.
(The analogy with MPC
makes a link to Borenstein's approach, 
even though we consider the macro effect to be 
driven by supply side productivity growth.)

After calibrating $k = 3$, we see that choosing a placeholder value of $k = 1$
underestimated $Re_{\macro}$ and, therefore, $Re_{tot}$.
In Figs.~\ref{fig:CarEnergyGraph} and~\ref{fig:LampEnergyGraph},
the macro effect segments (\bartilde{})
should be three times longer than they appear.
In Tables~\ref{tab:car_results} and~\ref{tab:lamp_results},
the values of macro rebound ($Re_{\macro}$) should triple to
\Sexpr{formatC(Re_macro_car_k_3*100, digits = 3)}\% and
\Sexpr{formatC(Re_macro_lamp_k_3*100, digits = 3)}\%, and
the values of total rebound ($Re_{tot}$) should increase to 
\Sexpr{sprintf("%.1f", round(Re_tot_car_k_3*100), 1)}\% and
\Sexpr{formatC(Re_tot_lamp_k_3*100, digits = 3)}\%
for the car and lamp examples,
respectively.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusions}
\label{sec:conclusion}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In this paper,
we have developed a comprehensive, consumer-based rebound analysis framework
that solidifies theoretical foundations for energy rebound,
enables empirical analysis, and 
can be used to guide energy efficiency policy.
The framework is the first to our knowledge
to integrate all components of direct and indirect microeconomic rebound for consumers
in an analytically consistent yet numerically precise and operationalizable manner. 
The sets of three rebound path graphs that simultaneously 
track energy, expenditure, and consumption 
decisions for every rebound component display and summarize this integration. 
The framework 
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item builds upon microeconomic foundations and 
        carefully distinguishes among microeconomic rebound effects,
  
  \item identifies and incorporates, for the first time,
        a plausible value for the macro factor ($k = 3$)
        to provide a better link between macro and micro effects, and 

  \item enables empirical estimation of rebound magnitudes for real energy efficiency upgrades.

\end{enumerate*}

From the development and application of the framework, 
we can draw four important conclusions.
First, the car and lamp examples (Section~\ref{sec:examples}) show that
        the framework enables
        quantification of magnitudes of all microeconomic rebound mechanisms, including 
        direct and indirect channels 
        for emplacement, substitution, and income effects.
Second, the examples show that magnitudes of rebound effects
        vary with the type of energy efficiency upgrade performed.
Third, the sensitivity studies
        (Section~\ref{sec:sensitivity_analyses})
        enable evaluation of rebound sensitivies to imporant parameters. 
        For the examples in this paper, total rebound is   
        more sensitive to
        the price of energy ($p_E$),
        the elasticity of energy service demand ($\eqspsUC$), and
        the macro factor ($k$) 
        than either
        efficiency ($\amacro{\eta}$) or
        capital cost ($\amacro{C}_{cap}$).
Last, the discussion (Section~\ref{sec:discussion}) shows that
        rebound is a headwind for efficiency-led energy reduction and CO$_2$ mitigation policies.
        Quantification of rebound effect magnitudes
        is an important precursor to devising energy efficiency policies
        that would both encourage efficiency and limit rebound effects.

Future work could be pursued in several areas. 
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item Other utility models could be explored for the substitution effect.
  
  \item Further empirical studies could be performed
        to estimate the magnitude of different 
        rebound mechanisms in a range of real-life case studies.

  \item Deeper study of macro rebound is needed, including improved estimates 
        for the macro factor ($k$) and its relation to the MPC.

  \item The framework could be extended to producer-sided energy rebound mechanisms.
    
  \item The framework presented here could be embedded 
        in energy-economy models to better include rebound effects 
        in macro energy modeling and energy policy discussions.

\end{enumerate*}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Competing interests}
\label{sec:competing_interests}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Declarations of interest: none.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Author contributions}
\label{sec:author_contributions}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\textbf{Matthew Kuperus Heun}: 
Conceptualization, 
Formal analysis, 
Resources, 
Software, 
Supervision, 
Validation,
Visualization,
Writing--original draft,
Writing--review \& editing.
\textbf{Gregor Semieniuk}: 
Conceptualization, 
Formal analysis, 
Investigation, 
Writing--original draft,
Writing--review \& editing.
\textbf{Paul Brockway}: 
Conceptualization, 
Data curation, 
Formal analysis, 
Investigation, 
Validation, 
Writing--original draft,
Writing--review \& editing.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Data repository}
\label{sec:data_repository}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

All data and calculations are stored at **** Leeds data repository URL. ****.
An \texttt{R} package for performing all rebound calculations
can be found at \url{https://github.com/MatthewHeun/ReboundTools}.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Acknowledgements}
\label{sec:acknowledgements}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%List funding sources in this standard way to facilitate compliance to funder's requirements: Funding: This work was supported by the National Institutes of Health [grant numbers xxxx, yyyy]; the Bill \& Melinda Gates Foundation, Seattle, WA [grant number zzzz]; and the United States Institutes of Peace [grant number aaaa].

%It is not necessary to include detailed descriptions on the program or type of grants and awards. When funding is from a block grant or other resources available toa university, college, or other research institution, submit the name of the institute or organization that provided the funding.

%If no funding has been provided for the research, please include the following sentence: This research did not receive any specific grant from funding agencies  in the public, commercial, or not-for-profit sectors.

Paul Brockway’s time was funded by the UK Research and Innovation (UKRI) 
Council, supported under EPSRC Fellowship award EP/R024254/1.
The authors are grateful for comments from internal reviewers
Fred Haan, Becky Haney, and Jeremy Van Antwerp (Calvin University); 
Nathan Chan (University of Massachusetts at Amherst); and 
Zeke Marshall (University of Leeds).
The authors benefitted from discussions with 
Daniele Girardi (University of Massachusetts at Amherst) and 
Christopher Blackburn (Bureau of Economic Analysis).
Finally, the authors thank the students of MKH's Fall 2019 
Thermal Systems Design course (ENGR333) 
who studied energy rebound of many energy conversion devices
using an early version of this framework.

% No need for this section label, because BibTeX already provides a "References" heading.
% \section*{References}

\bibliography{HSB_refs}



\appendix
\counterwithin{figure}{section}
\counterwithin{table}{section}

% Gives a helpful "Appendix" label
\section*{Appendix}

% Labels each appendix as A, B, C, etc. instead of Appendix A, Appendix B, Appendix C, etc.
\renewcommand{\thesection}{\Alph{section}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Nomenclature}
\label{sec:nomenclature}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{pieces/nomenclature.tex}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Derivation of comprehensive, consumer-based rebound analysis framework}
\label{sec:derivation}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{pieces/derivation.tex}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Mathematical details of rebound path graphs}
\label{sec:graph_details}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{pieces/rebound_path_graph_details.tex}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Utility models and elasticities}
\label{sec:utility_and_elasticities}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

<<UtilityAppendix, child="pieces/utility_and_elasticities.Rnw">>=
@



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Proof: Income preference equations satisfy the budget constraint}
\label{sec:proof_income_elasticities}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{pieces/proof_income_elasticities.tex}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Other goods expenditures and constant $p_o$}
\label{sec:other_goods_expenditures}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{pieces/other_goods_expenditures.tex}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Income and macro effects and relation to the
marginal propensity to consume (MPC)}
\label{sec:income_macro_mpc}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{pieces/mpc.tex}



\end{document}
