% Energy Economics Author Guide: 
% https://www.elsevier.com/journals/energy-economics/0140-9883/guide-for-authors

\documentclass[review]{elsarticle}

\usepackage{lineno}
\modulolinenumbers[5]


%% Package imports %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{amsfonts}           % For access to \checkmark.
\usepackage{amsmath}            % For better symbol decorations
\usepackage{booktabs}           % For nice table rules
\usepackage[official]{eurosym}  % For the euro symbol
\usepackage[figurename=Fig.]{caption} % For changing "Figure" to "Fig." in figure captions
\usepackage{chngcntr}           % To get figure and table numbering correct in the appendices
\usepackage[makeroom]{cancel}   % To show terms go to zero
\usepackage[inline]{enumitem}   % For inline enumeration
\usepackage{multicol}           % For multi-column layout
\usepackage{multirow}           % For multi-row layout
\usepackage{nccmath}            % For the \useshortskip command above equations
\usepackage{parcolumns}         % For multi-column layout
\usepackage{pdflscape}          % For landscape environment \begin{landscape} ... \end{landscape}
\usepackage{soul}               % For text highlighting
\usepackage[most]{tcolorbox}    % For color highlighting of text
\usepackage{tikz}               % For diagrams
\usetikzlibrary{arrows,positioning}
\usepackage{ulem}               % For strikeout command (\sout)
\usepackage{xcolor}             % For ... colors

\usepackage{hyperref}           % hyperref should be the last package loaded


%% Macros defined by authors %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{pieces/macros.tex}


%% Journal %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\journal{Energy Economics}


%% Bibliography style %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bibliographystyle{model2-names.bst}\biboptions{authoryear}


\begin{document}
%\SweaveOpts{concordance=TRUE}

\begin{frontmatter}

%% Title %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{Toward a Comprehensive Energy-Economy \\
        Analytical Framework for \\
        Energy Rebound}


%% Authors %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\author[MKH_address]{Matthew Kuperus Heun\corref{corr_author}}
\cortext[corr_author]{Corresponding author}
\ead{mkh2@calvin.edu}

\author[GS_address]{Gregor Semieniuk}
\ead{gsemieniuk@umass.edu}

\author[PB_address]{Paul E. Brockway}
\ead{P.E.Brockway@leeds.ac.uk}


%% Addresses %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\address[MKH_address]{Engineering Department,\\
Calvin University, 3201 Burton St. SE,\\
Grand Rapids, MI, 49546, USA.}

\address[GS_address]{Political Economy Research Institute \& Department of Economics,\\
University of Massachusetts at Amherst, 412 North Pleasant St.,\\
Amherst, MA, 01002, USA}

\address[PB_address]{Sustainability Research Institute, School of Earth and Environment,\\
University of Leeds,\\
Leeds, LS2 9JT, UK}


%% Abstract %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{abstract}
A concise and factual abstract is required.
The abstract should state briefly 
the purpose of the research, 
the principal results, and
major conclusions. 
An abstract is often presented separately from the article, 
so it must be able to stand alone.
For this reason, References should be avoided, but if essential, 
then cite the author(s) and year(s).
Also, non-standard or uncommon abbreviations should be avoided, but
if essential they must be defined at their first mention in the abstract itself.
\end{abstract}


%% Keywords %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% maximum of 6 keywords, using American spelling and avoiding general and plural terms and multiple concepts 
% (avoid, for example, 'and', 'of'). Be sparing with abbreviations: 
% only abbreviations firmly established in the field may be eligible. 
% These keywords will be used for indexing purposes.

% Up to 6 standard JEL codes. The available codes may be accessed at JEL, 
% https://www.aeaweb.org/jel/guide/jel.php   

\begin{keyword}
% Maximum of 6 keywords. \texttt{elsarticle.cls}\sep \LaTeX\sep Elsevier \sep template
% Maximum of 6 JEL codes. \MSC[2010] 00-01 \sep  99-00
% JEL codes: https://www.aeaweb.org/jel/guide/jel.php
Energy rebound \sep Conservation \sep Backfire \sep 
Energy efficiency \sep Energy economics \sep Elasticity of substitution
\end{keyword}

\end{frontmatter}

<<setup, echo=FALSE, message=FALSE>>=
library(dplyr)
library(magrittr)
library(ReboundTools)
library(tidyr)
library(xtable)
@

\linenumbers


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}
\label{sec:introduction}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%++++++++++++++++++++++++++++++
\subsection{Energy rebound background}
\label{sec:background}
%++++++++++++++++++++++++++++++

% General discussion of the importance of rebound, 
% non-microeconomic references.
% Here are some references from Matt's database that you may want to include:
% \citet{Jevons:1866uy}, 
% \citet{Saunders:1992aa, Saunders:2000aa}, 
% \citet{Sorrell:2007um, Sorrell:2009cg, Sorrell:2010ul},
% \citet{Brockway:2017a}, 
% \citet{Tsao:2010},
% \citet{Chitnis:2015}, 
% \citet{Stapleton:2016}, 
% \citet{Sun:2018aa}, 
% \citet{Fullerton:2019aa},
% etc.
% 
% More studies on large rebound.
% What is missing is an overall framework for rebound to catch all aspects.
% Some people have captured parts.
% 
% We develop framework itself. 
% Follow-on question: need for a case-study example of exercising the framework.
% We provide a guide for application.
% We make it operational.



Energy rebound is a phenomenon whereby 
some expected energy savings do not occur 
after an energy efficiency upgrade (EEU), 
due to various behavior and market responses.

%+++
%This is the merged edit of MKH's and my suggested changes to avoid circularity. ---GS
%+++

The roots of energy rebound can be traced back to 
\citeauthor{Jevons:1865}
who, in his report entitled \emph{The Coal Question},
said that
``\emph{[i]t is wholly a confusion of ideas to suppose that the economical 
use of fuel is equivalent to a diminished consumption. 
The very contrary is the truth}'' (emphasis in original) \citet[p.~103]{Jevons:1865}.
A hundred years later, the 1970s oil crises gave a sharp
%returned the (I deleted the 'returned' word as jevons only noted it, it wasnt his primary concern)
focus to energy efficiency
and the debate over the 
%size and (I deleted 'size' as duplicate word to magnitude)
magnitude of rebound heated up. 
On one side, scholars including \citet{Brookes1979, Brookes1990} and \citet{Khazzoom1980} 
suggested that energy rebound could be large, 
while others, 
including \citet{Lovins1988} and \citet{Grubb1990, Grubb1992},
claimed that rebound was small.

The so-called \emph{Khazzoom-Brookes Postulate}, 
named by \citet{Saunders:1992aa},
was defined by \citet[p.~212]{Herring1999} as
``increased energy-efficiency at the microeconomic level,
while leading to a reduction of energy use at this level, 
leads not to a reduction, but instead to an increase in energy use, 
at the national, or macroeconomic level.''
The macroeconomic feedback mechanisms and their
size lie at
the heart of the debate,
which continues today.
Advocates of small rebound (say, less than 50~\%),
such as \citet{Gillingham:2013aa, Gillingham2016},
suggest ``the rebound effect is overplayed,'' 
while others, 
including \citet{Saunders2015} and \citet{Stern2020}
claim the evidence for large rebound
(greater than, say, 50~\% and in some cases above 100~\%, which is known as ``backfire'')
is growing.

The topic of energy rebound is important;
it is much more than an academic debate, 
because there is a lot at stake. 
If indeed large rebound does exist,
we see three areas of rebound concern: 
1. hampering of carbon reduction efforts, 
2. increases to resource and material consumption rates, 
and 
3. modelling and policy-making that largely neglects rebound.

First, to meet Paris Agreement carbon reduction targets~\citep{masson-delmotte2018},
%increasing 
energy efficiency measures are increasingly being expected to deliver
absolute decoupling, where 
%decreasing 
energy consumption and CO$_2$ emissions decrease
amidst continued economic growth.
Taking just one example,
by 2040
energy efficiency contributes 44~\% of 
energy-related global carbon emissions reductions in
the International Energy Agency's Sustainable Development scenario relative to
its New Policies scenario~\citep[Fig.~3.15, p.~139]{International-Energy-Agency:2017b}.
However as \citet{Brockway2021} note, 
such reductions in energy consumption 
would represent a structural break with the historical record
of close energy-GDP coupling,
assuming continued economic growth.

Second, the interactions between energy rebound
and increasing material and resource requirements
are significant~\citep{VandenBergh2009, FontVivanco2018}.
Given the global coupling of material consumption
to economic growth ~\citep{Haberl2020, Wiedmann2020}, 
it may not possible to separate energy rebound from rising material consumption and resource extraction.

Third, energy rebound is rarely included in either 
policy-making~\citep{fontvivanco2016}
or energy models~\citep{Brockway2021}, 
limiting our ability to assess the interactions among
rebound, 
carbon emissions, and
material and resource consumption.

%Thus
Bringing these concerns together, 
we believe estimating the magnitude 
of energy rebound is a crucially important goal.


%++++++++++++++++++++++++++++++
\subsection{Rebound typologies}
\label{sec:rebound_typologies}
%++++++++++++++++++++++++++++++

One of the challenges to better understanding energy rebound is its many
mechanisms and effects, which in turn 
has led to many different approaches to set out rebound typologies.
The most common rebound typologies 
distinguish between microeconomic effects (direct and indirect)
and 
macroeconomic effects
~\citep{greening2000, Barker2009, FontVivanco2018}. 
~\citet{greening2000} split total rebound 
into two parts:
microeconomic rebound (direct and indirect) and
macroeconomic (economy-wide effects and transformational effects).
+++
Greening et al actually talk about a 'macroeconomic view' (p.390) and 'macroeconomic implications' (p.399) but not a macroeconomic rebound ---GS
+++
+++PB - i still have to resolve GS query above.+++

\citet{Jenkins2011} break up microeconomic rebound effects into
direct (income and substitution effects) and 
indirect (respending and embodied effects), 
while \citet{Sorrell:2009cg} 
sets out five macroeconomic rebound effects:
embodied energy effects, respending effects, output effects, energy market effects, and composition effects.
\citet{Santarius2016} and \citet{Lange2021} distinguish 
meso (i.e., sector) scale rebound
from micro and macro rebound.
\citet{VandenBergh2011} distinguishes 14 types of rebound, 
providing, perhaps, the greatest complexity. 
Table~\ref{tab:typology} 
attempts to summarize and reconcile some of the existing typologies.
\citet{madlener2016}, 
reviewing 35 years of rebound research, noted that 
``the reader is sometimes overwhelmed (at best) and often confused (at worst) 
by the many different versions'' of rebound typologies.

\begin{table}
\caption{Rebound typology based on \citet{greening2000}, \citet{Jenkins2011}, and \citet{Thomas:2013ab}.
         **** We need to move Emplacement effects ahead of substitution and income effects 
              to maintain same order as rest of paper.---MKH ****
         **** Convert to a \LaTeX{} table?---MKH ****}
\centering
\includegraphics[width=1\linewidth]{figure_other/typology.pdf}
\label{tab:typology}
\end{table}


%++++++++++++++++++++++++++++++
\subsection{Empirical studies on the magnitude of energy rebound}
\label{sec:empirical_studies}
%++++++++++++++++++++++++++++++

%Could go in introduction as an example of techniques that we won't employ in this paper
%I am still not sure if this is the right place. maybe we refer to it 
%in a later section when we justify why we use a CES utility function?
%Gregor said in his email:
Update, the newer version of the BEA working paper does have a CES utility function and that paper is just really good
\citet{blackburn2020energy},




\citet{Sorrell:2007um} led
%provided (I changed to led, as there were others involved, across multiple publications)
an important systematic review of energy rebound estimates,
considering over 500 studies and reports from around the world.
He found 
that the most prevalent type of study focused on direct (microeconomic) rebound 
at the household level, with studies typically estimating small rebound magnitudes (10--30~\%).
In contrast, Sorrell noted that evidence for macroeconomic rebound 
was much weaker but could produce larger magnitudes, 
stating ``there are few published studies and these have a number 
of flaws. \ldots{} 
While little confidence can be placed in the available estimates, 
several studies suggest that economy-wide [i.e., macroeconomic] rebound effects may frequently exceed 50~\%.''
Since the~\citet{Sorrell:2007um} review,
empirical estimates
of (typically) household-level energy rebound
at the microeconomic scale (direct and indirect)
continue to suggest relatively small
microeconomic rebound magnitudes
of less than 40~\%~\citep{Greene2012, Thomas:2013ab, Antal:2014aa, Chitnis2014, Stapleton:2016}.
Commonly, microeconomic estimates are based on own sector (direct)
and/or
cross-sector (indirect, re-spending) price elasticities,
as set out by \citet{Gillingham2016}. 
\citet{dahlqvist2021rebound} provides an example of this price elasticity based 
approach applied to energy intensive industry sectors.

Meantime, estimates of macroeconomic rebound are very rare
[e.g.,~\citet{Barker2009}]. 
Instead, becoming more common 
are studies 
which estimate total rebound, 
(i.e., sum of microeconomic and macroeconomic rebound 
as shown in Table~\ref{tab:typology}.
A recent review of 33 studies by \citet{Brockway2021} 
found a dominant group of CGE-based studies, 
such as \citet{Lecca2014}, \citet{Broberg2015}, and \citet{Wei2017},
with a mean total rebound estimate (from 21 reviewed studies) of around 60~\%. 
The remaining approaches split into three sub-methods: non-CGE macroeconomic models
(e.g., \citet{Barker2009} and \citet{Lemoine:2020aa}),
econometric analysis (e.g., \citet{Wei2019} and \citet{Bruns2019}), and
productivity or growth accounting studies (e.g., \citet{Lin2015}).
The average magnitude of total energy rebound from these non-CGE methods 
was also found to be over 60~\%,
leading the review authors \citep[p.~1]{Brockway2021} 
to conclude that total rebound magnitudes 
were ``larger than commonly assumed.''


%++++++++++++++++++++++++++++++
\subsection{The need for a more comprehensive energy rebound analytical framework}
\label{sec:need_comprehensive}
%++++++++++++++++++++++++++++++

Much of the early work on rebound theory was at the microeconomic scale,
focusing on direct and indirect rebound via price elasticities (e.g.,~\citet{Schipper2000}).
Other microeconomic advances include those by 
\citet{Thomas:2013aa}, who set out a detailed framework of direct and indirect microeconomic effects;
\citet{Borenstein:2015aa},
who provided a detailed treatment of rebound into income and substitution effects;
and \citet{Sun:2018aa}, who considered direct rebound including device effects.
However, referring to Table~\ref{tab:typology}, lifecycle and end of life device effects are still not typically 
considered -- \citet{Babacan:2020aa} provides a rare example 
of life-cycle analysis effects of the energy efficient device.

At the macroeconomic scale,
\citet{Saunders:1992aa} made the earliest attempt
at a theoretical framework for total energy rebound
based on neo-classical aggregate production functions (APFs).
Later works continued the APF approach, including
\citet{Saunders:2000aa, Saunders2008},
\citet{Wei2017}, and
\citet{Brockway:2017a}.
\citet{Grepperud2004} provide one of the first
general equilibrium frameworks for rebound
(overcoming previous criticisms of partial equilibrium frameworks **** REF ****),
and were followed, among others, by general equilibrium models, including
\citet{Wei2010},
\citet{Lemoine:2020aa}, and
\citet{Fullerton:2019aa}.

Despite the growth of macroeconomic modeling frameworks to 
estimate overall, or total rebound, three key issues remain. 
First, by definition macroeconomic models
work in aggregate variable space when estimating total rebound.
+++
Are you excluding general equilibrium models from macroeconomic modeling frameworks? If so, I am confused by this exclusion and would like to understand your argument better. ---GS
+++ PB - i still have to resolve/update this.
Therefore, macroeconomic models rarely discriminate microeconomic and macroeconomic rebound components.
Second, following on, macroeconomic models of rebound lack linkages
between microeconomic and macroeconomic effects. 
The potential amplification from smaller, microeconomic rebound effects to
a larger, macroeconomic effect has been described as the energy productivity effect~\citep{Dimitropoulos2007, Sorrell:2010ul}
or, simply, a multiplier effect ~\citep{Borenstein:2015aa, Lange2019},
which occurs when
``the economy [expands] by more than the private income gain
enjoyed by the owner of the upgraded appliance'' \citep[p.~11]{Borenstein:2015aa}.
The size of this macro factor remains probably the most central of all issues
within the rebound debate.
On one side, \citet{Howarth1997} and \citet{Schipper2000}
claim that the macroeconomic rebound multiplier is small. 
On the other, \citet{Aucott2014}, \citet{Enflo2009}, and \citet{Bataille2017}
are among those who claim the macroeconomic multiplier effect is much larger. 
\citet[p.~6354]{Dimitropoulos2007} suggested that
``One of the main reasons behind the debate is the lack of a rigorous theoretical framework
that can describe the mechanisms and consequences of 
the rebound effect at the macro-economic level.''
In a recent review on energy productivity, 
\citet[p.~1]{Elkomy2020} found that
``[w]hile many researchers suggest that energy and productivity are linked, 
there is relatively little consensus in the empirical literatures 
either confirming or rejecting these views. 
In some cases (notably the relationship between capital and energy), 
we do not appear to have robust methodologies for making empirical assessments.''
Therefore it would be advantageous to have an energy-economy analytical framework
that allows for such macro effects to occur, 
linking microeconomic and macroeconomic scales.
A third issue is that estimates of total rebound magnitudes are
generated by macroeconomic frameworks
are typically contingent upon the type of production function assumed
(Cobb-Douglas, CES, etc.) and
choice of substitution elasticity.
As \citet[p.~2207-2208]{Saunders2008} noted,
``choice of production/cost function can pre-determine the results related to rebound\ldots{}
[and choosing] values for these [elasticity of substitution] parameters
is tantamount to assuming rebound results.''

% In addition, the development of a rebound analytical framework with the above characteristics provides a way to connect
% engineers and product designers
% (who usually focus on micro efficiency and the device level) and
% economists 
% (some of whom focus on the macroeconomic scale).


%++++++++++++++++++++++++++++++
\subsection{Need, aim, contributions, and structure}
\label{sec:aim_contribution_structure}
%++++++++++++++++++++++++++++++

**** Be sure we hit all of need, aim, contributions, and structure. ****
In summary, we find there is a strategic \emph{need} for
a comprehensive, mathematically-rigorous rebound analysis framework, one that 
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item is built from microeconomic foundations, 
  
  \item carefully distinguishes among the microeconomic components shown in Table~\ref{tab:typology}, and
  
  \item incorporates macroeconomic effects shown in Table~\ref{tab:typology}. 

\end{enumerate*}
%

The \emph{aim} of this paper is therefore to build upon the foundations laid by 
\citet{Borenstein:2015aa}) and others to develop such rebound framework.
The key \emph{contributions} of this paper are to
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item describe a consistent and mathematically-rigorous rebound framework
        in which direct and indirect dimensions of 
        substitution and income effects
        are connected,
        
  \item show that embodied energy, maintenance and disposal activities, 
        replacements, and macroeconomic effects can be accommodated 
        in a consistent and rigorous rebound framework, 
        
  \item provide a new way to visualize rebound effects, 
        namely energy, expenditure, and preference path graphs,
  
  \item apply a general utility function 
        via empirically-plausible cost shares of other goods consumption,
  
  \item provide two numerical case study examples (of a car and LED lamp) 
        to demonstrate the application of the framework, and 
        
  \item link quantified rebound effects with
        actionable steps to minimize real-world rebound effects.

        
\end{enumerate*}

The remainder of this paper is \emph{structured} as follows.
Section~\ref{sec:framework} describes the comprehensive analytical framework.
Section~\ref{sec:examples} provides two calculation examples, 
a hybrid car and an LED lamp.
Section~\ref{sec:discussion} discusses the results, and 
Section~\ref{sec:conclusion} concludes.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Methods: development of the comprehensive analytical framework}
\label{sec:framework}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

In this section, we develop a mathematical model 
for the comprehensive rebound framework.
We assume an energy conversion device (say, an automobile)
that consumes final energy (say, gasoline) at a rate $\rbempl{E}$ (in MJ/year).
The final energy is available at price $\bempl{p}_E$ (in \$/MJ).
The energy conversion device provides a rate of energy service 
$\rbempl{q}_s$ (in vehicle km/year)
with final-energy-to-service efficiency $\bempl{\eta}$ (in km/MJ).
An energy efficiency upgrade (EEU) increases
final-energy-to-service efficiency such that
$\amacro{\eta} > \bempl{\eta}$,
possibly at an increased expenditure rate to
procure (capital cost), operate, maintain, and dispose of the device such that
$\ramacro{C}_{cap} > \rbempl{C}_{cap}$ and 
$\ramacro{C}_{\md} > \rbempl{C}_{\md}$.
(This is not a costless EEU.)
As final-energy-to-service efficiency~($\eta$) increases,
the price of the energy service~($p_s$) declines.
The final energy price ($p_E$) is assumed exogenous
($\amacro{p}_E = \bempl{p}_E$),
so the final energy purchaser (i.e., the device owner) is a price taker.
(Relaxing the exogenous final energy price assumption
would require a full-economy model that is beyond the scope of this paper.)

Initially, the device owner spends income ($\rorig{M}$)
on final energy for the device ($\rorig{C}_s = p_E \rorig{E}_s$), 
annualized capital costs for the device ($\rorig{C}_{cap}$), 
annualized costs for maintenance and disposal of the device ($\rorig{C}_{\md}$), and 
other goods and services ($\rorig{C}_o$).
The budget constraint
for the device owner is

\begin{equation} \label{eq:budget_constraint}
  \rorig{M} = \rorig{C}_s + \rorig{C}_{cap} + \rorig{C}_{\md} + \rorig{C}_{o} + \rorig{N} \; ,
\end{equation}
%
where 
original net savings ($\rorig{N}$) is zero.
Note that
the vocabulary and mathematical notation for rebound effects is extensive;
Fig.~\ref{fig:flowchart} and Appendix~\ref{sec:nomenclature} provide guides to 
notation elements used throughout the paper, including
symbols, Greek letters, decorations, and subscripts.
The notation elements 
can be mixed to comprise a rich and expressive ``language'' of energy rebound.
We use colored backgrounds on rebound effects for visual convenience. 

\begin{figure}
\centering
  % The file is a Tikz picture.
  \input{pieces/flowchart.tex}
\caption{Flowchart of rebound effects and decorations.
         Rebound effects are arranged in the order of their discussion in this paper.
         The left-ro-right order does not necessarily represent 
         the progression of rebound effects through time.}
\label{fig:flowchart}
\end{figure}

Later (Sections~\ref{sec:empl_effect_main_paper}--\ref{sec:macro_effect_main_paper}), 
we walk through the several conceptual stages of rebound, including
the device upgrade and four rebound effects, and 
we derive rebound expressions for each. 
But first 
we define rebound relationships 
(Section~\ref{sec:rebound_relationships}) and 
typical energy and cost relationships (Section~\ref{sec:energy_and_cost_relationships}).


%++++++++++++++++++++++++++++++
\subsection{Rebound relationships}
\label{sec:rebound_relationships}
%++++++++++++++++++++++++++++++

Energy rebound is defined as

\begin{equation} \label{eq:Re_def}
  Re \equiv 1 - \frac{\text{actual final energy savings rate}}{\text{expected final energy savings rate}} \; ,
\end{equation}
%
where both actual and expected final energy savings rates are expected positive.
Final energy ``takeback'' is the rate at which final energy savings are eroded by rebound effects,
and the actual final energy savings rate is the expected final energy savings rate less takeback.
Note that takeback can be negative, indicating an increase in the final energy savings rate
relative to the expected final energy savings rate, sometimes called hyperconservation.
Thus,

\begin{equation}
  Re = 1 - \frac{\text{expected final energy savings rate} - \text{takeback}}{\text{expected final energy savings rate}} \; .
\end{equation}
%
Simplifying gives

\begin{equation} \label{eq:Re_takeback}
  Re = \frac{\text{takeback}}{\text{expected final energy savings rate}} \; .
\end{equation}
%
Thus, energy rebound can be given by either Eq.~(\ref{eq:Re_def}) or Eq.~(\ref{eq:Re_takeback}).

We define rebound at the final energy stage, 
because that is the point of energy purchase by the device owner.
To simplify derivations, 
we choose not to apply final-to-primary energy multipliers
to final energy rates in the numerators and denominators of rebound expressions
derived from Eqs.~(\ref{eq:Re_def}) and~(\ref{eq:Re_takeback});
they divide out anyway.
Henceforth, we drop the adjective ``final'' 
unless there is reason to indicate a specific stage of the energy conversion chain.


%++++++++++++++++++++++++++++++
\subsection{Typical energy and cost relationships}
\label{sec:energy_and_cost_relationships}
%++++++++++++++++++++++++++++++

With the rebound notation of Appendix~\ref{sec:nomenclature}, 
four typical relationships emerge.
First, the consumption rate of the energy service~($\rate{q}_s$)
is the product of final-to-services efficiency~($\eta$) and
the rate of energy consumption by the energy conversion machine~($\rate{E}_s$).
Typical units for automotive transport and illumination
(the examples in Section~\ref{sec:examples}) are shown
beneath each equation.
%
\begin{align} \label{eq:typ_qs_eta_Edot}
  \rate{q}_s &= \eta \rate{E}_s \\
  \text{pass-km/yr} &= [\text{pass-km/MJ}] [\text{MJ/yr}] \nonumber \\
  \text{lm-hr/yr} &= [\text{lm-hr/MJ}] [\text{MJ/yr}] \nonumber
\end{align}
%
Second, the energy service price~($p_s$) is the ratio of energy price~($p_E$) to the final-to-services efficiency~($\eta$).
%
\begin{align} \label{eq:ps_pE_eta}
  p_s &= \frac{p_E}{\eta} \\
  \text{\$/pass-km} &= \frac{\$/\text{MJ}}{\text{pass-km/MJ}} \nonumber \\
  \text{\$/lm-hr} &= \frac{\$/\text{MJ}}{\text{lm-hr/MJ}} \nonumber
\end{align}
%
Third, energy service expenditure rates~($\rate{C}_s$) are the product 
of energy price~($p_E$) and device energy consumption rates~($\rate{E}_s$).
%
\begin{align}
  \rate{C}_s &= p_E \rate{E}_s \\
  \text{\$/yr} &= [\text{\$/MJ}][\text{MJ/yr}] \nonumber
\end{align}
%
Fourth, indirect energy rates~($\rate{E}_j$) are the product 
of expenditures rates~($\rate{C}_j$) and energy intensity of the economy~($I_E$).
%
\begin{align} \label{eq:indirect_energy_rates}
  \rate{E}_j &= \rate{C}_j I_E \\
  \text{MJ/yr} &= [\text{\$/yr}][\text{MJ/\$}] \nonumber
\end{align}
%
The subscript $j$ represents expenditures on non-energy items
in this framework: 
capital costs (subscript $cap$), 
maintenance and disposal activities (subscript $\md$), or 
other goods (subscript $o$).


%++++++++++++++++++++++++++++++
\subsection{Rebound effects}
\label{sec:rebound_effects}
%++++++++++++++++++++++++++++++

The four rebound effects of Fig.~\ref{fig:flowchart} 
(emplacement, substitution, income, and macro)
are discussed in subsections below.
In each subsection, we
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item define each rebound effect and
  
  \item develop mathematical rebound expressions.
    
\end{enumerate*}
%
Detailed derivations of all rebound expressions 
can be found in Appendix~\ref{sec:derivation}.
See, in particular, Tables~\ref{tab:empleffect}--\ref{tab:macroeffect}
which provide a parallel structure for energy and financial accounting.

Important quantities for the derivations are
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item direct and indirect energy consumption rates ($\rate{E}_{dir}$, $\rate{E}_{indir}$), 
  
  \item direct and indirect expenditure rates ($\rate{C}_{dir}$ and $\rate{C}_{indir}$), 
  
  \item the consumption rate of the energy service ($\rate{q}_s$), and
  
  \item the consumption rate of other goods ($\rate{C}_o$).
    
\end{enumerate*}
%
These important rebound quantities can be illustrated via
rebound path graphs.
(See Appendix~\ref{sec:graph_details} for 
detailed mathematical descriptions of rebound path graphs.)
Figs.~\ref{fig:ExampleEnergyPathGraph}--\ref{fig:ExamplePrefsPathGraph} show
notional rebound path graphs of energy consumption, expenditures, and preferences
for purposes of illustration.
The notional path graphs are not quantified; there is no scale on the axes.
Later (Section~\ref{sec:examples}), 
rebound path graphs (with scales) illustrate numerical examples.

Fig.~\ref{fig:ExampleEnergyPathGraph} shows a notional energy path graph, with 
the direct energy consumption rate ($\rate{E}_{dir}$) on the abscissa
and
the indirect energy consumption rate ($\rate{E}_{indir}$) on the ordinate.
Lines with negative slope through points 
$\circ$, $a$, $*$, $\wedge$, $-$, and $\sim$
indicate energy consumption isoquants
(direct and indirect) at each point.

A notional expenditure path graph is shown in Fig.~\ref{fig:ExampleCostPathGraph}, 
with 
the direct expenditure rate on the energy service ($\rate{C}_{dir}$) on the abscissa and 
the indirect expenditure rate ($\rate{C}_{indir}$) on the ordinate.
Lines with negative slope through points $\circ$ and $a$
indicate expenditure isoquants (direct and indirect).

A notional preferences path graph is shown in Fig.~\ref{fig:ExamplePrefsPathGraph}.
The indexed rate of energy service consumption ($\rate{q}_s/\rbempl{q}_s$) is shown in the abscissa, and
the indexed rate of other goods consumption ($\rate{C}_o/\rbempl{C}_o$) is shown on the ordinate.
Isoquants of indexed other goods and energy service consumption 
are shown as lines with negative slope. 
Indifference curves are denoted by \iicirc{} and \iibar{}. 
A ray from the origin through the $\wedge$ point is denoted \rr{}.

<<eeu_data, echo=FALSE>>=
# Load our test cases and perform rebound analyses.
rebound_data <- ReboundTools::load_eeu_data("data/eeu_data.xlsx")
rebound_results <- ReboundTools::rebound_analysis(rebound_data)
@


<<ExampleEnergyPathGraph,  echo=FALSE, warning=FALSE, fig.cap="Notional energy path.", fig.width=6, fig.height=4>>=
stage_size <- 10
orig_size <- stage_size
star_size <- stage_size
hat_size <- stage_size - 3
bar_size <- stage_size - 5
tilde_size <- stage_size - 5

stage_colour <- "black"
abcd_size <- 4
abcd_colour <- "darkgray"

annotation_angle <- -45.6
annotation_size <- 4
annotation_colour <- "black"

example_arrow_angle <- 19.0 * pi/180
example_arrow_size <- 0.5 # width

example_energy_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size, ~angle,
                                         1.01, 1.008, 'degree', 
                                           stage_colour, orig_size, 0,
                                         0.115, 1.008, 'a', 
                                           abcd_colour, abcd_size, 0,
                                         0.085, 0.973, 'b', 
                                           abcd_colour, abcd_size, 0,
                                         0.085, 0.95, '"*"', 
                                           stage_colour, star_size, 0,
                                         0.09, 0.935, 'c', 
                                           abcd_colour, abcd_size, 0,
                                         0.242, 0.923, '"^"', 
                                           stage_colour, hat_size, 0,
                                         0.295, 0.942, 'd', 
                                           abcd_colour, abcd_size, 0,
                                         0.295, 1.036, 'bold("_")', 
                                           stage_colour, bar_size, 0,
                                         0.29, 1.13, '"~"', 
                                           stage_colour, tilde_size, 0,
                                         0.04, 0.923, 'Hyperconservation', 
                                           annotation_colour, 
                                           annotation_size-1,
                                           annotation_angle,
                                         0.02, 1.043, 'Re[tot] == 0*"%"', 
                                           annotation_colour, 
                                           annotation_size, 
                                           annotation_angle,
                                         0.03, 1.005, 'Re[empl]', 
                                           annotation_colour,  
                                           annotation_size - 1, 
                                           annotation_angle + 90,
                                         0.21, 0.90, 'Re[sub]', 
                                           annotation_colour, 
                                           annotation_size - 1,
                                           annotation_angle + 90,
                                         0.39, 0.936, 'Re[inc]', 
                                           annotation_colour, 
                                           annotation_size, 
                                           annotation_angle + 90,
                                         0.68, 0.935, 'Re[macro]', 
                                           annotation_colour, 
                                           annotation_size, 
                                           annotation_angle + 90,
                                         0.754, 1.1, 'Re[tot] == 100*"%"', 
                                           annotation_colour, 
                                           annotation_size, 
                                           annotation_angle,
                                         0.95, 1.1, 'Backfire', 
                                           annotation_colour, 
                                           annotation_size, 
                                           annotation_angle)
example_Re_arrows <- tibble::tribble(~x, ~y, ~angle, ~radius, ~colour, ~size,
                                     # Re_empl arrow
                                     0.078, 1.01, example_arrow_angle, 
                                       -0.063, annotation_colour, example_arrow_size,
                                     # Re_sub arrow
                                     0.249, 0.904, example_arrow_angle, 
                                       0.04, annotation_colour, example_arrow_size,
                                     # Re_inc arrow
                                     0.327, 0.904, example_arrow_angle, 
                                       0.157, annotation_colour, example_arrow_size,
                                     # Re_macro arrow
                                     0.622, 0.904, example_arrow_angle, 
                                       0.146, annotation_colour, example_arrow_size) 
rebound_results %>% 
  ReboundTools::path_graphs(cases = "Example", 
                               graph_types = "Energy", 
                               indexed = TRUE) + 
  ggplot2::xlim(0, 1.1) +
  ggplot2::ylim(0.9, 1.15) +
  ggplot2::xlab(expression(dot(E)[dir] * " [MJ/year]")) +
  ggplot2::ylab(expression(dot(E)[indir] * " [MJ/year]")) +
  ggplot2::geom_spoke(data = example_Re_arrows,
                        mapping = ggplot2::aes(x = x,
                                               y = y,
                                               angle = angle,
                                               radius = radius,
                                               colour = colour),
                        arrow = ggplot2::arrow(length = ggplot2::unit(0.1,"cm"))) +
  ggplot2::geom_text(data = example_energy_labels,
                     mapping = ggplot2::aes(x = x,
                                            y = y,
                                            label = lab,
                                            colour = colour,
                                            size = size,
                                            angle = angle),
                     parse = TRUE) +
  MKHthemes::xy_theme() + 
  # remove axis labels and ticks
  ggplot2::theme(axis.text.x = ggplot2::element_blank(),
                 axis.ticks.x = ggplot2::element_blank(),
                 axis.text.y = ggplot2::element_blank(),
                 axis.ticks.y = ggplot2::element_blank(),
                 axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 6)))
@


<<ExampleCostPathGraph, echo=FALSE, fig.cap="Notional expenditure path.", fig.width=6, fig.height=4>>=
cost_line_angle <- -16.5
example_cost_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size, ~angle,
                                   1.01, 1.003, 'degree', 
                                     stage_colour, orig_size, 0,
                                   0.098, 1.003, 'a', 
                                     abcd_colour, abcd_size, 0,
                                   0.09, 0.972, 'b', 
                                     abcd_colour, abcd_size, 0,
                                   0.09, 0.9545, 'scriptstyle("*")', 
                                     stage_colour, star_size, 0,
                                   0.09, 0.936, 'c', 
                                     abcd_colour, abcd_size, 0,
                                   0.24, 0.938, '"^"', 
                                     stage_colour, hat_size, 0,
                                   0.283, 0.936, 'd', 
                                     abcd_colour, abcd_size, 0,
                                   0.243, 1.034, 'bold("_")',
                                     stage_colour, bar_size, 0,
                                   0.635, 1.02, 'Original~expenditure', 
                                     annotation_colour, annotation_size, cost_line_angle,
                                   0.55, 0.9825, 'After~expected~savings', 
                                     annotation_colour, annotation_size, cost_line_angle)

rebound_results %>% 
  ReboundTools::path_graphs(cases = "Example", 
                               graph_types = "Expenditure", 
                               indexed = TRUE) + 
  # ggplot2::xlim(0, 1.1) +
  # ggplot2::ylim(0.9995, 1.0005) +
  ggplot2::xlab(expression(dot(C)[dir] * " [$/year]")) +
  ggplot2::ylab(expression(dot(C)[indir] * " [$/year]")) +
  
  ggplot2::geom_text(data = example_cost_labels,
                     mapping = ggplot2::aes(x = x,
                                            y = y,
                                            label = lab,
                                            colour = colour,
                                            size = size,
                                            angle = angle),
                     parse = TRUE) +
  MKHthemes::xy_theme() + 
  # remove axis labels and ticks
  ggplot2::theme(axis.text.x = ggplot2::element_blank(),
                 axis.ticks.x = ggplot2::element_blank(),
                 axis.text.y = ggplot2::element_blank(),
                 axis.ticks.y = ggplot2::element_blank(),
                 axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 6)))
@


<<ExamplePrefsPathGraph, echo=FALSE, warning=FALSE, fig.cap="Notional preferences path.", fig.width=6, fig.height=4>>=
orig_line_label_size <- orig_size - 3
star_line_label_size <- star_size - 4
hat_line_label_size <- hat_size - 3
bar_line_label_size <- bar_size - 1
r_line_label_size <- abcd_size
i_line_label_size <- abcd_size
line_label_colour <- "darkgray"
  
labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size,
                          1.04, 1.005, 'degree', 
                            annotation_colour, orig_size,
                          1.09, 1.00, '","', 
                            annotation_colour, orig_size-3,
                          1.14, 1.0005, '"*"', 
                            annotation_colour, star_size,
                          0.7, 1.011, 'degree', 
                            line_label_colour, orig_line_label_size,
                          1.54, 0.97, 'degree',
                            line_label_colour, orig_line_label_size,
                          0.7, 0.996, '"*"', 
                            line_label_colour, star_line_label_size,
                          3.5, 0.981, '"*"', 
                            line_label_colour, star_line_label_size,
                          0.96, 0.98, 'c', 
                            abcd_colour, abcd_size,
                          2.27, 0.972, '"^"',  
                            annotation_colour, hat_size,
                          0.7, 0.989, '"^"',
                            line_label_colour, hat_line_label_size,
                          3.5, 0.974, '"^"', 
                            line_label_colour, hat_line_label_size,
                          2.52, 0.983, 'd', 
                            abcd_colour, abcd_size,
                          2.43, 1.087, 'bold("_")',  
                            annotation_colour, bar_size,
                          0.7, 1.09, '"_"',
                            line_label_colour, bar_line_label_size,
                          3.5, 1.075, '"_"',
                            line_label_colour, bar_line_label_size,
                          2.18, 0.97, 'r',
                            line_label_colour, r_line_label_size,
                          2.6, 1.15, 'r',  
                            line_label_colour, r_line_label_size,
                          0.75, 1.027, 'i*degree', 
                            line_label_colour, i_line_label_size,
                          3.4, 0.981, 'i*degree', 
                            line_label_colour, i_line_label_size,
                          0.75, 1.143, 'bar(i)', 
                            line_label_colour, i_line_label_size,
                          3.4, 1.084, 'bar(i)', 
                            line_label_colour, i_line_label_size,
                          )
rebound_results %>% 
  ReboundTools::path_graphs(cases = "Example", 
                               graph_types = "Preferences") + 
  ggplot2::xlim(0.7, 3.5) +
  ggplot2::ylim(0.97, 1.15) +
  ggplot2::geom_text(data = labels, 
                     mapping = ggplot2::aes(x = x, y = y, 
                                            label = lab, 
                                            colour = colour, 
                                            size = size), 
                     parse = TRUE) +
  MKHthemes::xy_theme() + 
  # remove axis labels and ticks
  ggplot2::theme(axis.text.x = ggplot2::element_blank(),
                 axis.ticks.x = ggplot2::element_blank(),
                 axis.text.y = ggplot2::element_blank(),
                 axis.ticks.y = ggplot2::element_blank(),
                 axis.title.x = ggplot2::element_text(margin = ggplot2::margin(t = 6)))
@

In the subsections that follow, the notional graphs
(Figs.~\ref{fig:ExampleEnergyPathGraph}--\ref{fig:ExamplePrefsPathGraph})
serve to illustrate the development of the rebound framework.
We begin with the emplacement effect.


%------------------------------
\subsubsection{\Empleffect}
\label{sec:empl_effect_main_paper}
%------------------------------

The emplacement effect (segments \circa{}, \ab{}, and \bstar{} 
in Figs.~\ref{fig:ExampleEnergyPathGraph} and~\ref{fig:ExampleCostPathGraph})
accounts for performance of the EEU only;
behavior changes are addressed later, 
in the substitution and income effects. 
The direct emplacement effects of the EEU include
device energy savings ($\Sdot$) and device energy cost savings ($\Delta \raempl{C}_s$),
on segments \circa{} in Figs.~\ref{fig:ExampleEnergyPathGraph} 
and~\ref{fig:ExampleCostPathGraph}, respectively.
The indirect effects of EEU emplacement are
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item changes in the embodied energy rate ($\Delta \raempl{E}_{emb}$)
        (segment \ab{} in Fig.~\ref{fig:ExampleEnergyPathGraph}), 
  
  \item changes in the capital expenditure rate ($\Delta \raempl{C}_{cap}$)
        (segment \ab{} in Fig.~\ref{fig:ExampleCostPathGraph}), and 
        
  \item changes in the maintenance and disposal energy and expenditure rates 
        ($\Delta \raempl{E}_{\md}$ and $\Delta \raempl{C}_{\md}$)
        (segments \bstar{} in Figs.~\ref{fig:ExampleEnergyPathGraph} and \ref{fig:ExampleCostPathGraph}).
    
\end{enumerate*}

The rate of energy savings
due to the direct emplacement effect  
($\Sdot$, segment \circa{} in Fig.~\ref{fig:ExampleEnergyPathGraph})
is given by

\begin{equation} \label{eq:S_dot_def}
  \Sdot \equiv \rbempl{E}_s - \raempl{E}_s = - \Delta \raempl{E}_s \; .
\end{equation}
%
Appendix~\ref{sec:Sdot} shows that $\Sdot$ can be rewritten conveniently as

\begin{equation} \label{eq:Sdot}
  \Sdot = \Sdoteqn \; .
\end{equation}

**** 
GS asks if this paragraph should be moved elsewhere.
****
Because behavior changes are not considered
in the direct emplacement effect,
actual and expected energy savings rates are identical, i.e.\ $\Sdot$.
By definition, then, the direct emplacement effect causes no rebound.
Thus, 

\begin{equation} \label{eq:Re_dempl0}
  Re_{dempl} = 0 \; .
\end{equation}
%
In the energy path graph of Fig.~\ref{fig:ExampleEnergyPathGraph}, 
point $a$ lies on the $Re_{tot} = 0\%$ line
indicating that the $Re_{tot} = 0\%$ line 
is the basis from which all rebound effects 
($Re_{empl}$, $Re_{sub}$, $Re_{inc}$, and $Re_{\macro}$)
are measured.
If rebound effects cause 
total energy demand to return to the original energy consumption level 
(negative sloping line through the $\circ$ point), 
all expected energy savings are taken back by rebound effects. 
Thus, the line of constant energy consumption through the $\circ$ point is labeled
$Re_{tot} = 100\%$.
Total rebound ($Re_{tot}$) is measured linearly between and beyond the
$Re_{tot} = 0\%$ and $Re_{tot} = 100\%$ lines, 
with decomposition to direct rebound in the $x$ direction and 
indirect rebound in the $y$ direction.
The region below and to the left of the $Re_{tot} = 0\%$ line
in Fig.~\ref{fig:ExampleEnergyPathGraph}
exhibits negative rebound, indicating hyperconservation.
The region above and to the right of the $Re_{tot} = 100\%$ line 
shows ``backfire,'' 
i.e.\ greater energy consumption after the EEU than before it. 

Although the direct emplacement effect does not cause rebound, 
Fig.~\ref{fig:ExampleEnergyPathGraph} shows that
indirect emplacement effects may cause rebound.
Indirect emplacement effects 
(segments \ab{} and \bstar{}
in Figs.~\ref{fig:ExampleEnergyPathGraph} and~\ref{fig:ExampleCostPathGraph}) 
account for the life cycle of the energy conversion device,
including energy embodied by manufacturing processes (subscript $emb$) and
maintenance and disposal activities (subscript $\md$).
In the notional energy path graph (Fig.~\ref{fig:ExampleEnergyPathGraph}), 
emplacement rebound is negative ($Re_{empl} < 0$),
because the upgraded device has a lesser
embodied energy rate ($\raempl{E}_{emb} < \rbempl{E}_{emb}$)
and a lesser maintenance and disposal expenditure rate ($\raempl{C}_{\md} < \rbempl{C}_{\md}$)
than the original device.
Fig.~\ref{fig:ExampleCostPathGraph} shows segments \ab{} and \bstar{}
moving in the negative direction,
consistent with a lower capital expenditure rate
($\raempl{C}_{cap} < \rbempl{C}_{cap}$) and 
a reduced maintenance and disposal expenditure rate
($\raempl{C}_{\md} < \rbempl{C}_{\md}$).

One of the unique features of this rebound framework
is that independent analyses of embodied energy and 
capital costs of the EEU are expected.
We note that the different terms 
(embodied energy rate, $\rate{E}_{emb}$, and
capital cost rate, $\rate{C}_{cap}$)
might seem to imply different processes, 
but they actually refer to the same emplacement effect, 
namely energy segment \ab{} and expenditure segment \ab{} 
in energy and expenditure path graphs
(Figs.~\ref{fig:ExampleEnergyPathGraph} and
\ref{fig:ExampleCostPathGraph}, respectively).
Purchasing an upgraded device
(which likely leads to $\rbempl{C}_{cap} \neq \raempl{C}_{cap}$)
will likely mean a changed embodied energy rate ($\rbempl{E}_{emb} \neq \raempl{E}_{emb}$) 
to provide the same energy service.
Our names for these aspects of rebound (embodied energy and capital cost)
reflect common usage 
in the energy and economics fields, respectively.
In the notional graphs of
Figs.~\ref{fig:ExampleEnergyPathGraph} and~\ref{fig:ExampleCostPathGraph}, 
embodied energy rates and capital cost rates
(represented by energy segment \ab{} and expenditure segment \ab{}, respectively) 
move in the same direction (both negative).
However, both segments \ab{} could move in the positive direction, or
they could move in opposite directions, 
depending on the results of the independent analyses for 
embodied energy and capital cost rates.

Consistent with the energy/exergy analysis literature, 
we define embodied energy 
to be the sum of all final energy (direct and indirect) 
consumed in the production of the energy conversion device.
Energy is embodied in the device within manufacturing and distribution supply chains
prior to consumer acquisition of the device.
No energy is embodied in the device while in service.
The EEU causes the embodied energy of the energy conversion device to change
from $\orig{E}_{emb}$ to $\aempl{E}_{emb}$.

However, for simplicity, we spread all embodied energy
over the lifetime of the device,
an equal amount assigned to each period.
(We later take the same approach to capital costs and
maintenance and disposal costs.)
A justification for spreading embodied energy purchase costs comes from considering
device replacements by many consumers across several years.
In the aggregate, evenly-spaced (in time) replacements
work out to the same embodied energy in every period.

Thus, we allocate embodied energy over the life of the original and upgraded devices
($\bempl{t}_{\life}$ and $\aempl{t}_{\life}$, respectively)
to obtain embodied energy rates, such that
$\rbempl{E}_{emb} = \bempl{E}_{emb} / \bempl{t}_{\life}$
and 
$\raempl{E}_{emb} = \aempl{E}_{emb} / \aempl{t}_{\life}$.
The change in embodied final energy due to the EEU (expressed as a rate) is given by
$\raempl{E}_{emb} - \rbempl{E}_{emb}$
and is shown as segment \ab{} in Fig.~\ref{fig:ExampleEnergyPathGraph}.
The expression for embodied energy rebound is derived in 
Appendix~\ref{sec:Re_emb} to be

\begin{equation} \label{eq:Re_emb}
  Re_{emb} = \Reembeqn{} \; .
\end{equation}

Embodied energy rebound can be either positive or negative, depending on 
the sign of the term
$(\aempl{E}_{emb}/\bempl{E}_{emb})(\bempl{t}_{\life}/\aempl{t}_{\life}) - 1$.
Rising energy efficiency can be associated with increased device complexity,
additional energy consumption in manufacturing, and
more embodied energy,
such that $\aempl{E}_{emb} > \bempl{E}_{emb}$ and $Re_{emb} > 0$,
all other things being equal.
However, if the upgraded device has longer life than the original device
($\aempl{t}_{\life} > \bempl{t}_{\life}$),
$\raempl{E}_{emb} - \rbempl{E}_{emb}$ could be negative,
meaning that the upgraded device has a lower embodied energy rate than the original device,
as shown by point 2 being below point 1 
in the notional energy path graph of Fig.~\ref{fig:ExampleEnergyPathGraph}.
See Appendix~\ref{sec:Re_emb} for details.

In addition to embodied energy, 
indirect emplacement effect rebound accounts for
energy demanded by maintenance and disposal~($\md$) activities
(segments \bstar{} in Figs.~\ref{fig:ExampleEnergyPathGraph} and~\ref{fig:ExampleCostPathGraph}).
Maintenance expenditures are typically modeled as a per-year expense, a rate (e.g., $\rbempl{C}_m$).
Disposal costs (e.g., $\bempl{C}_d$) are one-time expenses incurred 
at the end of the useful life of the energy conversion device.
Like embodied energy, we spread disposal costs across the lifetime 
of the original and upgraded devices ($\bempl{t}_{\life}$ and $\aempl{t}_{\life}$, respectively)
to form expenditure rates such that 
$\rbempl{C}_{\md} = \rbempl{C}_m + \bempl{C}_d/\bempl{t}_{\life}$
and
$\raempl{C}_{\md} = \raempl{C}_m + \aempl{C}_d/\aempl{t}_{\life}$.

For simplicity, we assume that maintenance and disposal
expenditures imply energy consumption
elsewhere in the economy at its overall energy intensity~($I_E$).
Therefore, the change in energy consumption rate caused by a change 
in maintenance and disposal expenditures
is given by $\Delta \raempl{C}_{\md} I_E = (\raempl{C}_{\md} - \rbempl{C}_{\md}) I_E$, 
shown as segment \bstar{} in Fig.~\ref{fig:ExampleEnergyPathGraph}.
Rebound from maintenance and disposal activities 
is given by 

\begin{equation} \label{eq:Re_md}
  Re_{\md} = \ReOMdeqn{} \; .
\end{equation}
%
See Appendix~\ref{sec:Re_OMd} for details of the derivation.


%------------------------------
\subsubsection{\Subeffect}
\label{sec:sub_effect_main_paper}
%------------------------------

Neoclassical consumer theory distinguishes between
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item substituting energy service consumption for
        other goods consumption due to the lower post-EEU price of the energy service 
        (the substitution effect) and
  
  \item re-spending the higher real income (the income effect). 
    
\end{enumerate*}
%
This section develops mathematical expressions 
for substitution effect rebound ($Re_{sub}$).
(The next section addresses income effect rebound, $Re_{inc}$.)
The substitution effect alters compensated demand, 
the expenditure minimizing consumption bundle for
a given level of payoff (or utility). 
It involves
%
\begin{enumerate*}[label={(\roman*)}]

  \item an increase in consumption of the energy service,
        a direct substitution effect (subscript $dsub$) and

  \item a compensating decrease in consumption of other goods,
        an indirect substitution effect (subscript $isub$).

\end{enumerate*}
%
Thus, two terms comprise substitution effect rebound,
direct substitution rebound ($Re_{dsub}$) and
indirect substitution rebound ($Re_{isub}$).
The substitution effect is shown by segments
\starc{} (indirect component) and \chat{} (direct component) 
in Figs.~\ref{fig:ExampleEnergyPathGraph}--\ref{fig:ExamplePrefsPathGraph}.

The substitution effect is best described 
with reference to a preferences path graph (Fig.~\ref{fig:ExamplePrefsPathGraph}).
Prior to the EEU, the consumption basket (of the energy service and other goods)
is represented by the $\circ$ point, and 
the line of constant expenditure, the budget constraint, is \circcirc{}.
The \circcirc{} line is tangent to the lower indifference curve 
(\iicirc{}) at point $\circ$, the optimal consumption
bundle prior to device upgrade.
After emplacement of the more-efficient device
(but before the substitution effect), 
the price of the energy service decreases ($\aempl{p}_s < \bempl{p}_s$),
pivoting the budget constraint outward, to \starstar{}.
By definition, the substitution effect indicates the optimal
consumption bundle at the $\wedge$ point,
after a compensation variation has tightened the budget constraint to \hathat{} 
in Fig.~\ref{fig:ExamplePrefsPathGraph}.
The $\wedge$ point shows consumption with new prices and utility
at the level prior to the EEU,
taking advantage of the lower energy service price, 
hence favoring energy service consumption (because it is now less expensive)
at the expense of other goods consumption (which are now relatively more expensive).

The substitution effect can be decomposed into 
indirect (the decrease in other goods consumption, segment \starc{}) 
and 
direct (the increase in energy service consumption, segment \chat{})
components.
The impact of the substitution effect on energy consumption rates and expenditure rates
can be seen in Figs.~\ref{fig:ExampleEnergyPathGraph}
and~\ref{fig:ExampleCostPathGraph}, respectively.

An approximate method
is often used in the literature
(e.g., see \citet{Borenstein:2015aa}
**** Does Borenstein actually use this approach? 
I couldn't find it ---MKH
****)
for determining 
the post-substitution effect point
and therefore $Re_{dsub}$ and $Re_{isub}$.
The approximate method assumes that 
the compensated energy service price elasticity of energy service consumption ($\eqspsC$) and
the compensated energy service price elasticity of other goods consumption ($\eqopsC$)
are constant along an indifference curve.
These assumptions are approximations 
that are unsuitable for non-marginal price changes 
($\aempl{p}_s <\!\!< \orig{p}_s$). 
Appendix~\ref{sec:Re_sub} contains details of the approximate method.

Here, we present an exact method that allows 
the energy service price elasticity of energy service consumption ($\eqspsC$) and
the energy service price elasticity of other goods consumption ($\eqopsC$)
to vary along an indifference curve. 
We use a fully specified 
constant elasticity of substitution (CES) utility model,
which allows the exact, direct calculation
of the utility maximizing consumption bundle for any constraint.
The utility model describes the device owner's behavior as

\begin{equation} \label{eq:ces_utility}
  \frac{\rate{u}}{\rbempl{u}} = \cesutility{} \; .
\end{equation}
%
The device owner's utility
(relative to the original condition, $\rate{u}/\rorig{u}$)
is determined by
the consumption rate of the energy service ($\rate{q}_s$) and
the consumption rate of other goods and services ($\rate{C}_o$).
The share parameter ($\fCs$) is taken from the orignal (pre-EEU) consumption basket.
The exponent $\rho$ is calculated from the elasticity of substitution ($\sigma$) 
as $\rho \equiv \frac{\sigma - 1}{\sigma}$.
See Appendix~\ref{sec:utility_and_elasticities}
for further details of the CES utility model.

Direct substitution effect rebound ($Re_{dsub}$) is given by

\begin{equation} \label{eq:Re_dsub_def}
  Re_{dsub} = \frac{\Delta \rasub{E}_s}{\Sdot} \; ,
\end{equation}
%
which can be rearranged to

\begin{equation} \label{eq:Re_dsub_prelim}
  Re_{dsub} = \frac{\frac{\rasub{q}_s}{\rbempl{q}_s} - 1}{\frac{\amacro{\eta}}{\bempl{\eta}} - 1} \; .
\end{equation}

Indirect substitution effect rebound ($Re_{isub}$) is given by

\begin{equation} \label{eq:Re_isub_def}
  Re_{isub} = \frac{\Delta \rasub{C}_o I_E}{\Sdot} \; ,
\end{equation}
%
which can be rearranged to 

\begin{equation} \label{eq:Re_isub_prelim}
  Re_{isub} = \frac{\frac{\rasub{C}_o}{\rorig{C}_o} - 1}{\etaratiostacked - 1} \; 
                          \etaratiostacked \; 
                          \frac{\rbempl{C}_o I_E}{\rbempl{E}_s} \; .
\end{equation}

To find the post-substitution effect point ($\wedge$),
we solve for the location on the \iicirc{} indifference curve
where its slope is equal to the slope of the
\starstar{} expenditure line.
The results are

\begin{equation} \label{eq:q_s_solution}
  \frac{\rasub{q}_s}{\rbempl{q}_s} = \qssolution{}
\end{equation}
%
and

\begin{equation} \label{eq:C_o_solution}
  \frac{\rasub{C}_o}{\rbempl{C}_o} = \Cosolution{} \; .
\end{equation}

Eq.~(\ref{eq:q_s_solution}) can be substituted directly
into Eq.~(\ref{eq:Re_dsub_prelim})
to obtain an expression for direct substitution rebound ($Re_{dsub}$)
via the CES utility model.

\begin{equation} \label{eq:Re_dsub_CES}
  Re_{dsub} = \RedsubCES{}
\end{equation}

Eq.~(\ref{eq:C_o_solution}) can be substituted directly
into Eq.~(\ref{eq:Re_isub_prelim})
to obtain an expression for direct substitution rebound ($Re_{isub}$)
via the CES utility model.

\begin{equation} \label{eq:Re_isub_CES}
  Re_{isub} = \ReisubCES{}
\end{equation}

See Appendix~\ref{sec:Resub_exact_method} for details
of the derivations of Eqs.~(\ref{eq:Re_dsub_prelim}), 
(\ref{eq:Re_isub_prelim}), and 
(\ref{eq:q_s_solution})--(\ref{eq:Re_isub_CES}).


%------------------------------
\subsubsection{\Inceffect}
\label{sec:inc_effect_main_paper}
%------------------------------

The income rate of the device owner is $\rbempl{M}$, 
which remains unchanged across the rebound effects, 
such that
$\rbempl{M} = \raempl{M} = \rasub{M} = \rainc{M} = \ramacro{M}$.
Freed cash from the EEU is given by Eq.~(\ref{eq:G_dot})
as $\rate{G} = p_E \Sdot$. 
In combination, the emplacement effect and 
the substitution effect leave the device owner with
\emph{net} income ($\rasub{N}$) from the EEU,
as shown in Eq.~(\ref{eq:N_dot_after_sub}).
Derivations of expressions for freed cash from the 
emplacement effect ($\rate{G}$)
and net savings after the substitution effect ($\rasub{N}$)
are presented in Tables~\ref{tab:empleffect} and~\ref{tab:subeffect}.
Rebound from the income effect quantifies the rate of additional energy demand 
that arises when the energy conversion device owner spends net
savings from the EEU
(segments \hatd{} and \dbar{} in 
Figs.~\ref{fig:ExampleEnergyPathGraph}--\ref{fig:ExamplePrefsPathGraph}).

In this framework,
the income effect must satisfy several constraints.
The first constraint is that net savings ($\rasub{N}$) should be completely re-spent.
I.e, the income effect should satisfy the budget constraint
such that net savings is zero after
the income effect ($\rainc{N} = 0$).
This constraint can be seen in 
expenditure path graphs (e.g., Fig.~\ref{fig:ExampleCostPathGraph})
where the post-income-effect point ($-$) returns to the original expenditure line.
See Appendix~\ref{sec:proof_income_elasticities}
for a mathematical proof that the income preference equations below
(Eqs.~(\ref{eq:qsrat_eqsM}) and~(\ref{eq:qorat_eqoM}))
satisfy the first constraint.

The second constraint is that net savings should be re-spent on only 
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item additional spending on the energy service ($\rainc{q}_s > \rbinc{q}_s$, segment \hatd{}) and
  
  \item additional spending on other goods ($\rainc{q}_o > \rbinc{q}_o$, segment \dbar{}).
    
\end{enumerate*}
%
This constraint is satisfied by construction below.

The third constraint is that 
additional spending on the energy service 
and other goods 
should be allocated in the same proportion as 
post-substitution-effect expenditures on the energy service and other goods.
Thus,
although spending on both the energy service and other goods increases across the income effect,
the proportion of spending on the energy service and other goods
should not change across the income effect.
This constraint is also satisfied by construction below, 
particularly via an effective income ($\Mdothatprime$). 
Proof that this constraint is satisfied can be seen in 
preference path graphs
where the pre- and post-income-effect points ($\wedge$ and $-$, respectively)
lie along ray \rr{}.
(Ray \rr{} is formed by drawing a line from the origin 
through the post-substitution-effect point ($\wedge$) and beyond.
See Fig.~\ref{fig:ExamplePrefsPathGraph}.)

We next show expressions for 
direct and indirect income effect rebound.

%..............................
\paragraph{Direct income effect} 
\label{sec:direct_income_effect}
%..............................

The income elasticity of energy service consumption ($\eqsM$)
quantifies the amount of net savings spent 
on more of the energy service ($\rainc{q}_s > \rbinc{q}_s$).
(See Appendix~\ref{sec:utility_and_elasticities} 
for additional information about elasticities.)
Spending of net savings on the energy service 
leads to direct income effect rebound ($Re_{dinc}$).

The ratio of rates of energy service consumed across the income effect is given by

\begin{equation} \label{eq:qsrat_eqsM}
  \incprefseqn \; .
\end{equation}
%
Homotheticity means that $\eqsM = 1$.
The increased consumption rate of the energy service is 
represented by segments \hatd{} 
in Figs.~\ref{fig:ExampleEnergyPathGraph}--\ref{fig:ExamplePrefsPathGraph}.

Effective income ($\Mdothatprime$) is given by 

\begin{equation} \label{eq:effective_income}
  \effinceqn{} \; .
\end{equation}
%
For the purposes of the income effect, 
the effective income equation (Eq.~(\ref{eq:effective_income})) 
adjusts income ($\rorig{M}$) to account for 
%
\begin{enumerate*}[label={(\roman*)}]
	
  \item sunk costs ($\raempl{C}_{cap}$ and $\raempl{C}_{\md}$) and
        freed cash ($\rate{G}$)
        from the emplacement effect and
  
  \item expenditure adjustments 
        ($p_E \Delta \rasub{E}_s$ and $\Delta \rasub{C}_o$)
        from the substitution effect. 
    
\end{enumerate*}

As shown in Table~\ref{tab:inceffect}, direct income rebound is defined as

\begin{equation} \label{eq:Re_dinc_def}
  Re_{dinc} \equiv \frac{\Delta \rainc{E}_s}{\Sdot} \; .
\end{equation}
%
After much substitution, rearranging, and canceling of terms (see Appendix~\ref{sec:Re_dinc}), 
the expression for direct income rebound is

\begin{equation} \label{eq:Re_dinc}
  Re_{dinc} = \Redinceqnexact{} \; .
\end{equation}
%
If there is no net savings after the substitution effect ($\rasub{N} = 0$), 
direct income effect rebound is zero ($Re_{dinc} = 0$), as expected.
See Appendix~\ref{sec:Re_inc} for details of the derivation
of income effect rebound.


%..............................
\paragraph{Indirect income effect} 
\label{sec:indirect_income_effect}
%..............................

The income elasticity of other goods consumption ($\eqoM$)
quantifies the amount of net savings spent 
on additional other goods ($\rainc{q}_o > \rbinc{q}_o$).
Spending of net savings on other goods and services
leads to indirect income effect rebound ($Re_{iinc}$).

The ratio of rates of other goods consumed across the income effect is given by

\begin{equation} \label{eq:qorat_eqoM}
  \incprefoeqn \; 
\end{equation}
%
and is represented by segments \dbar{} 
in Figs.~\ref{fig:ExampleEnergyPathGraph}--\ref{fig:ExamplePrefsPathGraph}.
Under the assumption that prices of other goods are exogenous
(see Appendix~\ref{sec:other_goods_expenditures}), 
the ratio of rates of other goods consumption ($\frac{\rasub{q}_o}{\rorig{q}_o}$)
is equal to the ratio of rates of other goods expenditures ($\frac{\rasub{C}_o}{\rorig{C}_o}$)
such that 

\begin{equation} \label{eq:Corat_eqoM}
  \frac{\rasub{C}_o}{\rorig{C}_o} = \left( 1 + \frac{\rasub{N}}{\Mdothatprime} \right)^{\eqoM} \; .
\end{equation}
%
Homotheticity means that $\eqoM = 1$.
As shown in Table~\ref{tab:inceffect}, indirect income rebound is defined as

\begin{equation} \label{eq:Re_iinc_def}
  Re_{iinc} \equiv \frac{\Delta \rainc{C}_o I_E}{\Sdot} \; .
\end{equation}
%
After much substitution, rearranging, and canceling of terms (see Appendix~\ref{sec:Re_iinc}), 
the expression for indirect income rebound is

\begin{equation} \label{eq:Re_iinc}
  Re_{iinc} = \Reiinceqnexact{} \; .
\end{equation}
%
See Appendix~\ref{sec:Re_inc} for details of the derivation
of income effect rebound.


%------------------------------
\subsubsection{\Macroeffect}
\label{sec:macro_effect_main_paper}
%------------------------------

The previous rebound effects
(emplacement effect, substitution effect, and income effect)
are microeconomic in nature.
**** Revisit this statement after we finalize our topology.---MKH ****
Like other factor-augmenting technical change, 
energy-augmenting technical change can also have
macroeconomic repercussions. It reduces production 
costs and thereby enables more efficient
production (process innovation) that typically results in growth.
Additionally, as \citet{VanBenthem2015} notes, cheaper 
energy services could facilitate the development and 
deployment of new products (product innovation),
an important driver of rising aggregate demand \citep{Szostack1995}. 
The upshot is that while energy efficiency is higher, the more 
efficient economy is growing more than one without the improvement,
taking back part of the expected energy savings, producing
macro rebound effects. Often this kind of rebound effect 
is subdivided into
components that distinguish scale, structural change, employment 
and investment effects, as well as further price effects
\citep{Brockway2021,Colmenares2020}. Here we group all of 
these effects under the label macro rebound effect. 

The macro effect is just one instance of the phenomenon
that reducing the need for an input at the micro level can lead 
to important and surprising counter-tendencies in the aggregate
demand for that input.
Consider labor productivity: it has risen 20-fold
in Western Europe and the U.S.\ since 1820 \citep{Maddison:2001aa}, 
and yet today these countries employ many more workers,
as the affluent populations demand more goods and services, and productivity
gains have led to innumerable new products.
The same holds for energy.
While energy efficiency at the device-level has climbed 
over the past centuries, energy consumption at the macro level 
has also risen \citep{Fouquet2014}.
It is important to recognize the generality of this result.
+++ here possible about th 69 inputs, and the long run growth
in iron demand -- GS+++
Typically the focus is on the effects on output of factor-augmenting
technical change. But once expected savings of that factor are of interest, 
all factor-augmenting technical change that accelerates economic 
growth can be analyzed in terms of its contribution to rebound 
relative to counterfactual scenario of lower growth.

To operationalize this macro effect, that ultimately leads to 
higher incomes and spending on goods and energy services, we scale
the net savings~($\rasub{N}$) gained by device owners at the micro level.
As argued by \citet{Antal:2014aa}, it is reasonable to assume that
net savings ($\rasub{N}$) is spent in the economy at the average 
energy intensity of the economy ($I_E$).

Scaling from net savings ($\rasub{N}$) at the device level
to productivity-driven growth at the macro level is an unexplored area.
In the absence of better information,
we express this scaling simply by a macro factor ($k$)
with $k \ge 0$ expected.
$k = 0$ means there is no macroeconomic productivity boost
resulting from the energy efficiency upgrade.
$k > 0$ means that productivity-driven macroeconomic growth has occurred
with consequent implications for additional energy consumption at the macro level.
**** MKH to check this GS sentence: 
In particular, if $k = 1$ and net income was 0.5 per cent of GDP, 
instead of respending only 0.1 per cent of GDP, respending 
to the tune of 0.2 per cent of GDP would occur, and thus GDP 
would grow by 0.1 per cent. This should not be confused with 
a ``multiplier'' from Keynesian economics, on which more in the discussion.

As shown in Table~\ref{tab:macroeffect}, 
macro rebound is given by

\begin{equation} \label{eq:Re_macro_def}
  Re_{\macro} = \frac{k \rbinc{N} I_E}{\Sdot} \; .
\end{equation}
%
Macro effects are shown as segment \bartilde{}
in Fig.~\ref{fig:ExampleEnergyPathGraph}.
After some algebra (see Appendix~\ref{sec:Re_macro}), 
we arrive at an expression for macro effect rebound:

\begin{equation} \label{eq:Re_macro}
  Re_{\macro} = \Remacroeqn{} \; .
\end{equation}
%

%++++++++++++++++++++++++++++++
\subsection{Rebound sum}
\label{sec:total_rebound_main_paper}
%++++++++++++++++++++++++++++++

In the comprehensive framework,
the sum of all rebound emerges from the four rebound effects
(emplacement effect, substitution effect, income effect, and macro effect).
Macro effect rebound~($Re_{\macro}$, Eq.~(\ref{eq:Re_macro}))
is expressed in terms of other rebound effects.
(Derivation details can be found in Appendix~\ref{sec:total_rebound}.)
After algebra and canceling of terms,
we find
%
\begin{align} \label{eq:Re_tot}  
  Re_{tot} = \; \Retoteqn{} \; .
\end{align}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Calculations: two examples}
\label{sec:examples}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Section 3 refs to add
Possibly include in section 3 calcs (for own-price elasticities) 
and/or section 4 discussion
\citet{Mills2014},
\citet{Saunders2012},
\citet{Schleich2014},

Section 3 ref to add, at place where elasticity estimates 
for case study examples are given.
\citet{Gillingham:2020aa},

Section 3 refs to add (or appendix D)
Text from Gregor email, need to translate into paper
Discharging of action item CES utility - is it novel?

%Well, I havent seen anyone use CES utility fitted 
%to an actual two sector model. 
%Hart (2018, attached) writes "the same goods are demanded 
%by consumers based on nested CES utility functions 
%about Broberg (2015, attached), 
%but thats not clear from the Broberg paper. 

%Moshiri (2017) use the almost idea demand system 
%which derives demand from a cost function - 
%not something Ive got any background in, 
%as Ive noted numerous times, 
%so maybe that might have been a better approach. 
%Li (2018) discusses who else uses these almost ideal demand system approaches.

%I think our approach is novel in the sense that we start from a direct utility,
%not cost function, and optimize instead of just postulate elasticities. 
%To me, the main novelty lies in the fact that we can therefore draw 
%the indifference curves rigorously and compute exact, 
%not just approximate changes. 
%I think thats something to highlight. 
%But I havent had a chance to study the Moshiri (2017) appendix B 
%that might give a better picture of whether others can do that or not. 

\citet{Broberg2015},
\citet{Hart2018},
\citet{Li2018},
\citet{Moshiri2017},

To demonstrate application of the 
rebound analysis framework developed in Section~\ref{sec:framework},
we select two case studies:
energy efficiency upgrades for an automobile and an electric lamp.
We first collect parameter values
for the equations for
eight rebound components:
$Re_{dempl}$ (Eq.~(\ref{eq:Re_dempl0})),
$Re_{emb}$ (Eq.~(\ref{eq:Re_emb})),
$Re_{\md}$ (Eq.~(\ref{eq:Re_md})),
$Re_{dsub}$ (Eqs.~(\ref{eq:Re_dsub_prelim} and~\ref{eq:q_s_solution})),
$Re_{isub}$ (Eq.~(\ref{eq:Re_isub_prelim} and~\ref{eq:C_o_solution})),
$Re_{dinc}$ (Eq.~(\ref{eq:Re_dinc})),
$Re_{iinc}$ (Eq.~(\ref{eq:Re_iinc})), and
$Re_{\macro}$ (Eq.~(\ref{eq:Re_macro})).
The total rebound sum ($Re_{tot}$)
is given by the sum of the above components,
which can also be checked against Eq.~(\ref{eq:Re_tot}).
 

%++++++++++++++++++++++++++++++
\subsection{Case 1: Automobile}
\label{sec:car_example}
%++++++++++++++++++++++++++++++

<<CarPrintableNumbers, echo=FALSE>>=
val_to_string <- function(case, val, to_perc = FALSE, scale = 1, digits = 1, format = "f", big.mark = ",") {
  val <- rebound_results %>% 
    dplyr::filter(.data[[ReboundTools::eeu_base_params$case]] == case) %>% 
    magrittr::extract2(val) %>% 
    magrittr::multiply_by(scale)
  if (to_perc) {
    val <- val * 100
  }
  val %>% 
    formatC(digits = digits, format = format, big.mark = big.mark)
}
# Parameters for first table
mpg_worse <- val_to_string(case = "Car", val = ReboundTools::orig_vars$eta_engr_units_orig, digits = 0)
mpg_better <- val_to_string(case = "Car", val = ReboundTools::star_vars$eta_engr_units_star, digits = 0)
C_dot_cap_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$C_dot_cap_orig, digits = 0)
C_dot_cap_star_car_char <- val_to_string(case = "Car", val = ReboundTools::star_vars$C_dot_cap_star, digits = 0)
t_own_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$t_own_orig, digits = 0)
t_own_star_car_char <- val_to_string(case = "Car", val = ReboundTools::star_vars$t_own_star, digits = 0)
t_life_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$t_life_orig, digits = 0)
t_life_star_car_char <- val_to_string(case = "Car", val = ReboundTools::star_vars$t_life_star, digits = 0)
E_emb_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$E_emb_orig, digits = 0)
E_emb_star_car_char <- val_to_string(case = "Car", val = ReboundTools::star_vars$E_emb_star, digits = 0)
C_dot_md_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$C_dot_md_orig, digits = 0)
C_dot_md_star_car_char <- val_to_string(case = "Car", val = ReboundTools::star_vars$C_dot_md_star, digits = 0)

# Parameters for second table
q_dot_s_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$q_dot_s_orig, digits = 0)
M_dot_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$M_dot_orig, digits = 2)
p_E_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::eeu_base_params$p_E_engr_units, digits = 2)
f_Cs_orig_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$f_Cs_orig, digits = 3)
k_car_char <- val_to_string(case = "Car", val = ReboundTools::eeu_base_params$k, digits = 1)

# Parameters for elasticity table
e_qs_ps_UC_car_char <- val_to_string(case = "Car", val = ReboundTools::eeu_base_params$e_qs_ps_UC, digits = 1)
e_qs_ps_C_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$e_qs_ps_C, digits = 3)
e_qo_ps_C_car_char <- val_to_string(case = "Car", val = ReboundTools::orig_vars$e_qo_ps_C, digits = 3)
e_qs_M_car_char <- val_to_string(case = "Car", val = ReboundTools::eeu_base_params$e_qs_M, digits = 1)
e_qo_M_car_char <- val_to_string(case = "Car", val = ReboundTools::eeu_base_params$e_qo_M, digits = 1)

# Parameters for discussion
Re_dempl_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_dempl, to_perc = TRUE, digits = 1)
Re_emb_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_emb, to_perc = TRUE)
Delta_E_dot_emb_star_car_char <- val_to_string(case = "Car", val = ReboundTools::Delta_vars$Delta_E_dot_emb_star, digits = 0)
Re_md_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_md, to_perc = TRUE, digits = 1)
Re_dsub_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_dsub, to_perc = TRUE)
Re_isub_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_isub, to_perc = TRUE)
Delta_C_dot_o_hat_car_char <- val_to_string(case = "Car", val = ReboundTools::Delta_vars$Delta_C_dot_o_hat, digits = 2)
Re_dinc_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_dinc, to_perc = TRUE)
Re_iinc_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_iinc, to_perc = TRUE)
N_dot_hat_car_char <- val_to_string(case = "Car", val = ReboundTools::hat_vars$N_dot_hat, digits = 2)
Re_macro_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_macro, to_perc = TRUE)
@



For the first example, 
we consider the purchase of a more fuel efficient car (Ford Fusion Energi), 
versus the incumbent (Ford Fusion SE). 
The cars are matched as closely as possible, 
except for the inclusion of an electric battery 
in the gas-electric hybrid Energi car.  
The automobile case study has a very large
initial capital investment
and the long-term benefit of decreased direct energy costs. 


%------------------------------
\subsubsection{Input parameters} 
\label{sec:Car_input_data}
%------------------------------

We require four sets of data. 
First, the basic car parameters are summarized 
in Table~\ref{tab:car_parameters}.
Second, we require several general parameters, 
mainly relating to the U.S.\ economy and personal finances 
of the average U.S.\ citizen. 
The parameters and their values used in the study 
are given in Table~\ref{tab:car_economic_parameters}.
Third, we require elasticity parameters, 
as given in Table~\ref{tab:car_elasticity_parameters}.
Fourth, armed with the parameter values from 
Tables~\ref{tab:car_parameters}--\ref{tab:car_elasticity_parameters}, 
and the equations of Section~\ref{sec:framework},
we calculate important values at each rebound stage,
as shown below in Table~\ref{tab:car_stages_table}.


% Reduce spacing between table rows henceforth.
\renewcommand{\arraystretch}{0.6}

\begin{landscape}
\begin{table}
\begin{center}
\caption{Car example: Vehicle parameters.} 
\label{tab:car_parameters}
\begin{tabular}{ r c c l }
  \toprule
    Description                  & Ford Fusion & Ford Fusion & Data sources and notes\\ 
    Parameters [units]                                & (gasoline) & (hybrid EV) &  \\
  \midrule
  Fuel efficiency                           & \Sexpr{mpg_worse} & \Sexpr{mpg_better} & Combined cycle mpg value taken from \citet{Car_Connection:2020}, \\
  $\bempl{\eta}$, $\amacro{\eta}$ [mpg]              &           &          & Turbo Premium Unleaded for Titanium FWD model with Intercooled  \\
                                                    &           &          & I-4, 2.0 L engine. \\
                                                    &           &          & Combined cycle mpg value taken from \citet{Car_Connection:2020},\\
                                                    &           &          & for Titanium FWD model with Gas/Electric I-4, 2.0 L engine. \\
  \midrule
   Capital expenditure rate      & \Sexpr{C_dot_cap_orig_car_char}     & \Sexpr{C_dot_cap_star_car_char}    & Seven year annual, averaged capital costs = purchase + finance costs \\
   $\rbempl{C}_{cap}$, $\raempl{C}_{cap}$ [\$/year] &           &          & -- resale value (purchase -- depreciation). Fusion gasoline costs from \\
                                                    &           &          & \citet{Edmunds:2019_gasoline_fusion}. Fusion Energi car costs from \citet{Edmunds:2019_energi_fusion}. \\
 \midrule
   Ownership duration            & \Sexpr{t_own_orig_car_char}  & \Sexpr{t_own_star_car_char}  & U.S.\ car ownership (from new) length taken from \citet{BusinessWire:2015}, \\
   $\bempl{t}_{own}$, $\aempl{t}_{own}$ [years]     &           &          & and has risen from 52 months (2005) to 79 months (2015), so assumed as \\
                                                    &           &          & 84 months in 2019 (7 years) for our example. \\
 \midrule
   Lifespan                     & \Sexpr{t_life_orig_car_char}  & \Sexpr{t_life_star_car_char} & Lifetime taken as 14 years, based on 13--17 years for U.S.\ cars \\
   $\bempl{t}_{\life}$, $\aempl{t}_{\life}$ [years] &           &          & from \citet{Berla:2016} and 14 years for UK cars from \\
                                                    &           &          & \citet{SMMT:2020}. \\
   \midrule
   Embodied energy             & \Sexpr{E_emb_orig_car_char}    & \Sexpr{E_emb_star_car_char}   & 34,000 MJ for gasoline car taken from \\
   $\bempl{E}_{emb}$, $\aempl{E}_{emb}$ [MJ]        &           &          & \citet{Argonne_National_Laboratory:2010}. \\
                                                    &           &          & We assume an additional 6,000 MJ added for Hybrid Electric Vehicle (HEV) \\
                                                    &           &          & battery, as HEV typically 10--25\% of total LCA energy of vehicle  \\
                                                    &           &          & manufacture. Battery lifetime assumed same as car lifetime, based on \\
                                                    &           &          & \citet{nordelof2014environmental}, and \citet{onat2015conventional}. \\
 \midrule
  Maintenance and disposal expenditure rate  & \Sexpr{C_dot_md_orig_car_char}  & \Sexpr{C_dot_md_star_car_char}    & Seven year annual, averaged maintenance costs = sum of insurance, \\
  $\rbempl{C}_{\md}$, $\raempl{C}_{\md}$ [\$/year]  &           &          & maintenance, repairs, taxes, and fees (excluding financing, depreciation, fuel). \\
                                                    &           &          & Fusion gasoline car maintenance costs from \citet{Edmunds:2019_gasoline_fusion}. \\
                                                    &           &          & Fusion Energi maintenance costs from \citet{Edmunds:2019_energi_fusion}. \\
  \bottomrule
\end{tabular}
\end{center}
\end{table}
\end{landscape}





\begin{landscape}
\begin{table}
\begin{center}
\caption{Car example: Economic parameters.}
\label{tab:car_economic_parameters}
\begin{tabular}{ r c l }
  \toprule
  Description & Value & Data sources and notes \\ 
  Parameter [units] & & \\
  \midrule
  Distance driven prior to upgrade   & \Sexpr{q_dot_s_orig_car_char}        & Average U.S.\ vehicle miles/year, taken from \citet{Car_Insurance:2019}.  \\
  $\rbempl{q}_s$ [miles/year]                               &               & This is slightly higher than the average driver miles/year (13,476) from \\
                                                            &               & \citet{US_DoT:2018}. \\
  \midrule
  Real median personal income U.S., in 2018                   & 33,706        & Taken from \citet{St_Louis_Fed:2019}.\\
  {} [\$/year]                                              &               & \\
  \midrule
  U.S.\ Disposable income /                                    & 0.88268       & Taken from U.S.\ Bureau of Economic Analysis (BEA) \\
  real income (minus current taxes)                         &               & National and Products Accounts (NIPA) \\
  {} [--]                                                   &               & Table 2.1. Personal Income and Its Disposition, \\
                                                            &               & \citet{US_BEA:2020}, \\ 
  \midrule
  Share of savings from disposable income                   & 0.079         & Taken from U.S.\ Bureau of Economic Analysis (BEA) \\
  {} [--]                                                   &               & National and Products Accounts (NIPA) \\ 
                                                            &               & Table 2.1. Personal Income and Its Disposition, \\
                                                            &               & \citet{US_BEA:2020}, \\
  \midrule
  Personal consumption                   & \Sexpr{M_dot_orig_car_char}      & Calculation: $(\$33,706\mathrm{/year}) (0.88268) (1 - 0.079)$ \\
  $\rate{M}$ [\$/year]                                      &               &                                              \\
  \midrule
  Price of gasoline                       & \Sexpr{p_E_orig_car_char}       & Taken from U.S.\ Energy Information Agency (EIA) data \\
  $p_E$ [\$/gallon]                                         &               & \citet{US_EIA:2020_gasoline} \\
  \midrule  
  Fractional spend on energy service      & \Sexpr{f_Cs_orig_car_char}      & Calculation: \$1,275 (spend on energy service) \\
  $\fCs$ [--]                                               &               & / [\$19,234 (spend on other goods) + \\
                                                            &               & \$1,275 (spend on energy service)] = 0.062, \\
                                                            &               & where spend on energy service = 14,425 miles / 42 mpg \\
                                                            &               & $\times$ \$2.21/gallon = \$1,275. \\
  \midrule
  Macro factor                                              & \Sexpr{k_car_char}           & Assumed value. \\  
  $k$ [--]                                                  &               &               \\
  \bottomrule
\end{tabular}
\end{center}
\end{table}
\end{landscape}





\begin{landscape}
\begin{table}
\begin{center}
\caption{Car example: Elasticity parameters.}
\label{tab:car_elasticity_parameters}
\begin{tabular}{ r c l }
  \toprule
  Description & Value & Data sources and notes \\
  Parameter [units] & & \\
  \midrule
  Marshallian (uncompensated) price elasticity of demand  & $\Sexpr{e_qs_ps_UC_car_char}$  & Source: \citet{Borenstein:2015aa}. **** Is Borenstein correct? **** \\
  $\eqspsUC$ [--]                                         &                                &   \\ 
  \midrule
  Price elasticity of demand for car use                  &   $\Sexpr{e_qs_ps_C_car_char}$   & Calculated via the Slutsky Equation (Eq.~(\ref{eq:slutsky})).  \\
  $\eqspsC$ [--]                                           &                                &   \\    
  \midrule   
  Cross price elasticity of demand for other goods        &   \Sexpr{e_qo_ps_C_car_char}     & Calculated via Eq.~(\ref{eq:eqops}).  \\
  $\eqopsC$ [--]                                           &                                &   \\ 
  \midrule   
  Income elasticity of demand for car use                 &   \Sexpr{e_qs_M_car_char}      & Assumed value. \\
  $\eqsM$ [--]                                            &                                &   \\ 
  \midrule   
  Income elasticity of demand for other goods             &   \Sexpr{e_qo_M_car_char}      & Assumed value. \\
  $\eqoM$ [--]                                            &                                &   \\
  \bottomrule
\end{tabular}
\end{center}
\end{table}
\end{landscape}




<<car_stages_table, results="asis", echo=FALSE>>=
digs_car <- matrix(c(rep(1, 7), # eta_engr_units
                     rep(3, 7), # eta
                     rep(3, 7), # p_s
                     rep(0, 7), # q_dot_s
                     rep(0, 7), # E_dot_s
                     rep(0, 7), # E_dot_emb
                     rep(0, 7), # C_dot_s
                     rep(0, 7), # C_dot_cap
                     rep(0, 7), # C_dot_md
                     rep(0, 7), # C_dot_o
                     rep(0, 7), # N_dot
                     rep(0, 7)), # M_dot
                   nrow = 12, ncol = 7, byrow = TRUE)
rebound_results %>% 
  dplyr::filter(Case == "Car") %>% 
  dplyr::mutate(
    Case = NULL
  ) %>% 
  ReboundTools::stages_table(label = "tab:car_stages_table", 
                             caption = "Results for car example.", 
                             digits = digs_car, 
                             align = "lrrrrrr") %>% 
  print(include.rownames = FALSE, 
        booktabs = TRUE,
        caption.placement = "top",
        sanitize.text.function = function(x) {x},
        format.args = list(big.mark = ","),
        math.style.negative = TRUE)
@

%------------------------------
\subsubsection{Results} 
\label{sec:Car_results}
%------------------------------

Results are represented graphically in energy, cost, preference path graphs
in Figs.~\ref{fig:CarEnergyGraph}--\ref{fig:CarPrefsGraph}.
The energy path graph (Fig.~\ref{fig:CarEnergyGraph})
shows the size of each rebound effect
for the car example.


<<CarGraphReResults, include=FALSE>>=
Re_empl_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_empl, to_perc = TRUE)
Re_sub_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_sub, to_perc = TRUE)
Re_inc_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_inc, to_perc = TRUE)
Re_macro_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_macro, to_perc = TRUE)
Re_tot_car_char_perc <- val_to_string(case = "Car", val = ReboundTools::rebound_terms$Re_tot, to_perc = TRUE)
@

<<CarEnergyGraph, echo=FALSE, fig.cap="Energy path, car example.", fig.width=6, fig.height=4>>=
car_Re_label_angle <- -77
car_Re_arrow_angle <- pi/180 * 3.1

car_energy_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size, ~angle,
                                     73500, 77500, 'degree', 
                                       stage_colour, orig_size, 0,
                                     42900, 77350, 'a', 
                                       abcd_colour, abcd_size, 0,
                                     43560, 77900, 'b', 
                                       abcd_colour, abcd_size, 0,
                                     44200, 77350, '"*"', 
                                       stage_colour, star_size, 0,
                                     43100, 77100, 'c',
                                       abcd_colour, abcd_size, 0,
                                     46400, 76980, '"^"', 
                                       stage_colour, hat_size, 0,
                                     48800, 77100, 'd', 
                                       abcd_colour, abcd_size, 0,
                                     49400, 79560, 'bold("_")',
                                       stage_colour, bar_size, 0,
                                     49150, 81960, '"~"', 
                                       stage_colour, tilde_size, 0,
                                     40200, 77700, 'Hyperconservation', 
                                       annotation_colour, 
                                       annotation_size-1,
                                       car_Re_label_angle,
                                     41000, 79000, 'Re[tot] == 0*"%"', 
                                       annotation_colour, 
                                       annotation_size,
                                       car_Re_label_angle,
                                     42400, 79200, paste0("Re[empl] == '", Re_empl_car_char_perc, "%'"),
                                       annotation_colour, 
                                       annotation_size,
                                       car_Re_label_angle,
                                     41900, 80500, 'Re[sub]', 
                                       annotation_colour, 
                                       annotation_size,
                                       car_Re_label_angle + 90,
                                     42180, 80250, paste0("'", Re_sub_car_char_perc, "%'"), 
                                       annotation_colour, 
                                       annotation_size - 1,
                                       car_Re_label_angle + 90,
                                     45200, 80680, 'Re[inc]', 
                                       annotation_colour, 
                                       annotation_size,
                                       car_Re_label_angle + 90,
                                     45500, 80420, paste0("'", Re_inc_car_char_perc, "%'"), 
                                       annotation_colour, 
                                       annotation_size - 1,
                                       car_Re_label_angle + 90,
                                     51220, 78000, 'Re[macro]', 
                                       annotation_colour, 
                                       annotation_size - 2,
                                       car_Re_label_angle + 90,
                                     51500, 77810, paste0("'", Re_macro_car_char_perc, "%'"), 
                                       annotation_colour, 
                                       annotation_size - 1,
                                       car_Re_label_angle + 90,
                                     51700, 79500, paste0("Re[tot] == '", Re_tot_car_char_perc, "%'"),
                                       annotation_colour, 
                                       annotation_size,
                                       car_Re_label_angle,
                                     71100, 80000, 'Re[tot] == 100*"%"', 
                                       annotation_colour, 
                                       annotation_size,
                                       car_Re_label_angle,
                                     72100, 81300, 'Backfire', 
                                       annotation_colour, 
                                       annotation_size-1,
                                       car_Re_label_angle)

car_Re_arrows <- tibble::tribble(~x, ~y, ~angle, ~radius, ~colour, ~size,
                                 40330, 80600, car_Re_arrow_angle, 2800, annotation_colour, 0.5,
                                 43200, 80760, car_Re_arrow_angle, 3750, annotation_colour, 0.5,
                                 49940, 78040, car_Re_arrow_angle, 2250, annotation_colour, 0.5)

rebound_results %>% 
  ReboundTools::path_graphs(cases = "Car", 
                               graph_types = "Energy") +
  ggplot2::geom_spoke(data = car_Re_arrows, 
                        mapping = ggplot2::aes(x = x,
                                               y = y,
                                               angle = angle, 
                                               radius = radius, 
                                               colour = colour), 
                        arrow = ggplot2::arrow(length = ggplot2::unit(0.1,"cm"))) +
  ggplot2::geom_text(data = car_energy_labels, 
                     mapping = ggplot2::aes(x = x, 
                                            y = y, 
                                            label = lab, 
                                            colour = colour, 
                                            size = size,
                                            angle = angle), 
                     parse = TRUE) +
  MKHthemes::xy_theme()
@


<<CarCostGraph, echo=FALSE, fig.cap="Expenditure path, car example.", fig.width=6, fig.height=4>>=
car_cost_line_angle <- -27
car_cost_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size, ~angle,
                                   1280, 26150, 'degree', 
                                     stage_colour, orig_size, 0,
                                   759, 26150, 'a', 
                                     abcd_colour, abcd_size, 0,
                                   770, 26025, 'b', 
                                     abcd_colour, abcd_size, 0,
                                   770, 25937, '"*"', 
                                     stage_colour, star_size, 0,
                                   770, 25892, 'c', 
                                     abcd_colour, abcd_size, 0,
                                   816, 25880, '"^"', 
                                     stage_colour, hat_size, 0,
                                   855, 25870, 'd', 
                                     abcd_colour, abcd_size, 0,
                                   830, 26557, 'bold("_")', 
                                     stage_colour, bar_size, 0,
                                   1075, 26350, 'Original~expenditure', 
                                     annotation_colour, annotation_size, car_cost_line_angle,
                                   950, 25958, 'After~expected~savings', 
                                     annotation_colour, annotation_size, car_cost_line_angle)

rebound_results %>% 
  ReboundTools::path_graphs(cases = "Car", 
                               graph_types = "Expenditure") + 
  ggplot2::geom_text(data = car_cost_labels, 
                     mapping = ggplot2::aes(x = x, 
                                            y = y, 
                                            label = lab, 
                                            colour = colour, 
                                            size = size,
                                            angle = angle), 
                     parse = TRUE) +
  MKHthemes::xy_theme()
@


<<CarPrefsGraph, echo=FALSE, warning=FALSE, fig.cap="Preferences path, car example.", fig.width=6, fig.height=4>>=
car_prefs_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size,
                                    1.005, 1.0016, 'degree', 
                                      stage_colour, orig_size, 
                                    1.012, 1.0002, '","', 
                                      annotation_colour, orig_size-3,
                                    1.02, 1.0004, '"*"', 
                                      annotation_colour, star_size,
                                    1.071, 0.998, '"^"',  
                                      stage_colour, hat_size, 
                                    1.108, 1.0336, 'bold("_")',  
                                      stage_colour, bar_size, 
                                    0.9, 1.0076, 'degree', 
                                      line_label_colour, orig_line_label_size, 
                                    1.165, 0.99, 'degree', 
                                      line_label_colour, orig_line_label_size, 
                                    0.9, 1.004, '"*"', 
                                      line_label_colour, star_line_label_size, 
                                    1.258, 0.99, '"*"', 
                                      line_label_colour, star_line_label_size, 
                                    0.995, 0.9958, 'c',
                                      abcd_colour, abcd_size,
                                    0.9, 1.0017, '"^"', 
                                      line_label_colour, hat_line_label_size, 
                                    1.195, 0.99, '"^"', 
                                      line_label_colour, hat_line_label_size, 
                                    1.12, 0.9965, 'd', 
                                      abcd_colour, abcd_size,
                                    0.9, 1.04, '"_"', 
                                      line_label_colour, bar_line_label_size, 
                                    1.3, 1.024, '"_"', 
                                      line_label_colour, bar_line_label_size, 
                                    1.128, 1.04, 'r', 
                                      line_label_colour, r_line_label_size,
                                    1.075, 0.99, 'r', 
                                      line_label_colour, r_line_label_size,
                                    0.91, 1.0106, 'i*degree', 
                                      line_label_colour, i_line_label_size,
                                    1.27, 0.9933, 'i*degree', 
                                      line_label_colour, i_line_label_size,
                                    1.01, 1.0397, 'bar(i)', 
                                      line_label_colour, i_line_label_size,
                                    1.29, 1.0295, 'bar(i)', 
                                      line_label_colour, i_line_label_size,
                                    )

rebound_results %>% 
  ReboundTools::path_graphs(cases = "Car", 
                               graph_types = "Preferences") + 
  ggplot2::geom_text(data = car_prefs_labels, 
                     mapping = ggplot2::aes(x = x, 
                                            y = y, 
                                            label = lab, 
                                            colour = colour, 
                                            size = size), 
                     parse = TRUE) +
  ggplot2::xlim(0.9, 1.3) + 
  ggplot2::ylim(0.99, 1.04) +
  MKHthemes::xy_theme()
@


The base results for the automobile upgrade are shown in Table~\ref{tab:car_results}.

<<car_rebound_results_table, results="asis", echo=FALSE>>=
rebound_results %>% 
  dplyr::filter(Case == "Car") %>% 
  dplyr::mutate(
    Case = NULL
  ) %>% 
  ReboundTools::rebound_results_table(include_subtotals = FALSE, 
                                      rebound_terms = ReboundTools::rebound_terms[!names(ReboundTools::rebound_terms) %in% "Re_cap"],
                                      label = "tab:car_results", 
                                      caption = "Car example: rebound results.", 
                                      digits = 1, 
                                      align = "rrr") %>% 
  print(include.rownames = FALSE, 
        booktabs = TRUE,
        caption.placement = "top",
        hline.after = c(-1, 0, nrow(.)-1, nrow(.)),
        sanitize.text.function = function(x) {x},
        format.args = list(big.mark = ","), 
        math.style.negative = TRUE)
@


The \empleffect{} has three components:
the direct emplacement effect, 
the embodied energy effect, and 
the maintenance and disposal effect.
Rebound from the direct emplacement effect 
($Re_{dempl}$) is \Sexpr{Re_dempl_car_char_perc}\% always, 
because energy takeback (and, therefore, rebound)
occurs after the EEU is emplaced.
Indirect rebound due to the embodied energy effect
($Re_{emb}$) is \Sexpr{Re_emb_car_char_perc}\%,  
due to the higher embodied energy rate
($\Delta \raempl{E}_{emb} = \Sexpr{Delta_E_dot_emb_star_car_char}$~MJ/year)
stemming from the electric battery in the hybrid EV car.
Rebound due to the maintenance and disposal effect
($Re_{\md}$) is small and negative
($\Sexpr{Re_md_car_char_perc}$\%),
because of the slightly lower maintenance and disposal costs
for the hybrid EV car.

The \subeffect{} effect has two components:
direct and indirect substitution effect rebound.
Rebound from direct substitution ($Re_{dsub}$) is 
positive, as expected (\Sexpr{Re_dsub_car_char_perc}\%). 
The car owner will prefer more driving, 
because of fuel efficiency enhancements (\Sexpr{mpg_better}~mpg $>$ \Sexpr{mpg_worse}~mpg).
In other words, with no other changes, 
the more fuel efficient car increases driving by \Sexpr{Re_dsub_car_char_perc}\%. 
Conversely, the indirect substitution effect ($Re_{isub}$)
is slightly negative ($\Sexpr{Re_isub_car_char_perc}$\%)
to achieve the same level of utility after increased driving. 
Indeed, less money is spent on other goods
($\Delta \rasub{C}_o = \Sexpr{Delta_C_dot_o_hat_car_char}$~\$/year).

The \inceffect{} also has two components:
direct and indirection income effect rebound.
The car owner sees an increase in their effective income
due to a net monetary savings from the emplacement and substitution effects. 
The direct income effect
($Re_{dinc}$) is positive
(\Sexpr{Re_dinc_car_char_perc}\%), 
because the car owner allocates some
freed cash to additional driving. 
Rebound from the indirect income effect 
($Re_{iinc}$) is positive (\Sexpr{Re_iinc_car_char_perc}\%)
due to higher spending on other goods. 
Thus, the freed cash after the substitution effect
($\rasub{N} = \Sexpr{N_dot_hat_car_char}$~\$/year) 
translates into positive direct and indirect income
rebound at the micro level. 

Finally, at the macro level, the \macroeffect{} leads to macro rebound
($Re_{\macro}$) of \Sexpr{Re_macro_car_char_perc}\%,
due to economic expansion caused by 
productivity enhancements arising from the more-efficient provision of the 
energy service (transportation).


%++++++++++++++++++++++++++++++
\subsection{Case 2: Electric lamp}
\label{sec:lamp_example}
%++++++++++++++++++++++++++++++

<<LampPrintableNumbers, echo=FALSE>>=
# First table
efficacy_worse <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$eta_engr_units_orig, scale = 0.001, digits = 2) # lm-hr/W-hr
efficacy_better <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$eta_engr_units_star, scale = 0.001, digits = 1) # lm-hr/W-hr
C_dot_cap_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$C_dot_cap_orig, digits = 3)
C_dot_cap_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$C_dot_cap_star, digits = 3)
t_own_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$t_own_orig, digits = 1)
t_own_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$t_own_star, digits = 0)
t_life_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$t_life_orig, digits = 1)
t_life_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$t_life_star, digits = 0)
E_emb_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$E_emb_orig, digits = 2)
E_emb_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$E_emb_star, digits = 2)
C_dot_md_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$C_dot_md_orig, digits = 2)
C_dot_md_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$C_dot_md_star, digits = 2)

# Second table
q_dot_s_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$q_dot_s_orig, digits = 0)
M_dot_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$M_dot_orig, digits = 2)
p_E_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::eeu_base_params$p_E_engr_units, digits = 4)
f_Cs_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$f_Cs_orig, digits = 7)
k_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::eeu_base_params$k, digits = 1)

# Third table
e_qs_ps_UC_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::eeu_base_params$e_qs_ps_UC, digits = 1)
e_qs_ps_lamp_C_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$e_qs_ps_C, digits = 4)
e_qo_ps_lamp_C_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$e_qo_ps_C, digits = 5)
e_qs_M_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::eeu_base_params$e_qs_M, digits = 1)
e_qo_M_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::eeu_base_params$e_qo_M, digits = 1)

# Results discussion
Re_dempl_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_dempl, to_perc = TRUE, digits = 1)
Re_emb_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_emb, to_perc = TRUE)
Delta_E_dot_emb_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::Delta_vars$Delta_E_dot_emb_star, digits = 2)
E_emb_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$E_emb_orig, digits = 2)
E_emb_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$E_emb_star, digits = 2)
E_dot_emb_orig_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$E_dot_emb_orig, digits = 2)
E_dot_emb_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$E_dot_emb_star, digits = 2)
Re_emb_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_emb, to_perc = TRUE)
Re_md_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_md, to_perc = TRUE)
Re_dsub_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_dsub, to_perc = TRUE)
eta_better <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$eta_engr_units_star, scale = 0.001, digits = 1) # In lm/W
eta_worse <- val_to_string(case = "Lamp", val = ReboundTools::orig_vars$eta_engr_units_orig, scale = 0.001, digits = 2) # In lm/W
q_dot_s_star_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::star_vars$q_dot_s_star, digits = 0) # In lm-hr/year
q_dot_s_hat_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::hat_vars$q_dot_s_hat, digits = 0) # In lm-hr/year
Re_isub_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_isub, to_perc = TRUE)
Delta_C_dot_o_hat_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::Delta_vars$Delta_C_dot_o_hat, digits = 2)
Re_dinc_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_dinc, to_perc = TRUE, digits = 2)
Re_iinc_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_iinc, to_perc = TRUE)
N_dot_hat_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::hat_vars$N_dot_hat, digits = 2)
Delta_C_dot_o_bar_lamp_char <- val_to_string(case = "Lamp", val = ReboundTools::Delta_vars$Delta_C_dot_o_bar, digits = 2)
Re_macro_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_macro, to_perc = TRUE)
@


For our second example, 
we consider purchasing a light emitting diode (LED) electric lamp, 
versus a baseline incandescent electric lamp. 
Both lamps are matched as closely as possible 
in terms of energy service delivery (measured in lumens), 
the key difference being the energy required to provide that energy service. 
The electric lamp case study has a very low 
initial capital investment (negative, actually!)
and a long-term benefit of decreased direct energy costs.


%------------------------------
\subsubsection{Input parameters} 
\label{sec:lamp_input_data}
%------------------------------

Again, we require four sets of data. 
First, the basic lamp parameters, which are summarized below:  
Table~\ref{tab:lamp_parameters} shows parameters for the electric lamp efficiency upgrade (EEU).
Second, we require several general parameters, 
mainly relating to the U.S.\ economy and 
personal finances of the average U.S.\ citizen. 
The parameters and their values used in the study 
are given below in Table~\ref{tab:lamp_economic_parameters}.
Third, we require the elasticity parameters, 
as shown in Table~\ref{tab:lamp_elasticity_parameters}.
Fourth, with the parameter values from 
Tables~\ref{tab:lamp_parameters}--\ref{tab:lamp_elasticity_parameters} 
and the equations of Section~\ref{sec:framework} in hand,
we calculate important values at each rebound stage,
as shown below in Table~\ref{tab:lamp_stages_table}.


\begin{landscape}
\begin{table}
\begin{center}
\caption{Lamp example: Electric lamp parameters.} 
\label{tab:lamp_parameters}
\begin{tabular}{ r c c l }
  \toprule
    Description                  & Incandescent lamp & LED lamp & Data sources and notes\\ 
    Parameters [units]                                &  &  & \\
  \midrule
  Lamp efficacy                   & \Sexpr{efficacy_worse}      & \Sexpr{efficacy_better}     & Incandescent: 530 lm output / 60 W energy input. \\
  $\bempl{\eta}$, $\amacro{\eta}$ [lm-hr/W-hr]       &           &          & LED: 450 lm output / 5.5 W energy input. \\
  \midrule
   Capital expenditure rate       & \Sexpr{C_dot_cap_orig_lamp_char}   & \Sexpr{C_dot_cap_star_lamp_char}    & Purchase costs: \$1.88 for incandescent lamp from  \\
   $\rbempl{C}_{cap}$, $\raempl{C}_{cap}$ [\$/year] &           &          & \citet{Home_Depot:2020_Inc_bulb}, \\
                                                    &           &          & and \$1.21 for LED lamp from \\
                                                    &           &          & \citet{Home_Depot:2020_LED_bulb}. \\
  \midrule
   Ownership duration      & \Sexpr{t_own_orig_lamp_char}       & \Sexpr{t_own_star_lamp_char}       & Assumed same as lamp lifespan \\
   $\bempl{t}_{own}$, $\aempl{t}_{own}$ [years]     &           &          &  \\
 \midrule
   Lifespan               & \Sexpr{t_life_orig_lamp_char}       & \Sexpr{t_life_star_lamp_char}       & Based on assumed 3 hours/day  \\
   $\bempl{t}_{\life}$, $\aempl{t}_{\life}$ [years] &           &          & from \citet{Home_Depot:2020_Inc_bulb} \\
                                                    &           &          & and  \citet{Home_Depot:2020_LED_bulb}. \\
   \midrule
   Life cycle analysis (LCA) embodied energy  & \Sexpr{E_emb_orig_lamp_char}      & \Sexpr{E_emb_star_lamp_char}     & Base document: Table 4.5 Manufacturing Energy  \\
   $\bempl{E}_{emb}$, $\aempl{E}_{emb}$ [MJ]        &           &          & Primary energy (MJ/20 Million lumen hours), \\
                                                    &           &          & U.S.\ DoE Life-cycle assessment of energy and environmental \\
                                                    &           &          & impacts of LED lighting products \\
                                                    &           &          & \citep{US_DoE:2012}. \\
                                                    &           &          & Incandescent: \\
                                                    &           &          & LCA energy = 42.2 MJ/20 million lumen-hours.  \\
                                                    &           &          & Lifetime output = 530 lumens $\times$ 3 hours/day \\
                                                    &           &          & $\times$ 365 days/year $\times$ 1.8 years = 1,044,630 lumen-hrs.\\
                                                    &           &          & Thus LCA energy / lamp =  42.2 $\times$ 1.0446/20 = 2.21 MJ. \\
                                                    &           &          & LED:  \\
                                                    &           &          & LCA energy = 132 MJ/20 Million lumen-hours for pack of 5 LED lamps. \\
                                                    &           &          & Lifetime output = 450 lumens $\times$ 3 hours/day  \\
                                                    &           &          & $\times$ 365 days/year $\times$ 10 years = 4,926,405 lumen-hrs. \\
                                                    &           &          & Thus LCA energy / lamp =  132 MJ/5 $\times$ 4.9264/20 = 6.5 MJ. \\ 
 \midrule
  Maintenance and disposal expenditure rate  & \Sexpr{C_dot_md_orig_lamp_char}      & \Sexpr{C_dot_md_star_lamp_char}     & Assumed negligible. \\
  $\rbempl{C}_{\md}$, $\raempl{C}_{\md}$ [\$/year]  &           &          & \\
  \bottomrule
\end{tabular}
\end{center}
\end{table}
\end{landscape}






\begin{landscape}
\begin{table}
\begin{center}
\caption{Lamp example: Economic parameters.}
\label{tab:lamp_economic_parameters}
\begin{tabular}{ r c l }
  \toprule
  Description  & Value & Data sources and notes \\ 
  Parameter [units] & & \\
  \midrule
  Lighting consumption prior to upgrade   & \Sexpr{q_dot_s_orig_lamp_char}  & Calculation: (530 lm) (3 hrs/day) (365 days/year). \\
  $\rbempl{q}_s$ [lm-hr/year]                               &               & \\
  \midrule
  Real median personal income U.S.\, in 2018                   & 33,706        & Source: \citet{St_Louis_Fed:2019}.\\
  {} [\$/year]                                              &               & \\
  \midrule
  U.S.\ Disposable income /                                    & 0.88268       & Source:  National and Products Accounts (NIPA) \\
  real income (minus current taxes)                         &               & Table 2.1. Personal Income and Its Disposition \\
  {} [--]                                                   &               & \citep{US_BEA:2020}. \\
  \midrule
  Share of savings from disposable income                   & 0.079         & Source: National and Products Accounts (NIPA) \\
  {} [--]                                                   &               & Table 2.1. Personal Income and Its Disposition \\ 
                                                            &               & \citep{US_BEA:2020}. \\
  \midrule
  Personal consumption                   & \Sexpr{M_dot_orig_lamp_char}     & Calculation: $(\$33,706\mathrm{/year}) (0.88268) (1 - 0.079)$. \\
  $\rate{M}$ [\$/year]                                      &               &                                              \\
  \midrule
  Price of electricity                  & \Sexpr{p_E_orig_lamp_char}        & U.S.\ 2020 average household electricity price \\
  $p_E$ [\$/kW-hr]                                          &               & \citep{US_EIA:2020_electricity}.  \\
  \midrule
  Fractional spend on energy service    & \Sexpr{f_Cs_orig_lamp_char}       & Calculation: \$9/year (spend on energy service) / \\
  $\fCs$ [--]                                               &               & [\$27,391/year (spend on other goods) + \\
                                                            &               & \$9/year (spend on energy service)] = 0.00032, \\
                                                            &               & where spend on energy service = 580,350 lm-hrs/year /  \\
                                                            &               & 81.8 lm/W / 1000 W/kW $\times$ \$0.1355/kW-hr = \$9/year.  \\
  \midrule
  Macro factor                                              & \Sexpr{k_lamp_char}           & Assumed value. \\  
  $k$ [--]                                                  &               &               \\
  \bottomrule
\end{tabular}
\end{center}
\end{table}
\end{landscape}




\begin{landscape}
\begin{table}
\begin{center}
\caption{Lamp example: Elasticity parameters.}
\label{tab:lamp_elasticity_parameters}
\begin{tabular}{ r c l }
  \toprule
  Description & Value & Data sources and notes \\
  Parameter [units] & & \\
  \midrule
  Marshallian (uncompensated) price elasticity of demand  &   $\Sexpr{e_qs_ps_UC_lamp_char}$  & Source: \citet{Borenstein:2015aa}. **** Need lamp ref. **** \\
  $\eqspsUC$ [--]                                         &           &   \\ 
  \midrule
  Price elasticity of demand for lighting                 &  $\Sexpr{e_qs_ps_lamp_C_char}$      & Calculated via the Slutsky Equation (Eq.~(\ref{eq:slutsky})).  \\
  $\eqspsC$ [--]                                           &           &   \\    
  \midrule   
  Cross price elasticity of demand for other goods        &   \Sexpr{e_qo_ps_lamp_C_char}     & Calculated via Eq.~(\ref{eq:eqops}).  \\
  $\eqopsC$ [--]                                           &           &   \\ 
  \midrule   
  Income elasticity of demand for lighting                &   \Sexpr{e_qs_M_lamp_char}     & Assumed value. \\
  $\eqsM$ [--]                                            &           &   \\ 
  \midrule   
  Income elasticity of demand for other goods             &   \Sexpr{e_qo_M_lamp_char}     & Assumed value. \\
  $\eqoM$ [--]                                            &           &   \\
  \bottomrule
\end{tabular}
\end{center}
\end{table}
\end{landscape}




<<lamp_stages_table, results="asis", echo=FALSE>>=
digs_lamp <- matrix(c(rep(0, 7), # eta_engr_units
                      rep(0, 7), # eta
                      rep(8, 7), # p_s
                      rep(0, 7), # q_dot_s
                      rep(1, 7), # E_dot_s
                      rep(3, 7), # E_dot_emb
                      rep(2, 7), # C_dot_s
                      rep(2, 7), # C_dot_cap
                      rep(2, 7), # C_dot_md
                      rep(0, 7), # C_dot_o
                      rep(2, 7), # N_dot
                      rep(0, 7)), # M_dot
                    nrow = 12, ncol = 7, byrow = TRUE)
rebound_results %>% 
  dplyr::filter(Case == "Lamp") %>% 
  dplyr::mutate(
    Case = NULL
  ) %>% 
  ReboundTools::stages_table(label = "tab:lamp_stages_table", 
                             caption = "Results for lamp example.", 
                             digits = digs_lamp, 
                             align = "lrrrrrr") %>% 
  print(include.rownames = FALSE, 
        booktabs = TRUE,
        caption.placement = "top",
        sanitize.text.function = function(x) {x},
        format.args = list(big.mark = ","),
        math.style.negative = TRUE)
@


<<LampGraphReResults, include=FALSE>>=
Re_empl_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_empl, to_perc = TRUE)
Re_sub_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_sub, to_perc = TRUE)
Re_inc_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_inc, to_perc = TRUE)
Re_macro_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_macro, to_perc = TRUE)
Re_tot_lamp_char_perc <- val_to_string(case = "Lamp", val = ReboundTools::rebound_terms$Re_tot, to_perc = TRUE)
@

<<LampEnergyGraph, echo = FALSE, warning=FALSE, fig.cap="Energy path, lamp example.", fig.width=6, fig.height=4>>=
lamp_Re_label_angle <- -62
lamp_Re_arrow_angle <- pi/180 * 15.5
lamp_energy_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size, ~angle,
                                      240, 92842, 'degree', 
                                        stage_colour, orig_size, 0,
                                      27, 92842, 'a', 
                                        abcd_colour, abcd_size, 0,
                                      14, 92839.5, '"b,"', 
                                        abcd_colour, abcd_size, 0,
                                      20, 92837.5, '"*"', 
                                        stage_colour, star_size, 0,
                                      23, 92823, 'c', 
                                        abcd_colour, abcd_size, 0,
                                      61, 92820, '"^"', 
                                        stage_colour, hat_size, 0,
                                      67, 92825, '"d"', 
                                        abcd_colour, abcd_size, 0,
                                      68, 92865, 'bold("_")',
                                        stage_colour, bar_size, 0,
                                      67, 92904, '"~"', 
                                        stage_colour, tilde_size, 0,
                                      0, 92835, 'Hyperconservation', 
                                        annotation_colour, 
                                        annotation_size - 1,
                                        lamp_Re_label_angle,
                                      16, 92855, 'Re[tot] == 0*"%"', 
                                        annotation_colour, 
                                        annotation_size, 
                                        lamp_Re_label_angle,
                                     -1, 92860, paste0("Re[empl] == '", Re_empl_lamp_char_perc, "%'"),
                                        annotation_colour, 
                                        annotation_size - 1, 
                                        lamp_Re_label_angle,
                                      1, 92874.2, 'Re[sub]', 
                                        annotation_colour, 
                                        annotation_size - 1, 
                                        lamp_Re_label_angle + 90,
                                      6, 92870, paste0("'", Re_sub_lamp_char_perc, "%'"), 
                                        annotation_colour, 
                                        annotation_size - 1, 
                                        lamp_Re_label_angle + 90,
                                      24, 92881, 'Re[inc]', 
                                        annotation_colour, 
                                        annotation_size, 
                                        lamp_Re_label_angle + 90,
                                      29, 92876.5, paste0("'", Re_inc_lamp_char_perc, "%'"), 
                                        annotation_colour, 
                                        annotation_size - 1, 
                                        lamp_Re_label_angle + 90,
                                      90, 92856.5, 'Re[macro]', 
                                        annotation_colour, 
                                        annotation_size, 
                                        lamp_Re_label_angle + 90,
                                      95.5, 92851, paste0("'", Re_macro_lamp_char_perc, "%'"), 
                                        annotation_colour, 
                                        annotation_size, 
                                        lamp_Re_label_angle + 90,
                                      202, 92880, 'Re[tot] == 100*"%"', 
                                        annotation_colour, 
                                        annotation_size, 
                                        lamp_Re_label_angle,
                                      108, 92865, paste0("Re[tot] == '", Re_tot_lamp_char_perc, "%'"),
                                        annotation_colour, 
                                        annotation_size, 
                                        lamp_Re_label_angle,
                                      230, 92890, 'Backfire',
                                        annotation_colour, 
                                        annotation_size, 
                                        lamp_Re_label_angle)

lamp_Re_arrows <- tibble::tribble(~x, ~y, ~angle, ~radius, ~colour, ~size,
                                  -5.4, 92870, lamp_Re_arrow_angle, 
                                    17.2, annotation_colour, example_arrow_size,
                                  11.8, 92874.8, lamp_Re_arrow_angle, 
                                    32, annotation_colour, example_arrow_size,
                                  76.7, 92850, lamp_Re_arrow_angle, 
                                    32, annotation_colour, example_arrow_size)

rebound_results %>% 
  ReboundTools::path_graphs(cases = "Lamp", 
                               graph_types = "Energy") + 
  ggplot2::geom_spoke(data = lamp_Re_arrows, 
                        mapping = ggplot2::aes(x = x,
                                               y = y,
                                               angle = angle, 
                                               radius = radius, 
                                               colour = colour), 
                        arrow = ggplot2::arrow(length = ggplot2::unit(0.1,"cm"))) +
  ggplot2::geom_text(data = lamp_energy_labels, 
                     mapping = ggplot2::aes(x = x, 
                                            y = y, 
                                            label = lab, 
                                            colour = colour, 
                                            size = size,
                                            angle = angle), 
                     parse = TRUE, ) +
  MKHthemes::xy_theme()
@


<<LampCostGraph, echo = FALSE, fig.cap="Expenditure path, lamp example.", fig.width=6, fig.height=4>>=
lamp_cost_line_angle <- -24
lamp_cost_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size, ~angle,
                                    9, 27392.8, 'degree', 
                                      stage_colour, orig_size, 0,
                                    0.9, 27392.8, 'a', 
                                      abcd_colour, abcd_size, 0,
                                    0.57, 27391.6, '"b,"',
                                      abcd_colour, abcd_size, 0,
                                    0.79, 27391.33, '"*"', 
                                      stage_colour, star_size, 0,
                                    0.85, 27387, 'c', 
                                      abcd_colour, abcd_size, 0,
                                    2.3, 27386.5, '"^"', 
                                      stage_colour, hat_size, 0,
                                    2.5, 27387, 'd', 
                                      abcd_colour, abcd_size, 0,
                                    2.55, 27399.2, 'bold("_")', 
                                      stage_colour, bar_size, 0,
                                    5, 27396.7, 'Original~expenditure',
                                      annotation_colour, annotation_size, lamp_cost_line_angle,
                                    4, 27389.7, 'After~expected~savings',
                                      annotation_colour, annotation_size, lamp_cost_line_angle)

rebound_results %>% 
  ReboundTools::path_graphs(cases = "Lamp", 
                               graph_types = "Expenditure") + 
  ggplot2::geom_text(data = lamp_cost_labels, 
                     mapping = ggplot2::aes(x = x, 
                                            y = y, 
                                            label = lab, 
                                            colour = colour, 
                                            size = size,
                                            angle = angle), 
                     parse = TRUE) +
  
  MKHthemes::xy_theme()
@


<<LampPrefsGraph, echo=FALSE, warning=FALSE, fig.cap="Preferences path, lamp example.", fig.width=6, fig.height=4>>=
lamp_prefs_labels <- tibble::tribble(~x, ~y, ~lab, ~colour, ~size,
                                     1.05, 1.00002, 'degree', 
                                       stage_colour, orig_size,
                                     1.097, 1.000005, '","', 
                                       stage_colour, orig_size-3,
                                     1.15, 1.000004, '"*"', 
                                       stage_colour, star_size,
                                     0.7, 1.00008, 'degree',
                                       line_label_colour, orig_line_label_size,
                                     1.57, 0.9998, 'degree',
                                       line_label_colour, orig_line_label_size,
                                     0.7, 0.999988, '"*"', 
                                       line_label_colour, star_line_label_size,
                                     3.5, 0.99989, '"*"',
                                       line_label_colour, star_line_label_size,
                                     0.96, 0.99984, 'c', 
                                       abcd_colour, abcd_size,
                                     2.4, 0.999815, '"^"',
                                       stage_colour, hat_size,
                                     0.7, 0.999885, '"^"',
                                       line_label_colour, hat_line_label_size,
                                     3.4, 0.99979, '"^"', 
                                       line_label_colour, hat_line_label_size,
                                     2.48, 0.999857, 'd',
                                       abcd_colour, abcd_size,
                                     2.5, 1.000287, 'bold("_")', 
                                       stage_colour, bar_size,
                                     0.7, 1.00033, '"_"',  
                                       line_label_colour, bar_line_label_size,
                                     3.5, 1.00023, '"_"',  
                                       line_label_colour, bar_line_label_size,
                                     2.46, 0.9998, 'r', 
                                       abcd_colour, r_line_label_size,
                                     2.46, 1.0004, 'r',
                                       abcd_colour, r_line_label_size,
                                     0.75, 1.00016, 'i*degree',
                                       line_label_colour, i_line_label_size,
                                     3.4, 0.99984, 'i*degree',
                                       line_label_colour, i_line_label_size,
                                     1.21, 1.0004, 'bar(i)',
                                       line_label_colour, i_line_label_size,
                                     3.4, 1.00027, 'bar(i)',
                                       line_label_colour, i_line_label_size,
                                     )
rebound_results %>% 
  ReboundTools::path_graphs(cases = "Lamp", 
                               graph_types = "Preferences") + 
    ggplot2::geom_text(data = lamp_prefs_labels, 
                     mapping = ggplot2::aes(x = x, 
                                            y = y, 
                                            label = lab, 
                                            colour = colour, 
                                            size = size), 
                     parse = TRUE) +
  ggplot2::xlim(0.7, 3.5) +
  ggplot2::ylim(0.99979, 1.0004) +
  MKHthemes::xy_theme()
@


%------------------------------
\subsubsection{Results} 
\label{sec:lamp_results}
%------------------------------

Results are represented graphically in energy, cost, and preference path graphs
in Figs.~\ref{fig:LampEnergyGraph}--\ref{fig:LampPrefsGraph}.
The energy path graph (Fig.~\ref{fig:LampEnergyGraph})
shows the size of each rebound effect
for the lamp example.

The base results for the lamp upgrade are shown in Table~\ref{tab:lamp_results}.

<<lamp_rebound_results_table, results="asis", echo=FALSE>>=
rebound_results %>% 
  dplyr::filter(Case == "Lamp") %>% 
  dplyr::mutate(
    Case = NULL
  ) %>% 
  ReboundTools::rebound_results_table(include_subtotals = FALSE, 
                                      rebound_terms = ReboundTools::rebound_terms[!names(ReboundTools::rebound_terms) %in% "Re_cap"],
                                      label = "tab:lamp_results", 
                                      caption = "Lamp example: rebound results.", 
                                      digits = 1, 
                                      align = "rrr") %>% 
  print(include.rownames = FALSE, 
        booktabs = TRUE,
        caption.placement = "top",
        hline.after = c(-1, 0, nrow(.)-1, nrow(.)),
        sanitize.text.function = function(x) {x},
        format.args = list(big.mark = ","),
        math.style.negative = TRUE)
@


The \empleffect{} rebound components are as follows:
the direct emplacement effect ($Re_{dempl}$) 
is always $\Sexpr{Re_dempl_lamp_char_perc}$\%.
Indirect rebound due to the embodied energy effect
($Re_{emb}$) is $\Sexpr{Re_emb_lamp_char_perc}$\%.
Although the LED lamp has higher embodied energy 
($\aempl{E}_{emb} = \Sexpr{E_emb_star_lamp_char}$~MJ)
than the incandescent lamp 
($\bempl{E}_{emb} = \Sexpr{E_emb_orig_lamp_char}$~MJ),
the LED lamp has a much longer lifetime,
meaning that the LED embodied energy rate 
($\raempl{E}_{emb} = \Sexpr{E_dot_emb_star_lamp_char}$~MJ/year)
is less than the incandescent embodied energy rate
($\rbempl{E}_{emb} = \Sexpr{E_dot_emb_orig_lamp_char}$~MJ/year).
Thus, the change in embodied energy rate ($\Delta \raempl{E}_{emb}$)
is $\Sexpr{Delta_E_dot_emb_star_lamp_char}$~MJ/year, 
and embodied energy rebound is negative
($Re_{emb} = \Sexpr{Re_emb_lamp_char_perc}$\%).
Rebound due to the maintenance and disposal effect
($Re_{\md}$) is \Sexpr{Re_md_lamp_char_perc}\%,
because we assume no difference in maintenance and disposal costs between 
the incandescent lamp and the LED lamp.

Direct \subeffect{} rebound 
($Re_{dsub}$) is \Sexpr{Re_dsub_lamp_char_perc}\%
due to the much higher LED lamp efficacy
($\aempl{\eta} = \Sexpr{eta_better}$~lm/W) 
compared to the incandescent lamp
($\bempl{\eta} = \Sexpr{eta_worse}$~lm/W),
leading to increased consumption of lighting
(from $\rbsub{q}_s = \Sexpr{q_dot_s_star_lamp_char}$~lm-hr/year
to $\rasub{q}_s = \Sexpr{q_dot_s_hat_lamp_char}$~lm-hr/year)
as shown by segment \chat{} in Fig.~\ref{fig:LampPrefsGraph}.
To maintain constant utility, 
consumption of other goods is reduced
($\Delta \rasub{C}_o = \Sexpr{Delta_C_dot_o_hat_lamp_char}$~\$/year), 
as shown by segment \starc{} in Fig.~\ref{fig:LampPrefsGraph},
yielding indirect substitution effect rebound
($Re_{isub}$) of $\Sexpr{Re_isub_lamp_char_perc}$\%.

\Inceffect{} rebound arises from respending of net energy cost savings
associated with converting from the incandescent lamp to the LED lamp
($\rbinc{N} = \Sexpr{N_dot_hat_lamp_char}$~\$/year).
Direct income effect rebound 
($Re_{dinc}$) is \Sexpr{Re_dinc_lamp_char_perc}\%),
positive but small, 
as the lamp owner allocates 
some of the additional income to increased consumption of lighting. 
The indirect income effect rebound is large
($Re_{iinc} = \Sexpr{Re_iinc_lamp_char_perc}$\%), 
due to the energy implications of increased spending on other goods.

Finally, rebound due to the macroeconomic 
\macroeffect{} 
($Re_{\macro}$) is \Sexpr{Re_macro_lamp_char_perc}\%
due to economic expansion caused by 
productivity enhancements arising from the more-efficient provision of the 
energy service (lighting).
(It is a coincidence that $Re_{\macro}$ has the same value as $Re_{iinc}$
to 1 decimal place for the lighting example.)


%++++++++++++++++++++++++++++++
\subsection{Sensitivity analyses}
\label{sec:sensitivity_analyses}
%++++++++++++++++++++++++++++++

Sensitivity analyses show the effect of 
independently-varied parameters on total rebound and rebound components.
In the context of this rebound framework,
sensitivity analyses
can show important trends, tendencies, and relationships
between rebound parameters and rebound magnitudes.
Key rebound parameters include 
post-EEU efficiency ($\amacro{\eta}$),
energy price ($p_E$),
uncompensated own price elasticity of energy service consumption ($\eqspsUC$), and
the macro factor ($k$).
Sensitivity analyses must be undertaken carefully,
because rebound parameters are rarely
independent of each other.

In each subsection below, a series of graphs
shows the effects of key rebound parameters
($\amacro{\eta}$, $p_E$, $\eqspsUC$, and $k$)
on energy rebound ($Re_{tot}$) and its components
($Re_{emb}$, $Re_{cap}$, $Re_{md}$, $Re_{dsub}$, $Re_{isub}$,
$Re_{dinc}$, $Re_{iinc}$, and $Re_{\macro}$).
In the graphs, 
nominal values for the rebound parameters are shown as points, 
and sensitivity trends are shown as lines. 
A limitation of each sensitivity analysis is noted.


%------------------------------
\subsubsection{Effect of efficiency ($\amacro{\eta}$)} 
\label{sec:effect_of_efficiency}
%------------------------------

<<efficiency_ratios, echo=FALSE>>=
car_efficiency_ratio <- (rebound_results %>% dplyr::filter(Case == "Car") %>% dplyr::select("eta_engr_units_star") / rebound_results %>% dplyr::filter(Case == "Car") %>% dplyr::select("eta_engr_units_orig")) %>% 
  unlist() %>% 
  formatC(digits = 3)

lamp_efficacy_ratio <- (rebound_results %>% dplyr::filter(Case == "Lamp") %>% dplyr::select("eta_engr_units_star") / rebound_results %>% dplyr::filter(Case == "Lamp") %>% dplyr::select("eta_engr_units_orig")) %>% 
  unlist() %>% 
  formatC(digits = 3)
@

Fig.~\ref{fig:eta_tilde_takeback_Sdot_sens_graph} shows that
both takeback and expected energy savings ($\Sdot$)
increase with post-EEU efficiency ($\amacro{\eta}$), 
but the relationship is asymptotic.
There are diminishing returns to increasing efficiency,
leading to saturation at very high efficiencies.

Saturation occurs because each additional increment of efficiency gain
leads to marginally less energy savings. 
A simple example illustrates.
A $\bempl{\eta} = 25$ mpg car drives $\bempl{q}_s = 100$ miles 
using $\bempl{E}_s = 4$ gallons of gasoline.
A more-efficient car ($\amacro{\eta} = 30$ mpg) is expected to use
$\aempl{E}_s = 3.33$ gallons to drive the same distance,
a savings of $\Sdot = 0.67$ gallons.
Another 5 mpg boost in efficiency (to $\amacro{\eta} = 35$ mpg)
will use $\aempl{E}_s = 2.86$ gal to drive 100 miles, 
a further expected savings of only $\Sdot = 0.47$ gallons.
Each successive 5 mpg boost in efficiency 
is expected to save less energy than the previous 5 mpg boost in efficiency.

Saturation can be seen mathematically, too.
Taking the limit as $\amacro{\eta} \rightarrow \infty$ 
in Eq.~(\ref{eq:Sdot}) gives $\Sdot = \rbempl{E}_s$, 
not $\infty$. 
Thus, efficiency saturation must occur.
Fig.~\ref{fig:eta_tilde_takeback_Sdot_sens_graph}
shows that the rebound framework correctly replicates the
expected efficiency saturation trends.

Saturation is especially noticeable in the lamp example
compared to the car example,
the difference being that 
the LED lamp is already much more efficient than the incandescent lamp
(\Sexpr{lamp_efficacy_ratio}$\times$),
whereas the hybrid car is only 
\Sexpr{car_efficiency_ratio}$\times$ as efficient as the gasoline car. 
Thus, at $\amacro{\eta} = \Sexpr{efficacy_better}$ lm-hr/W-hr, 
the energy efficient LED
is far closer to efficiency saturation than the hybrid vehicle 
(at $\amacro{\eta} = \Sexpr{mpg_better}$ mpg).
As a result, further increases in the LED lamp's efficiency 
are less effective than further increases in the hybrid car's efficiency.

Fig.~\ref{fig:eta_tilde_takeback_Sdot_sens_graph} shows that
expected energy savings ($\Sdot$) increase faster than takeback 
as $\ramacro{\eta}$ increases.
Thus, total rebound ($Re_{tot}$, the ratio of 
takeback to expected energy savings in Eq.~\ref{eq:Re_takeback}),
decreases as efficiency grows.
The lamp exhibits a relatively smaller rebound decline with efficiency,
because the lamp example is closer to saturation than the car example.

Fig.~\ref{fig:all_Re_terms_eta_graph} shows the variation of all rebound components
with post-EEU efficiency ($\amacro{\eta}$).
In the Car and Lamp examples, 
direct substitution rebound ($Re_{dsub}$) is the 
rebound component 
most sensitive to changes in post-EEU efficiency ($\amacro{\eta}$),

A limitation of the efficiency sensitivity analysis is that 
post-EEU efficiency ($\amacro{\eta}$)
is unlikely to be independent of other factors, 
such as capital expenditure rate ($\raempl{C}_{cap}$).
More-efficient devices are likely to be more expensive.


<<eta_tilde_takeback_Sdot_sens_graph, echo=FALSE, fig.cap="Expected energy savings ($\\Sdot$, solid line) and takeback (dashed line) sensitivity to post-EEU efficiency ($\\amacro{\\eta}$). (Note different $x$- and $y$-axis scales.)", fig.width=6, fig.height=4>>=
actual_cases <- rebound_data %>% 
  dplyr::filter(.data[[ReboundTools::eeu_base_params$case]] %in% c("Car", "Lamp"))

eta_sens_params = list(Car = list(eta_engr_units_star = seq(35, 50, by = 0.5)), 
                       Lamp = list(eta_engr_units_star = seq(70000, 90000, by = 5000)))

eta_sens_data <- ReboundTools::parametric_analysis(original_cases = actual_cases,
                                                   parameterization = eta_sens_params) %>%
  dplyr::mutate(
    takeback = .data[[ReboundTools::rebound_terms$Re_tot]] * .data[[ReboundTools::star_vars$S_dot_dev]]
  )

# This is a hacky formatter function 
# that formats the x-axis numbers of the graphs.
# The argument x_breaks is the breaks for an axis.
# The function checks to see if the breaks are > 1000 and divides by 1000 in that case.
# This approach works, because lm-hr/kW-hr values are > 1000 for the lamp example
# but the car example has mpg (which are all less than 100).
# So this function divides the Lm-hr/kW-hr values by 1000 while leaving the mpg values unchanged.
eta_tilde_formatter <- function(x_breaks) {
  if (all(x_breaks > 1000)) {
    # To convert Lm-hr/kW-hr to Lm-hr/W-hr.
    return(x_breaks/1000)
  }
  # To leave mpg alone.
  return(x_breaks)
}

sensitivity_graphs(.parametric_data = eta_sens_data,
                   x_var = "eta_engr_units_star", 
                   y_var = c(ReboundTools::star_vars$S_dot_dev, "takeback")) +
  ggplot2::facet_wrap(facets = "Case", scales = "free") +
  ggplot2::scale_x_continuous(labels = eta_tilde_formatter) +
  ggplot2::scale_y_continuous(limits = c(0, NA)) +
  ggplot2::scale_colour_manual(values = c(S_dot_dev = "black", takeback = "black"), guide = FALSE) + 
  ggplot2::scale_size_manual(values = c(S_dot_dev = 0.5, takeback = 0.5), guide = FALSE) + 
  ggplot2::scale_linetype_manual(values = c(S_dot_dev = "solid", takeback = "dashed"), guide = FALSE) +
  ggplot2::labs(x = expression(tilde(eta)*" [mpg (Car) or lm-hr/W-hr (Lamp)]"),
                y = expression("Takeback and "*dot(S)[dev]*" [MJ/yr]"),
                colour = ggplot2::element_blank(),
                size = ggplot2::element_blank(),
                linetype = ggplot2::element_blank()) +
  MKHthemes::xy_theme()
@


<<all_Re_terms_eta_graph, echo=FALSE, fig.cap="Sensitivity of rebound components to post-EEU efficiency ($\\amacro{\\eta}$).", fig.width=6, fig.height=4>>=
Re_graph_params <- ReboundTools::sens_graph_params
Re_graph_params[["include_x_axis"]] <- TRUE
Re_graph_params[["use_latex_legend"]] <- TRUE

Re_terms_order <- ReboundTools::rebound_terms[c(ReboundTools::rebound_terms$Re_tot,
                                                ReboundTools::rebound_terms$Re_macro,
                                                ReboundTools::rebound_terms$Re_dinc,
                                                ReboundTools::rebound_terms$Re_iinc,
                                                ReboundTools::rebound_terms$Re_dsub,
                                                ReboundTools::rebound_terms$Re_isub,
                                                ReboundTools::rebound_terms$Re_dempl,
                                                ReboundTools::rebound_terms$Re_emb,
                                                ReboundTools::rebound_terms$Re_md)] %>% 
  unlist()

rebound_terms_graph(rebound_data = actual_cases, parameterization = eta_sens_params, 
                    x_var = "eta_engr_units_tilde", 
                    Re_terms = Re_terms_order,
                    graph_params = Re_graph_params) +
  ggplot2::facet_wrap(facets = "Case", scales = "free_x") + 
  ggplot2::scale_x_continuous(labels = eta_tilde_formatter) +
  ggplot2::labs(x = expression(tilde(eta)*" [mpg (Car) or lm-hr/W-hr (Lamp)]"),
                y = "Re values [-]",
                colour = ggplot2::element_blank(),
                size = ggplot2::element_blank(),
                linetype = ggplot2::element_blank()) +
  MKHthemes::xy_theme() + 
  ggplot2::theme(legend.text.align = 0)
@


%------------------------------
\subsubsection{Effect of energy price ($p_E$)} 
\label{sec:effect_of_energy_price}
%------------------------------

<<Germany_results, echo=FALSE>>=
# In the calculations, we include same parameters for German energy prices.
# Extract that information here for use in the paragraph below.
Car_Germany_Re_tot <- rebound_results %>% 
  dplyr::filter(Case == "Car - Germany") %>% 
  dplyr::select("Re_tot")
Lamp_Germany_Re_tot <- rebound_results %>% 
  dplyr::filter(Case == "Lamp - Germany") %>% 
  dplyr::select("Re_tot")
@


The effect of energy price on rebound is shown in Fig.~\ref{fig:all_Re_terms_p_E_graph}.
Increasing energy prices lead to larger total rebound ($Re_{tot}$),
because higher energy prices lead to more freed cash 
to be re-spent by the device owner.
All other things being equal, more freed cash leads to 
more spending on other goods and services that demand energy.

Fig.~\ref{fig:all_Re_terms_p_E_graph} also 
shows the effect of energy price ($p_E$)
on all rebound components.
Most rebound components increase with energy price, 
with the examples exhibiting different sensitivities. 
Substitution effects ($Re_{dsub}$ and $Re_{isub}$)
are the only rebound components that decrease with energy price ($p_E$).
Substitution effects decrease with energy price, because 
at high energy price, less behavior adjustment is needed to re-equilibrate 
after emplacement of the energy efficient device.

German energy prices%
\footnote{
  For the car example,
  the gasoline price in Germany is taken as 1.35 \euro{}/liter for ``super gasoline'' (95 octane),
  an approximate average price over the last five years~\citep{finanzen}.
  For the lamp example,
  the electricity price in Germany is taken as 0.3 \euro{}/kW-hr~\citep{bundesministerium}.
  Converting currency (at 1 \euro{} = 1.21 USD) and
  physical units gives 6.18~\$/gallon and 0.363~\$/kW-hr.}
%
are shown as vertical lines,
providing an indication of possible energy price variations.
All other things being equal, 
if U.S.\ residents paid Germany's electricity prices,
energy rebound would be 
\Sexpr{formatC(unlist(Car_Germany_Re_tot * 100), digits = 3)}\%
for the car example and 
\Sexpr{formatC(unlist(Lamp_Germany_Re_tot * 100), digits = 3)}\%
for the lamp example.

A limitation of the energy price sensitivity analysis arises from the fact that
energy price is not independent of other parameters.
Indeed, other rebound parameters
would change along with energy price
(especially if moving from one country to another),
including capital expenditure rate ($\raempl{C}_{cap}$), 
maintenance and disposal expenditure rate ($\raempl{C}_{\md}$),
energy intensity of the economy ($I_E$), and
energy service consumption rates ($\rbempl{q}_s$).




<<all_Re_terms_p_E_graph, echo=FALSE, fig.cap="Sensitivity of rebound components to energy price ($p_E$).", fig.width=6, fig.height=4>>=
 p_E_sens_params <- list(Car = list(p_E_engr_units = seq(1, 8, by = 0.5)),
                         Lamp = list(p_E_engr_units = seq(0.05, 0.4, by = 0.01)))

 price_data <- tibble::tribble(~Case, ~Country, ~p_E_engr_units,
 #                               "Car", "GBR", 6.48,     # $/gal
 #                               "Lamp", "GBR", 0.28,    # $/W-hr
                               "Car", "DEU", 6.18,     # $/gal
                               "Lamp", "DEU", 0.363)   # $/W-hr
rebound_terms_graph(rebound_data = actual_cases, parameterization = p_E_sens_params, 
                    x_var = "p_E_engr_units", 
                    Re_terms = Re_terms_order,
                    graph_params = Re_graph_params) +
  ggplot2::geom_vline(data = price_data, 
                      mapping = ggplot2::aes_string(xintercept = "p_E_engr_units"), 
                      size = 0.1) +
  ggplot2::scale_y_continuous(breaks = seq(-0.2, 1, by = 0.2)) +
  ggplot2::facet_wrap(facets = "Case", scales = "free_x") + 
  ggplot2::labs(x = expression(p[E]*" [$/gal (Car) or $/kW-hr (Lamp)]"),
                y = "Re values [-]",
                colour = ggplot2::element_blank(),
                size = ggplot2::element_blank(),
                linetype = ggplot2::element_blank()) +
  MKHthemes::xy_theme() +
  ggplot2::theme(legend.text.align = 0)
@


%------------------------------
\subsubsection{Effect of elasticity ($\eqspsUC$)} 
\label{sec:effect_of_elasticity}
%------------------------------

Fig.~\ref{fig:all_Re_terms_eps_graph} shows the variation of total rebound ($Re_{tot}$)
with uncompensated own-price elasticity of energy service consumption ($\eqspsUC$).
The effect is exponential:
total rebound increases with larger negative values of $\eqspsUC$, as expected.
The lamp example shows stronger exponential variation than the car example.
Fig.~\ref{fig:all_Re_terms_eps_graph} shows that direct substitution rebound 
($Re_{dsub}$) is the most sensitive rebound component to changes in $\eqspsUC$.
For the lamp example, indirect income rebound ($Re_{iinc}$) also increases
substantially with $\eqspsUC$, 
because freed cash increases substantially with $\eqspsUC$ in the lamp example. 

A limitation of the elasticity sensitivity study derives from limitations of the 
CES utility model itself, 
namely that numerical extremes are approached only asymptotically. 
**** Gregor to add more intelligence here. ---MKH ****
Indeed, uneconomic conditions should be avoided.
For example, negative direct substitution rebound ($Re_{dsub} < 0$)
is obtained when $\left| \eqspsUC \right| < \fCs$,
because Eq.~(\ref{eq:sigma}) pushes 
the elasticity of substitution negative ($\sigma < 0$).
In reality, smaller negative (closer to 0) uncompensated own price elasticity ($\eqspsUC$)
would correlate with a smaller fraction of expenses spent on the energy service ($\fCs$), 
thereby avoiding the uneconomic condition.
However, multi-variate dynamics are not captured by univariate sensitivity studies.
**** Gregor: is the above correct? ---MKH ****


<<all_Re_terms_eps_graph, echo=FALSE, fig.cap="Sensitivity of rebound components to uncompensated energy service price elasticity of energy demand ($\\eqspsUC$). (Note reversed $x$-axis scale.)", fig.width=6, fig.height=4>>=
eps_sens_params <- list(Car = list(e_qs_ps_UC = seq(-0.7, -0.1, by = 0.01)),
                        Lamp = list(e_qs_ps_UC = seq(-0.7, -0.1, by = 0.01)))

rebound_terms_graph(rebound_data = actual_cases, parameterization = eps_sens_params,
                    x_var = "e_qs_ps_UC", 
                    Re_terms = Re_terms_order,
                    graph_params = Re_graph_params) +
  ggplot2::facet_wrap(facets = "Case", scales = "free_x") +
  ggplot2::scale_x_reverse() +
  ggplot2::labs(x = expression(epsilon[dot(q)[s]*","*p[s]]),
                y = "Rebound terms [-]",
                colour = ggplot2::element_blank(),
                size = ggplot2::element_blank(),
                linetype = ggplot2::element_blank()) +
  MKHthemes::xy_theme() +
  ggplot2::theme(legend.text.align = 0)
@


%------------------------------
\subsubsection{Effect of macro factor ($k$)} 
\label{sec:effect_of_macro_factor}
%------------------------------

The sensitivity of energy rebound 
to the macro factor ($k$) is shown 
in Fig.~\ref{fig:all_Re_terms_k_graph}.
The macro factor has a linear effect on total rebound
through the macro rebound component ($Re_{\macro}$).
All other rebound components are constant as $k$ changes.

A limitation of the macro factor sensitivity analysis is that
the macro factor ($k$) is unlikely to be 
independent of $I_E$, because 
different values of $k$ imply a different macro-economy.


<<all_Re_terms_k_graph, echo=FALSE, fig.cap="Sensitivity of rebound components to the macro factor ($k$).", fig.width=6, fig.height=4>>=
k_sens_params <- list(Car = list(k = seq(0.5, 2.0, by = 0.5)),
                      Lamp = list(k = seq(0.5, 2.0, by = 0.5)))

rebound_terms_graph(rebound_data = actual_cases, parameterization = k_sens_params,
                    x_var = "k", 
                    Re_terms = Re_terms_order,
                    graph_params = Re_graph_params) +
  ggplot2::scale_y_continuous(breaks = seq(-0.2, 0.8, by = 0.2)) + 
  ggplot2::facet_wrap(facets = "Case", scales = "free_x") +
  ggplot2::labs(x = expression("k [-]"),
                y = "Rebound terms [-]",
                colour = ggplot2::element_blank(),
                size = ggplot2::element_blank(),
                linetype = ggplot2::element_blank()) +
  MKHthemes::xy_theme() +
  ggplot2::theme(legend.text.align = 0)
@




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Discussion}
\label{sec:discussion}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

The framework presented here is the first to our knowledge
to integrate all components of the microeconomic rebound or
alternatively the sum of direct and indirect rebound 
for consumers in an analytically consistent 
yet numerically precise, operationalizable manner. 
The sets of three graphs that simultaneously 
trace energy demand, expenditure, and consumption 
decision for every rebound component summarize 
this integration. 
While the possibility of decomposing direct and indirect rebound effects 
into substitution and income effects was 
adumbrated by \citet{Khazzoom1980}, 
clearly spelt out by \citet{greening2000}, and
considerably developed by \citet{Borenstein:2015aa}, 
applications that analyze direct and indirect rebound
typically only draw a stylized graph 
of the consumption space with indifference curves 
to highlight substitution and income effects 
and then revert to working directly with demand functions
from the almost ideal demand system \citep{Thomas:2013aa,Moshiri2017,Li2018}. 
Since the present framework works directly with utility maximization and 
exactly calculates effects in both energy and consumption space,
it helps build intuition how behavioral income and substitution effects hang together 
with energy rebound effects. 
For instance, in the car example,
the substitution component of the direct rebound
(the \chat{} segment in Fig.~\ref{fig:CarEnergyGraph}) 
is larger than the income component of direct rebound 
(segment \hatd{}). 
In other words, most of the additional, 
energy-intensive energy service ``transport'' 
occurs as a result of the price decline, 
not the freed cash.
Policy seeking to simultaneously push energy efficiency and
limit the rebound effect might therefore
be more effective when seeking to make driving more costly to limit 
substitution, 
rather than taxing away the freed cash to limit income effects, 
an intuition that accords with the results in \citet{Hart2018}, 
who finds high rebounds when innovating in energy intensive industry, 
like gasoline-powered transport.

This approach also rigorously incorporates
the ``cost of making efficiency improvements'' \citep{Gillingham:2013aa},
both in monetary terms and energy terms,
which is not typically included in estimates \citep{Azevedo2014,Gillingham:2020aa}.
The emplacement effect distributes costs and embodied energy demand
evenly across the device's lifetime.%
\footnote{
  Introducing time preference would complicate the calculation but
  leave the qualitative results intact.
}
The monetary effects are
then introduced as a lumpsum tax/subsidy
added to freed cash after the compensating variation, and
thereby increases or decreases the income effect,
as \citet{Gillingham2016a} suggests doing.
In particular this treatment allows to accommodate straightforwardly
the ``zero-cost breakthrough'' approach,
where the efficiency improvement is gifted to the device owner
as well as the ``policy-induced'' improvement \citep{Gillingham2016}.
Intriguingly, while the policy-induced effect
is typically seen as reducing freed cash and hence income effects
(e.g.. by mandating to buy more efficient and costly appliances),
the car example above shows that a tax rebate leads to a lower annual spend
once the existing tax rebate in the United States is considered
(segments \ab{} and \bstar{} in Fig.~\ref{fig:CarCostGraph}),
at least when the car purchase is made when the device
owner needed to replace the device anyway.%
\footnote{
  An early purchase, say due to impending bans
  on certain internal combustion engine cars,
  can also be modeled by adjusting the capital costs
  to account for the lower cost had the old car been kept.
}
At the same time,
the higher embodied energy of the hybrid car
already leads to a slightly positive emplacement rebound
(Fig.~\ref{fig:ExamplePrefsPathGraph}).
LED lamps also increase freed cash and also reduce embodied energy demand
at the emplacement stage
as their longer lifetime more than makes up for their higher installation costs.
This illustrates a policy trade-off:
subsidizing more efficient devices can incentivize uptake.
It can also increase rebound effects,
but at the income stage as more freed cash is available
from emplacement as shown in the expenditure graphs in
Figs.~\ref{fig:CarCostGraph} and~\ref{fig:LampCostGraph}
(segments \ab{} and \bstar{}).
Of course, even if the efficient option is relatively cheap, 
real-world liquidity constraints can still prevent device owners
from making any upgrade at all \citep{Fowlie2018}.

The framework also links to the total or economy-wide rebound literature
by relating the size of macroeconomic rebound 
to that of the microeconomic rebound 
in a term that corresponds to magnitudes in the microeconomic framework. 
As noted in the introduction *** to revisit --- GS ***, 
an increasing number of studies compute an economy-wide rebound. 
The indirect rebound effect is not typically reported separately 
as changes in all prices 
lead to a mix of income 
(holding prices of other goods constant) and
general equilibrium rebound effects (letting prices adjust). 
Yet classifications continue to distinguish 
indirect and macroeconomic rebound effects \citep{Colmenares2020,Brockway2021}. 
The macroeconomc factor ($k$) in our framework
allows to build intuition for how large macroeconomic rebounds are
relative to microeconomic ones, 
depending on what total rebound is considered likely. 
By interpreting it **** antecedent? **** as multiples of the expected freed cash 
from a zero-rebound improvement, 
it is a natural link to Hultens theorem, 
that postulates aggregate growth to be proportional to individual or sectoral 
efficiency improvements and their (Domar) weight in the economy 
\citep{Hulten1978}. 
Since it **** antecedent? **** is expressed in monetary terms, 
it **** antecedent? **** relates well to a microeconomic ``freed cash''
multiplier $k$.
It **** antecedent **** also relates to `multiplier effects' discussions in 
\citet{Borenstein:2015aa} and \citet{Gillingham2016} but
derives these **** antecedent? **** from supply-side productivity increases
at the root of the kind of growth involved in macroeconomic rebound, 
not from a demand-driving increase in spending 
without a prior productivity increase. 
Since Hulten's theorem is only an approximation and 
economy-wide rebound effects are large relative to
estimates of microeconomic rebound, 
this **** antecedent? **** also opens up questions 
about nonlinearities recently stressed by \citet{Baqaee2019}, and
confirmed at the sectoral level as impacting rebounds by \citet{blackburn2020energy}.

One limitation of the present framework is that it focuses only on consumers. 
However, the choice to focus on them comes naturally from a desire 
to build on the strong foundations by \citet{Borenstein:2015aa} and others 
in the hope of elucidating how their conceptual models can be precisely unified, and
the widespread discussion of substitution and income effects from consumer theory. 
Moreover, thanks to the strong parallels between consumer and producer theory, 
it is a relatively small step to converting the results to an application to producers. 
To keep the exposition tractable, here we only show the consumer side.

Within the consumer framework, 
another limitation is the use of a CES production function, 
with its homotheticity of preferences forcing non-satiation.
Its strength is a relatively straightforward derivation of results, and
hence tractability of results. 
We provide a tool to users where they can make alternative assumptions 
to generate non-homothetic preferences (satiation) 
by using an approximate version that operates with constant elasticities 
as in Borenstein *** check this with 
Matt --- G ***. 
%Gregor did you want this ref in section 2 methods or
%section 4 discussion / elsewhere?
%\citet{Safarzynska2018},

%Section 4 Discussion  when comparing our car rebound to others.  
%\citet{Galvin2020}

%Of course, this generality between energy on the one hand
%and other inputs (XXXXX and labor) on the other hand
%raises the question whether it is appropriate to speak of a rebound effect at all.
%Isn't all technological progress just a rebound effect?
%We put it the opposite way:
%macroeconomic rebound effects are the consequences of technological change,
%whether
%in utilization of XXXXXX,
%in utilization of labor, or
%in utilization of energy.

At our meeting of 11 March, we brainstormed these topics for the Discussion:

Focus on consequences of comprehensive framework
%
\begin{enumerate}

  \item Saturated demand (service price elasticity of energy service consumption = 0) 
        may still lead to rebound, because of rebound effects elsewhere in the system

  \item Clear picture of significance of each rebound mechanism is available 
        from the framework. 
        Thus, can formulate policy options to mitigate the largest rebound effects
  
  \item Provide a list of policies that mitigate each rebound effect
  
  \item Graphs clarify understanding of disparate discussions of rebound effects. 
        Engineers start with energy path graph.
        Accountants and business leaders start with cost path graph.
        Economists start with preferences path graph. 
        But they all hang together.
        
  \item Clarification of k factor

\end{enumerate}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Conclusions (MKH, 500 words)}
\label{sec:conclusion}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Restate characteristics of the framework.
Re-visit the benefits discussed in Section~\ref{sec:aim_contribution_structure}.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Competing interests}
\label{sec:competing_interests}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Declarations of interest: none


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Author contributions}
\label{sec:author_contributions}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\textbf{Matthew Kuperus Heun}: 
Conceptualization, 
Formal analysis, 
Resources, 
Software, 
Supervision, 
Validation,
Visualization,
Roles/Writing--original draft,
Writing--review \& editing.
\textbf{Gregor Semienuik}: 
Conceptualization, 
Formal analysis, 
Roles/Writing--original draft,
Writing--review \& editing.
\textbf{Paul Brockway}: 
Conceptualization, 
Data curation, 
Formal analysis, 
Investigation, 
Validation, 
Roles/Writing--original draft,
Writing--review \& editing.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Data repository}
\label{sec:data_repository}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

All data and calculations are stored at **** Leeds data repository URL. ****.
An \texttt{R} package for performing all rebound calculations
can be found at \url{https://github.com/MatthewHeun/ReboundTools}.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Acknowledgements}
\label{sec:acknowledgements}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

List funding sources in this standard way to facilitate compliance to funder's requirements:
Funding: This work was supported by the National Institutes of Health [grant numbers xxxx, yyyy]; 
the Bill \& Melinda Gates Foundation, Seattle, WA [grant number zzzz];
and the United States Institutes of Peace [grant number aaaa].

It is not necessary to include detailed descriptions on the program or type of grants and awards.
When funding is from a block grant or other resources available to
a university, college, or other research institution, 
submit the name of the institute or organization that provided the funding.

If no funding has been provided for the research, please include the following sentence:
This research did not receive any specific grant from funding agencies 
in the public, commercial, or not-for-profit sectors.

**** Also list internal reviewers. ****

Tiago Domingoes, Jeremy Van Antwerp, Zeke Marshall

Internal reviewers
Adam Marquardt (Calvin University), 
Paul Steenwyk (Calvin University), and 
****
contributed substantially to the quality of the framework and the manuscript. 

The authors benefitted from discussions with Daniele Girardi and Christopher Blackburn.

The authors thank the students of M.K.H.'s Fall 2019 Thermal Systems Design course (ENGR333) 
who studied energy rebound of many energy conversion devices
using an early version of this framework.

% No need for this section label, because BibTeX already provides a "References" heading.
% \section*{References}

\bibliography{HSB_refs}



\appendix
\counterwithin{figure}{section}
\counterwithin{table}{section}

% Gives a helpful "Appendix" label
\section*{Appendix}

% Labels each appendix as A, B, C, etc. instead of Appendix A, Appendix B, Appendix C, etc.
\renewcommand{\thesection}{\Alph{section}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Nomenclature}
\label{sec:nomenclature}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{pieces/nomenclature.tex}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Derivation of comprehensive rebound framework}
\label{sec:derivation}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{pieces/derivation.tex}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Mathematical details of rebound path graphs}
\label{sec:graph_details}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{pieces/rebound_path_graph_details.tex}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Utility models and elasticities}
\label{sec:utility_and_elasticities}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% \input{pieces/utility_and_elasticities.Rnw}
<<UtilityAppendix,child="pieces/utility_and_elasticities.Rnw">>=
@



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Proof: Income preference equations satisfy the budget constraint}
\label{sec:proof_income_elasticities}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{pieces/proof_income_elasticities.tex}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Other goods expenditures and constant $p_o$}
\label{sec:other_goods_expenditures}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\input{pieces/other_goods_expenditures.tex}



\end{document}
