% The next command tells RStudio to do "Compile PDF" on HSB.Rnw,
% instead of this file, thereby eliminating the need to switch back to HSB.Rnw 
% before building the paper.
%!TEX root = ../HSB.Rnw


As discussed in Section~\ref{sec:sub_effect_main_paper}
and Appendix~\ref{sec:Re_sub}, 
the substitution effect requires a model for device owner utility
that compares the perceived benefits of 
consuming the energy service ($\rate{q}_s$) and
consuming other goods and services ($\rate{q}_o$).
In this paper, we describe two utility models.

One utility model is an approximate utility model
described in Appendix~\ref{sec:Resub_approximate_method}.
The approximate model applies when
changes in energy service price are small ($\Delta \aempl{p}_s \approx 0$), 
an assumption that is untrue for emplacement of a more-efficient energy conversion device.
The approximate model is discussed for continuity with the literature.
(See, for example, \citet{Borenstein:2015aa}.)

The other utility model is the CES utility model used in the rebound framework.
(See Section~\ref{sec:sub_effect_main_paper}.)
Both utility models rely upon elasticities to estimate consumption utility.

Like the substitution effect,
the income effect employs elasticities
to describe the proportion of net income spent on the energy service
or other goods and sercices.

In this appendix,
elasticities for the income effect are discussed briefly. 
Thereafter, the approximate and CES utility functions are described.
Finally, elasticities for the substitition effect are 
discussed.


%++++++++++++++++++++++++++++++
\subsection{Elasticities for the income effect}
\label{sec:income_elasticities}
%++++++++++++++++++++++++++++++

The income effect requires two elasticities to 
estimate the respending of net income:
the income elasticity of energy service consumption ($\eqsM$) and
the income elasticity of other goods consumption ($\eqoM$).
Due to homotheticity,
both income elasticities are assumed unitary. 
Thus, 

\begin{equation} \label{eq:eqsM}
  \eqsM = 1 \; ,
\end{equation}
%
and

\begin{equation} \label{eq:eqoM}
  \eqoM = 1 \; .
\end{equation}


%++++++++++++++++++++++++++++++
\subsection{Utility models for the substitution effect}
\label{sec:utility_models_sub}
%++++++++++++++++++++++++++++++

A utility model gives the ratio of energy service consumption rate 
and other goods consumption rates across the substition effect
($\frac{\rasub{q}_s}{\rorig{q}_s}$ and 
$\frac{\rasub{q}_o}{\rorig{q}_o}$, 
respectively).
In so doing, 
utility models quantify the decrease in other goods consumption
($\frac{\rasub{q}_o}{\rorig{q}_o} < 1$)
caused by the increase of energy service consumption
($\frac{\rasub{q}_s}{\rorig{q}_s} > 1$)
resulting from the decrease of the energy service price ($\aempl{p}_s < \orig{p}_s$).
Across the substitution effect, 
the utility increase of the larger energy service consumption rate
must be exactly offset
by the utility decrease of the smaller other goods consumption rate.

Before proceeding the with utility models,
we note that the rate of other goods consumption ($\rate{q}_o$)
is not known independently from the prices of other goods ($p_o$).
With the assumption that the prices of other goods do not change
across rebound effects
(i.e., $p_o$ is exogenous), 
the ratio of other goods consumption is equal to 
the ratio of other goods spending, such that

\begin{equation} \label{eq:exogenous_p_o}
  \frac{\rate{q}_o}{\rbempl{q}_o} 
      = \frac{\rate{C}_o/\cancel{p_o}}{\rbempl{C}_o/\cancel{p_o}} 
      = \frac{\rate{C}_o}{\rbempl{C}_o}
\end{equation}
%
at all rebound stages. 
(See Fig.~\ref{fig:flowchart}.)


%------------------------------
\subsubsection{Approximate utility model} 
\label{sec:derivation_approx_utility_model}
%------------------------------

The approximate utility model is given by Eqs.~(\ref{eq:approx_qshat_over_qsorig})
and~(\ref{eq:Cdot_o_ratio}).
The equations for the approximate utility model are repeated here
for convenience.

\begin{equation} 
  \frac{\rasub{q}_s}{\rbempl{q}_s}
      = \left( \frac{\aprod{\eta}}{\bempl{\eta}} \right)^{-\eqsps} 
        \tag{\ref{eq:approx_qshat_over_qsorig}}
\end{equation}

\begin{equation}
  \frac{\rasub{C}_o}{\rorig{C}_o}
      = \frac{\rasub{q}_o}{\rorig{q}_o}
      = \left( \frac{\aprod{\eta}}{\bempl{\eta}} \right)^{-\eqops} \tag{\ref{eq:Cdot_o_ratio}}
\end{equation}


%------------------------------
\subsubsection{CES utility model}
\label{sec:derivation_ces_utility}
%------------------------------

The CES utility model is given by Eqs.~(\ref{eq:q_s_solution}) and~($\ref{eq:C_o_solution}$).
Here, its derivation is shown.

The constant elasticity of substitution (CES) model for utility ($\rate{u}$)
is normalized by (indexed to) parameters before emplacement:

\begin{equation}
  \frac{\rate{u}}{\rbempl{u}} = 
  \left[ a \left( \frac{\rate{q}_s}{\rbempl{q}_s} \right)^\rho 
        + (1-a) \left( \frac{\rate{q}_o}{\rbempl{q}_o} \right)^\rho  \right]^{(1/\rho)} \; ,
\end{equation}
%
where $\rho = \frac{\sigma - 1}{\sigma}$,
$a$ is a share parameter (determined below), and 
$\sigma$ is the elasticity of substitution between
the normalized consumption rate of the energy service and 
the normalized consumption rate of other goods.

With the assumption of exogenous other goods prices 
in Eq.~(\ref{eq:exogenous_p_o}), 
we find

\begin{equation} \label{eq:ces_utility_with_a}
  \frac{\rate{u}}{\rbempl{u}} = 
  \left[ a \left( \frac{\rate{q}_s}{\rbempl{q}_s} \right)^\rho 
        + (1-a) \left( \frac{\rate{C}_o}{\rbempl{C}_o} \right)^\rho  \right]^{(1/\rho)} \; .
\end{equation}
%
Eq.~(\ref{eq:ces_utility_with_a}) is the functional form of the CES utility model,
whose share parameter ($a$) is yet to be determined.

The correct expression for the share parameter ($a$) is found from the 
equilibrium requirement,
namely that the slope of the indifference curve is tangent to 
(has the same slope as) the expenditure curve
in $\rate{C}_o/\rbempl{C}_o$ vs.\ $\rate{q}_s/\rbempl{q}_s$ space.

To find the slope of the indifference curve,
Eq.~(\ref{eq:ces_utility_with_a}) can be rearranged to find 
the normalized consumption rate of other goods ($\rate{C}_o/\rbempl{C}_o$)
as a function of the normalized consumption rate of the energy service
($\rate{q}_s/\rbempl{q}_s$)
and the normalized utility rate ($\rate{u}/\rbempl{u}$):

\begin{equation} \label{eq:utility_Co_form}
  \frac{\rate{C}_o}{\rbempl{C}_o} = 
      \left[ \frac{1}{1 - a} \left( \frac{\rate{u}}{\rbempl{u}} \right)^\rho 
            - \frac{a}{1 - a} \left( \frac{\rate{q}}{\rbempl{q}_s} \right)^\rho \right]^{(1/\rho)} \; ,
\end{equation}
%
a form convenient for graphing 
constant utility rate ($\rate{u}/\rbempl{u}$) indifference curves in 
$\rate{C}_o/\rbempl{C}_o$ vs.\ 
$\rate{q}_s/\rbempl{q}_s$ space.
(See Appendix~\ref{sec:graph_details} and
Figs.~\ref{fig:ExamplePrefsPathGraph}, 
\ref{fig:CarPrefsGraph}, and 
\ref{fig:LampPrefsGraph}.)
In $\rate{C}_o/\rbempl{C}_o$ vs.\ $\rate{q}_s/\rbempl{q}_s$ space, 
the slope of an indifference curve is given by 

\begin{align} \label{eq:slope_indifference_curve}
  \frac{\partial (\rate{C}_o/\rbempl{C}_o)}{\partial (\rate{q}_s/\rbempl{q}_s)} =&
        -\frac{a}{1 - a} \left( \frac{\rate{q}_s}{\rbempl{q}_s} \right)^{(\rho -1)} \nonumber  \\
        &\times \left[ \left( \frac{1}{1 - a} \right) \left( \frac{\rate{u}}{\rbempl{u}} \right)^\rho
                - \left( \frac{a}{1 - a} \right) 
                          \left( \frac{\rate{q}}{\rbempl{q}_s} \right)^\rho \right]^{(1 - \rho)/\rho} \; .
\end{align}

The budget constraint is the starting point for finding 
the slope of the expenditure line in 
$\rate{C}_o/\rbempl{C}_o$ vs.\ $\rate{q}_s/\rbempl{q}_s$ space:

\begin{equation}
  \rate{M} = p_s \rate{q}_s + \rate{C}_{cap} + \rate{C}_{\md} + \rate{C}_o  + \rate{N} \; . 
\end{equation}
%
Solving for $\rate{C}_o$ and judiciously multiplying by $\rbempl{C}_o/\rbempl{C}_o$
and $\rbempl{q}_s/\rbempl{q}_s$ gives

\begin{equation}
  \frac{\rate{C}_o}{\rbempl{C}_o} \rbempl{C}_o = - p_s \frac{\rate{q}_s}{\rbempl{q}_s} \rbempl{q}_s
                        + \rate{M} - \rate{C}_{cap} - \rate{C}_{\md}  - \rate{N} \; .
\end{equation}
%
Solving for $\rate{C}_o/\rbempl{C}_o$ and rearranging gives

\begin{equation}
  \frac{\rate{C}_o}{\rbempl{C}_o} = - \frac{p_s \rbempl{q}_s}{\rbempl{C}_o}  
                                        \left( \frac{\rate{q}_s}{\rbempl{q}_s}   \right)
                                    + \frac{1}{\rbempl{C}_o}
                                          (\rate{M} - \rate{C}_{cap} - \rate{C}_{\md} - \rate{N}) \; ,
\end{equation}
%
from which the slope in $\rate{C}_o/\rbempl{C}_o$ vs.\ $\rate{q}_s/\rbempl{q}_s$ space
is taken by inspection to be

\begin{equation} \label{eq:slope_expenditure_line}
  \frac{\partial (\rate{C}_o/\rbempl{C}_o)}{\partial (\rate{q}_s/\rbempl{q}_s)} =
              - \frac{p_s \rbempl{q}_s}{\rbempl{C}_o} \; .
\end{equation}

At any equilibrium point, the expenditure line must be tangent to its indifference curve.
Applying the tangency (equal slope) requirement before emplacement enables 
solving for the correct expression for $a$.
Setting the slope of the expenditure line (Eq.~(\ref{eq:slope_expenditure_line}))
equal to the slope of the indifference curve (Eq.~(\ref{eq:slope_indifference_curve})) gives

\begin{align}
  - \frac{p_s \rbempl{q}_s}{\rbempl{C}_o} =& 
        -\frac{a}{1 - a} \left( \frac{\rate{q}_s}{\rbempl{q}_s} \right)^{(\rho -1)} \nonumber \\
        &\times \left[ \left( \frac{1}{1 - a} \right) \left( \frac{\rate{u}}{\rbempl{u}} \right)^\rho
                - \left( \frac{a}{1 - a} \right) 
                          \left( \frac{\rate{q}}{\rbempl{q}_s} \right)^\rho \right]^{(1 - \rho)/\rho} \; .
\end{align}
%
For the equilibrium point 
prior to emplacement, $\rate{q}_s/\rbempl{q}_s = 1$, $\rate{u}/\rbempl{u} = 1$, and
$p_s = \bempl{p}_s$, which yields

\begin{equation}
  - \frac{\bempl{p}_s \rbempl{q}_s}{\rbempl{C}_o} =
        -\frac{a}{1 - a} (1)^{(\rho -1)}
        \left[ \left( \frac{1}{1 - a} \right) (1)^\rho
                - \left( \frac{a}{1 - a} \right) 
                          (1)^\rho \right]^{(1 - \rho)/\rho} \; .
\end{equation}
%
Simplifying gives

\begin{equation}
  \frac{\bempl{p}_s \rbempl{q}_s}{\rbempl{C}_o} = \frac{a}{1 - a} \; .
\end{equation}
%
Recognizing that $\bempl{p}_s \rbempl{q}_s = \rbempl{C}_s$ and solving for
$a$ gives

\begin{equation}
  a = \frac{\rbempl{C}_s}{\rbempl{C}_s + \rbempl{C}_o} \; ,
\end{equation}
%
which is called $\fCs$, 
the share of energy service expenditure ($\rbempl{C}_s$) 
relative to the sum of energy service and other goods expenditures 
($\rbempl{C}_s + \rbempl{C}_o$) 
before emplacement.
Thus, the CES utility equation becomes

\begin{equation} 
    \frac{\rate{u}}{\rbempl{u}} = \cesutility{} \; , \tag{\ref{eq:ces_utility}}
\end{equation}
%
with 

\begin{equation} \label{eq:fCs}
  \fCs \equiv \frac{\rorig{C}_s}{\rorig{C}_s + \rorig{C}_o} \; .
\end{equation}

We note briefly that 
a common model of utility takes the form of a Cobb-Douglas function

\begin{equation} \label{eq:CD_utility}
  \rate{u}(\rate{q}_s,\rate{q}_o) = A \rate{q}_s^\alpha \rate{q}_o^{1 - \alpha} \; ,
\end{equation}
%
where $A$ is a proportionality constant and
$\alpha \in (0,1)$ gives the relative importance to utility
of consumption of the energy service ($\rate{q}_s$)
relative to consumption of other goods ($\rate{q}_o$).
However, the uncompensated own-price elasticity ($\eqspsUC$)
in the Cobb-Douglas utility model is $-1$,
causing $Re_{dsub} = 1$ always.

**** Gregor: Is the uncompensated own-price elasticity ($\eqspsUC$) $-1$
or is the compensated own-price elasticity ($\eqsps$) $-1$?
Eq.~(\ref{eq:Re_dsub}) shows that direct substitution rebound is a function of the
compensated own-price elasticity ($\eqsps$), which, if -1, gives unitary direct substitution rebound.
****

I.e, a Cobb-Douglas model of consumer utility already presumes 100\% direct rebound,
which is inappropriate for an analytical framework that purports to
estimate the magnitude of rebound effects.
**** Gregor to review and clean up. ---MKH ****


%++++++++++++++++++++++++++++++
\subsection{Elasticities for utility models}
\label{sec:elasticities_for_utility_models}
%++++++++++++++++++++++++++++++

The approximate and CES utility models discussed above
require three elasticities.
The approximate method requires 
the own price elasticity of energy service consumption ($\eqsps$) and
the cross-price elasticity of energy service consumption ($\eqops$).
The CES utility model requires the elasticity of substitution
between energy service consumption and other goods consumption ($\sigma$).
None of elasticities required for the utility models
is estimable empirically.
**** Gregor: can we say more about why this is so? ---MKH ****
Thus, the starting point for determining the required elasticities 
is the \textit{un}compensated own price elasticity 
of energy service consumption ($\eqspsUC$), 
which can be estimated empirically from
**** more here from Gregor ****. 


%------------------------------
\subsubsection{Elasticity for the CES utility model ($\sigma$)} 
\label{sec:elasticity_ces}
%------------------------------

\citet{Gortz1977} shows that
the elasticity of substitution ($\sigma$)
in the CES utility model is given by

\begin{equation} \label{eq:sigma}
  \sigma = \frac{\fCs + \eqspsUC}{\fCs - 1} \; .
\end{equation}
%
Thus, the elasticity of substitution ($\sigma$) 
can be determined from two pieces of readily-available information:
%
\begin{enumerate*}[label={(\alph*)}]
	
  \item the uncompensated own price elasticity ($\eqspsUC$) and 
  
  \item the share of income spent on the energy service ($\fCs$ 
        from Eq.~(\ref{eq:fCs})).

\end{enumerate*}


%------------------------------
\subsubsection{Elasticities for the approximate utility model ($\eqsps$ and $\eqops$)} 
\label{sec:elasticities_approx}
%------------------------------

Analytical expressions for the elasticities in the approximate utility model
can be derived using the Slutsky equation, 
whereby the uncompensated ($UC$) own price elasticity 
of the energy service ($\eqspsUC$) 
is decomposed into the compensated price elasticity ($\eqsps$) and
the income elasticity ($\eqsM$) as follows:

\begin{equation} \label{eq:slutsky}
  \eqspsUC = \eqsps - \fCs \eqsM \; ,
\end{equation}
%
where $\fCs$ is given by Eq.~(\ref{eq:fCs}) and 
$\eqsM$ is given by Eq.~(\ref{eq:eqsM}).
Solving for the compensated own price elasticity ($\eqsps$) gives

\begin{equation} \label{eq:eqsps}
  \eqsps = \eqspsUC + \fCs \eqsM \; .
\end{equation}

A similar argument allows straightforward derivation 
of the cross price elasticity ($\eqops$).
With \citet{Hicks1934}, 
we note that the uncompensated cross price elasticity ($\eqopsUC$)
can generally be expressed as

\begin{equation} \label{eq:Allen}
  \eqopsUC = \fCs (\sigma - \eqoM) \; ,
\end{equation}
%
where $\sigma$ is the elasticity of substitution 
between the consumption rate of the energy service ($\rate{q}_s$) and
the consumption rate of other goods ($\rate{q}_o$). 
We set Eq.~(\ref{eq:Allen}) equal to 
the cross-price version of the Slutsky equation

\begin{equation} \label{eq:slutsky_cross}
  \eqopsUC = \eqops - \fCs \eqoM \; ,
\end{equation}
%
to obtain

\begin{equation}
  \fCs (\sigma - \eqoM) = \eqops - \fCs \eqoM \; .
\end{equation}
%
Solving for $\eqops$ gives

\begin{equation} \label{eq:eqops_general}
  \eqops = \fCs \sigma \; .
\end{equation}
%
Substituting Eq.~(\ref{eq:sigma}) gives

\begin{equation} \label{eq:eqops}
  \eqops = \frac{\fCs (\fCs + \eqspsUC)}{\fCs - 1} \; .
\end{equation}









